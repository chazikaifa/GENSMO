(function(e){function t(t){for(var s,n,o=t[0],l=t[1],u=t[2],d=0,m=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&m.push(r[n][0]),r[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);c&&c(t);while(m.length)m.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(s=!1)}s&&(i.splice(t--,1),e=n(n.s=a[0]))}return e}var s={},r={app:0},i=[];function n(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=s,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0270":function(e,t,a){},"0276":function(e,t,a){"use strict";var s=a("1c67"),r=a.n(s);r.a},"02d3":function(e,t,a){},"034f":function(e,t,a){"use strict";var s=a("85ec"),r=a.n(s);r.a},1248:function(e,t,a){},"1c67":function(e,t,a){},2034:function(e,t,a){"use strict";var s=a("f8b1"),r=a.n(s);r.a},3379:function(e,t,a){"use strict";var s=a("41ad"),r=a.n(s);r.a},3923:function(e,t,a){},"40b0":function(e,t,a){"use strict";var s=a("4140"),r=a.n(s);r.a},4140:function(e,t,a){},"41ad":function(e,t,a){},"4dbc":function(e,t,a){"use strict";var s=a("02d3"),r=a.n(s);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("c975"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("keep-alive",[e.$route.meta.keepAlive?a("router-view",{key:e.key}):e._e()],1),e.$route.meta.keepAlive?e._e():a("router-view",{key:e.key})],1)},i=[],n=(a("b0c0"),{name:"App",components:{},mounted:function(){},computed:{key:function(){return void 0!==this.$route.name?this.$route.query+new Date:this.$route+new Date}}}),o=n,l=(a("034f"),a("2877")),u=Object(l["a"])(o,r,i,!1,null,null,null),c=u.exports,d=a("2819"),m=a.n(d),_=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:!e.loginStatus,expression:"!loginStatus"}],staticClass:"main_container",attrs:{"element-loading-text":"加载中，请稍后...","element-loading-background":"#222933"}},[a("el-header",[a("div",{staticClass:"title"},[e._v("政企网络服务中台本地故障单管理系统")]),e.loginStatus?a("div",{staticClass:"loginLabel"},[e._v(" "+e._s(e.user_name)+" 你好！ "),a("el-button",{attrs:{type:"text"},on:{click:e.logout}},[e._v("退出登陆")])],1):e._e()]),a("el-container",{staticStyle:{height:"100%"},attrs:{direction:"horizontal"}},[a("el-aside",{attrs:{width:e.isCollapse?"fit-content":"200px"}},[a("el-menu",{attrs:{id:"nav_bar",collapse:e.isCollapse,"collapse-transition":!1,"default-openeds":["1","2"],"default-active":e.default_index},on:{select:e.select_nav}},[a("el-menu-item",{attrs:{index:"0"}},[a("el-button",{attrs:{type:"text",icon:e.isCollapse?"el-icon-arrow-right":"el-icon-arrow-left"}},[e._v("收起")])],1),e.canDo.getOrder?a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-operation"}),a("span",{attrs:{slot:"titile"},slot:"titile"},[e._v("工单状态")])]),a("el-menu-item",{attrs:{index:"1-1",id:"m1-1"}},[e._v(" 在途工单 ")]),a("el-menu-item",{attrs:{index:"1-2",id:"m1-2"}},[e._v(" 所有工单 ")]),a("el-menu-item",{attrs:{index:"1-3",id:"m1-3"}},[e._v(" 已结单 ")]),a("el-menu-item",{attrs:{index:"1-4",id:"m1-4"}},[e._v(" 未结单 ")]),a("el-menu-item",{attrs:{index:"1-5",id:"m1-5"}},[e._v(" 挂起工单 ")]),a("el-menu-item",{attrs:{index:"1-6",id:"m1-6"}},[e._v(" 已撤销 ")])],2):e._e(),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-cooperation"}),a("span",{attrs:{slot:"titile"},slot:"titile"},[e._v("工具箱")])]),e.canDo.getList&&e.canDo.export?a("el-menu-item",{attrs:{index:"2-1",id:"m2-1"}},[e._v(" 工单导出 ")]):e._e(),e.canDo.getCustomerList?a("el-menu-item",{attrs:{index:"2-2",id:"m2-2"}},[e._v(" 客户台账 ")]):e._e(),e.canDo.getAssessOrder?a("el-menu-item",{attrs:{index:"2-3",id:"m2-3"}},[e._v(" 统计图表 ")]):e._e()],2)],1)],1),a("el-container",{staticClass:"main_body",staticStyle:{width:"100%",height:"100%"}},[a(e.comName,{tag:"components",attrs:{params:e.params}})],1)],1)],1)},h=[],f=(a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),a("1da1")),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-row",{staticStyle:{margin:"5px 0 20px 0"},attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:11}},[a("sumLine",{staticClass:"pic"})],1),a("el-col",{attrs:{span:1}}),a("el-col",{staticClass:"pic",attrs:{span:11}},[a("orderCompare",{staticClass:"pic"})],1)],1),a("el-row",{staticClass:"half"},[a("el-col",{attrs:{span:24}},[a("timeout",{staticStyle:{height:"47vh"}})],1)],1)],1)},g=[],b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[e.sumDataArray.flag>1?a("ve-line",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-background":"#222933",data:e.showData,extend:e.extend,settings:e.settings}}):a("ve-histogram",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-background":"#222933",data:e.showData,extend:e.extend,settings:e.settings}})],1)},y=[];a("a9e3"),a("b680");Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var w={name:"sumLine",data:function(){return{token:"",canDo:{},doList:["getAssessOrder","getList"],extend:{title:{show:!0,text:"19总体故障量"},series:{markPoint:{symbol:"circle",symbolSize:1,data:[]}},legend:{bottom:"5%"},yAxis:function(e){return e[1].splitLine={show:!1},e},toolbox:{show:!0,feature:{myPause:{show:!0,title:"暂停轮播",icon:"path://M341.333333 113.777778a28.444444 28.444444 0 0 1 28.444445 28.444444v739.555556a28.444444 28.444444 0 0 1-56.888889 0V142.222222a28.444444 28.444444 0 0 1 28.444444-28.444444z m341.333334 0a28.444444 28.444444 0 0 1 28.444444 28.444444v739.555556a28.444444 28.444444 0 0 1-56.888889 0V142.222222a28.444444 28.444444 0 0 1 28.444445-28.444444z",onclick:this.play},myPlay:{show:!1,title:"继续轮播",icon:"path://M221.790362 1014.94374c-36.775578 0-68.472488-13.843286-91.662653-40.033785-23.130813-26.121937-35.868929-63.466474-35.868928-105.155968V154.424068c0-41.691541 12.739139-79.041194 35.869952-105.169271 23.193235-26.197662 54.889121-40.044018 91.662652-40.044018 27.752064 0 56.166207 8.159844 84.451414 24.25338l570.119699 358.735338 0.153496 0.088004c50.086745 28.728298 78.901001 72.395844 79.053474 119.806643 0 48.284703-28.559453 91.193978-80.418564 120.835066l-0.163729 0.093121L308.632219 989.273081C278.266631 1006.546489 249.860674 1014.94374 221.790362 1014.94374zM221.790362 63.144132c-44.709271 0-73.598228 35.82902-73.598228 91.279936v715.330942c0 55.43659 28.888957 91.2564 73.598228 91.2564 18.275225 0 38.137599-6.03239 59.034535-17.929348l0.165775-0.095167 566.30993-356.24154c35.544541-20.447704 54.333466-46.232974 54.333466-74.56423-0.105401-37.916565-32.837896-62.23953-52.339042-73.362868l-1.198292-0.713244L278.571576 79.725786l-0.169868-0.096191C259.408121 68.843948 239.833297 63.144132 221.790362 63.144132z",onclick:this.play},myChange:{show:!0,title:"切换维度",icon:"path://M480 32a32 32 0 0 0 32 32c119.664 0 232.16 46.608 316.768 131.232C913.392 279.84 960 392.336 960 512c0 118.096-45.472 229.168-128 313.392V736a32 32 0 0 0-64 0v192h192a32 32 0 0 0 0-64h-76.416C974.16 768.512 1024 644.112 1024 512c0-136.752-53.264-265.328-149.984-362.032C777.328 53.264 648.752 0 512 0a32 32 0 0 0-32 32zM149.984 874.032C246.672 970.736 375.248 1024 512 1024a32 32 0 0 0 0-64c-119.664 0-232.16-46.608-316.768-131.232C110.608 744.16 64 631.664 64 512c0-118.096 45.472-229.168 128-313.392V288a32 32 0 0 0 64 0V96H64a32 32 0 0 0 0 64h76.416C49.84 255.488 0 379.888 0 512c0 136.752 53.264 265.328 149.984 362.032z",onclick:this.change},saveAsImage:{show:!0}}}},sumDataArray:{length:4,flag:0,title:["19总体故障量","19责任故障量","本地故障量","总体故障量"],columns:[["日期","去年故障量","故障量","同比"],["日期","去年故障量","故障量","同比"],["日期","故障量","责任故障量"],["日期","19责任故障","19非责任故障","本地责任故障","本地非责任故障"]],rows:[],area:[!1,!1,!1,!0],markPointData:[[],[],[],[]]},showData:{columns:["日期","故障量","去年故障量","同比"],rows:[]},settings:{stack:{"总故障量":["19责任故障","19非责任故障","本地责任故障","本地非责任故障"]},showLine:["同比"],yAxisType:["value","percent"],axisSite:{right:["同比"]}},ready:0,rawData:[],rawLocalData:[],rawDataLast:[],rawLocalDataLast:[],timer:void 0,playing:!0,loading:!0}},created:function(){var e=this;this.token=this.$cookies.get("user_token"),this.assess_query(this.doList).then((function(){e.canDo.getAssessOrder&&e.canDo.getList?e.init():e.$message.error("[sumLine]:没有接口权限！")}))},methods:{init:function(){this.getData()},getData:function(){var e=this,t=new Date;t.setDate(t.getDate()-1),t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date(t);a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0);var s=new Date(t);s.setFullYear(t.getFullYear()-1);var r=new Date(a);r.setFullYear(t.getFullYear()-1),this.getOrder(a.Format("yyyy-MM-dd hh:mm:ss"),t.Format("yyyy-MM-dd hh:mm:ss"),(function(t){"success"==t.data.status?(e.rawData=t.data.result,e.ready++,e.ready>=4&&e.get_union()):e.$message.error("[sumLine]rawDataLast Error:"+t.data.errMsg)})),this.getOrder(r.Format("yyyy-MM-dd hh:mm:ss"),s.Format("yyyy-MM-dd hh:mm:ss"),(function(t){"success"==t.data.status?(e.rawDataLast=t.data.result,e.ready++,e.ready>=4&&e.get_union()):e.$message.error("[sumLine]rawData Error:"+t.data.errMsg)})),this.getLocalOrder(a.Format("yyyy-MM-dd hh:mm:ss"),t.Format("yyyy-MM-dd hh:mm:ss"),(function(t){"success"==t.data.status?(e.rawLocalData=t.data.result,e.ready++,e.getLocalSum(),e.ready>=4&&e.get_union()):e.$message.error("[sumLine]rawLocalData Error:"+t.data.errMsg)})),this.getLocalOrder(r.Format("yyyy-MM-dd hh:mm:ss"),s.Format("yyyy-MM-dd hh:mm:ss"),(function(t){"success"==t.data.status?(e.rawLocalDataLast=t.data.result,e.ready++,e.ready>=4&&e.get_union()):e.$message.error("[sumLine]rawLocalDataLast Error:"+t.data.errMsg)}))},getOrder:function(e,t,a){var s=this,r=new FormData;r.append("START",e),r.append("END",t),r.append("province","广东省广州市"),r.append("token",s.token),this.axios.post("http://"+this.$global_msg.HOST+"scripts/assess_order/get_gz_order_by_datetime.php",r).then((function(e){a(e)})).catch((function(e){s.$message.error("[sumLine]getOrder Error:"+e),console.log(e)}))},getLocalOrder:function(e,t,a){var s=this,r=new FormData;r.append("step",""),r.append("end_time_start",e),r.append("end_time_end",t),r.append("token",this.token),this.axios.post("http://"+this.$global_msg.HOST+"scripts/order/getList.php",r).then((function(e){a(e)})).catch((function(e){s.$message.error("[sumLine]getLocalOrder Error:"+e)}))},getSum:function(){var e=[],t=[],a=new Date;a.setDate(a.getDate()-1),a.setHours(0),a.setMinutes(0),a.setSeconds(0);for(var s=a.getDate(),r=a.getMonth()+1,i=0;i<s+1;i++)e.push(new Date(a.setDate(i+1))),t.push({"日期":r+"月"+(i+1)+"日","故障量":0,"责任故障量":0});for(var n in t.pop(),this.rawData){var o=this.rawData[n];if("广东省广州市"==this.rawData[n].province&&("广州"==this.rawData[n].responsible_province||"用户"==this.rawData[n].responsible_province)){for(var l=new Date(o.end_time),u=0;u<s;u++)if(l>e[u]&&l<e[u+1]){t[u]["故障量"]=t[u]["故障量"]+1,"1"==o.is_assess&&(t[u]["责任故障量"]=t[u]["责任故障量"]+1);break}l>e[s]&&(t[s]["故障量"]=t[s]["故障量"]+1,"1"==o.is_assess&&(t[s]["责任故障量"]=t[s]["责任故障量"]+1))}}this.sumDataArray.rows[0]=t},getLocalSum:function(){var e=[],t=[],a=new Date;a.setDate(a.getDate()-1),a.setHours(0),a.setMinutes(0),a.setSeconds(0);for(var s=a.getDate(),r=a.getMonth()+1,i=0;i<s+1;i++)e.push(new Date(a.setDate(i+1))),t.push({"日期":r+"月"+(i+1)+"日","故障量":0,"责任故障量":0});for(var n in t.pop(),this.rawLocalData){for(var o=this.rawLocalData[n],l=new Date(o.end_time),u=0;u<s;u++)if(l>e[u]&&l<e[u+1]){t[u]["故障量"]=t[u]["故障量"]+1,"1"==o.is_trouble&&(t[u]["责任故障量"]=t[u]["责任故障量"]+1);break}l>e[s]&&(t[s]["故障量"]=t[s]["故障量"]+1,"1"==o.is_trouble&&(t[s]["责任故障量"]=t[s]["责任故障量"]+1))}this.sumDataArray.rows[2]=t},get_union:function(){var e=[],t=new Date;t.setDate(t.getDate()-1),t.setHours(0),t.setMinutes(0),t.setSeconds(0);for(var a=t.getDate(),s=t.getMonth()+1,r=[],i=[],n=[],o=0;o<a;o++)e.push(new Date(t.setDate(o+1))),r.push({"日期":s+"月"+(o+1)+"日","19责任故障":0,"19非责任故障":0,"本地责任故障":0,"本地非责任故障":0,"合计":0}),i.push({"日期":s+"月"+(o+1)+"日","故障量":0,"去年故障量":0,"同比":0}),n.push({"日期":s+"月"+(o+1)+"日","故障量":0,"去年故障量":0,"同比":0});for(var l in e.push(new Date(t.setDate(a+1))),this.rawData){var u=this.rawData[l];if("广东省广州市"==u.province&&("广州"==u.responsible_province||"用户"==u.responsible_province))for(var c=new Date(u.end_time),d=0;d<a;d++)if(c>e[d]&&c<e[d+1]){"1"==u.is_assess&&"广州"==u.responsible_province?(r[d]["19责任故障"]=r[d]["19责任故障"]+1,n[d]["故障量"]=n[d]["故障量"]+1):(r[d]["19非责任故障"]=r[d]["19非责任故障"]+1,i[d]["故障量"]=i[d]["故障量"]+1),r[d]["合计"]=r[d]["合计"]+1;break}}for(var m in this.rawDataLast){var _=this.rawDataLast[m];if("广东省广州市"==_.province&&("广州"==_.responsible_province||"用户"==_.responsible_province)){var p=new Date(_.end_time);p.setFullYear(p.getFullYear()+1);for(var h=0;h<a;h++)if(p>e[h]&&p<e[h+1]){"1"==_.is_assess&&"广州"==_.responsible_province?n[h]["去年故障量"]=n[h]["去年故障量"]+1:i[h]["去年故障量"]=i[h]["去年故障量"]+1;break}}}for(var f in this.rawLocalData)for(var v=this.rawLocalData[f],g=new Date(v.end_time),b=0;b<a;b++)if(g>e[b]&&g<e[b+1]){"1"==v.is_trouble?r[b]["本地责任故障"]=r[b]["本地责任故障"]+1:r[b]["本地非责任故障"]=r[b]["本地非责任故障"]+1,r[b]["合计"]=r[b]["合计"]+1;break}for(var y in r)this.sumDataArray.markPointData[3].push({value:r[y]["合计"],coord:[Number(y),Number(r[y]["合计"])],label:{show:!0,position:"top",color:"#AAAAAA"}});for(var w in i)i[w]["同比"]=((i[w]["故障量"]-i[w]["去年故障量"])/i[w]["去年故障量"]).toFixed(4);for(var x in n)n[x]["同比"]=((n[x]["故障量"]-n[x]["去年故障量"])/n[x]["去年故障量"]).toFixed(4);this.sumDataArray.rows[0]=i,this.sumDataArray.rows[1]=n,this.sumDataArray.rows[3]=r,this.loading=!1;var O={columns:this.sumDataArray.columns[0],rows:this.sumDataArray.rows[0]};this.showData=O,this.extend.title={show:!0,text:this.sumDataArray.title[0]},this.settings.area=this.sumDataArray.area[0],this.timer=setTimeout(this.change,5e3)},change:function(){if(void 0!=this.timer&&clearTimeout(this.timer),this.playing&&(this.timer=setTimeout(this.change,5e3)),!this.loading){this.sumDataArray.flag+1>=this.sumDataArray.length?this.sumDataArray.flag=0:this.sumDataArray.flag++;var e=this.sumDataArray.flag,t={columns:this.sumDataArray.columns[e],rows:this.sumDataArray.rows[e]};this.showData=t,this.extend.title={show:!0,text:this.sumDataArray.title[e]},this.extend.series.markPoint.data=this.sumDataArray.markPointData[e],console.log(this.extend.series.markPoint),this.settings.area=this.sumDataArray.area[e]}},play:function(){void 0!=this.timer?(clearTimeout(this.timer),this.timer=void 0,this.playing=!1,this.extend.toolbox.feature.myPlay.show=!0,this.extend.toolbox.feature.myPause.show=!1):(this.playing=!0,this.change(),this.extend.toolbox.feature.myPlay.show=!1,this.extend.toolbox.feature.myPause.show=!0)},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},x=w,O=Object(l["a"])(x,b,y,!1,null,"a30f2d46",null),k=O.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ve-histogram",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-background":"#222933",data:e.showData,extend:e.extend,settings:e.settings}})],1)},D=[],L={name:"orderCompare",data:function(){return{token:"",canDo:{},doList:["getAssessOrder"],extend:{title:{show:!0,text:"所有故障量同比"},series:{smooth:!1},legend:{bottom:"5%"},yAxis:function(e){return e[1].splitLine={show:!1},e},toolbox:{show:!0,feature:{myPause:{show:!0,title:"暂停轮播",icon:"path://M341.333333 113.777778a28.444444 28.444444 0 0 1 28.444445 28.444444v739.555556a28.444444 28.444444 0 0 1-56.888889 0V142.222222a28.444444 28.444444 0 0 1 28.444444-28.444444z m341.333334 0a28.444444 28.444444 0 0 1 28.444444 28.444444v739.555556a28.444444 28.444444 0 0 1-56.888889 0V142.222222a28.444444 28.444444 0 0 1 28.444445-28.444444z",onclick:this.play},myPlay:{show:!1,title:"继续轮播",icon:"path://M221.790362 1014.94374c-36.775578 0-68.472488-13.843286-91.662653-40.033785-23.130813-26.121937-35.868929-63.466474-35.868928-105.155968V154.424068c0-41.691541 12.739139-79.041194 35.869952-105.169271 23.193235-26.197662 54.889121-40.044018 91.662652-40.044018 27.752064 0 56.166207 8.159844 84.451414 24.25338l570.119699 358.735338 0.153496 0.088004c50.086745 28.728298 78.901001 72.395844 79.053474 119.806643 0 48.284703-28.559453 91.193978-80.418564 120.835066l-0.163729 0.093121L308.632219 989.273081C278.266631 1006.546489 249.860674 1014.94374 221.790362 1014.94374zM221.790362 63.144132c-44.709271 0-73.598228 35.82902-73.598228 91.279936v715.330942c0 55.43659 28.888957 91.2564 73.598228 91.2564 18.275225 0 38.137599-6.03239 59.034535-17.929348l0.165775-0.095167 566.30993-356.24154c35.544541-20.447704 54.333466-46.232974 54.333466-74.56423-0.105401-37.916565-32.837896-62.23953-52.339042-73.362868l-1.198292-0.713244L278.571576 79.725786l-0.169868-0.096191C259.408121 68.843948 239.833297 63.144132 221.790362 63.144132z",onclick:this.play},myChange:{show:!0,title:"切换维度",icon:"path://M480 32a32 32 0 0 0 32 32c119.664 0 232.16 46.608 316.768 131.232C913.392 279.84 960 392.336 960 512c0 118.096-45.472 229.168-128 313.392V736a32 32 0 0 0-64 0v192h192a32 32 0 0 0 0-64h-76.416C974.16 768.512 1024 644.112 1024 512c0-136.752-53.264-265.328-149.984-362.032C777.328 53.264 648.752 0 512 0a32 32 0 0 0-32 32zM149.984 874.032C246.672 970.736 375.248 1024 512 1024a32 32 0 0 0 0-64c-119.664 0-232.16-46.608-316.768-131.232C110.608 744.16 64 631.664 64 512c0-118.096 45.472-229.168 128-313.392V288a32 32 0 0 0 64 0V96H64a32 32 0 0 0 0 64h76.416C49.84 255.488 0 379.888 0 512c0 136.752 53.264 265.328 149.984 362.032z",onclick:this.change},saveAsImage:{show:!0}}}},dataArray:{length:4,flag:0,title:["所有故障量同比","责任故障量同比","所有故障量环比","责任故障量环比"],columns:[["时间","去年故障量","故障量","同比"],["时间","去年故障量","故障量","同比"],["时间","故障量","环比"],["时间","故障量","环比"]],rows:[]},showData:{columns:["时间","去年故障量","故障量","同比"],rows:[]},settings:{showLine:["同比","环比"],yAxisType:["value","percent"],axisSite:{right:["环比","同比"]}},rawData:[],rawDataLast:[],currentMonth:-1,ready:0,loading:!0,timer:void 0,playing:!0}},created:function(){var e=this;this.token=this.$cookies.get("user_token"),this.assess_query(this.doList).then((function(){e.canDo.getAssessOrder?e.init():e.$message.error("[orderCompare]:没有接口权限！")}))},methods:{init:function(){console.log("[orderCompare]init"),this.getData()},getData:function(){var e=this,t=this,a=new Date;a.setDate(a.getDate()-1),a.setHours(23),a.setMinutes(59),a.setSeconds(59),this.currentMonth=a.getMonth();var s=new Date(a);s.setDate(1),s.setMonth(0),s.setHours(0),s.setMinutes(0),s.setSeconds(0);for(var r=function(r){var i=new Date(s);i.setMonth(r);var n=e.getEnd(a,r);e.getOrder(i.Format("yyyy-MM-dd hh:mm:ss"),n.Format("yyyy-MM-dd hh:mm:ss"),(function(e){"success"==e.data.status?(t.rawData[r]={sum:e.data.sum,data:e.data.result},t.ready++,t.ready>=t.currentMonth+13&&t.get_union()):t.$message.error("[orderCompare]Error:"+e.data.errMsg)}))},i=0;i<=this.currentMonth;i++)r(i);var n=new Date(s);n.setFullYear(n.getFullYear()-1);var o=new Date(a);o.setFullYear(o.getFullYear()-1);for(var l=function(a){var s=new Date(n);s.setMonth(a);var r=e.getEnd(o,a);e.getOrder(s.Format("yyyy-MM-dd hh:mm:ss"),r.Format("yyyy-MM-dd hh:mm:ss"),(function(e){"success"==e.data.status?(t.rawDataLast[a]={sum:e.data.sum,data:e.data.result},t.ready++,t.ready>=t.currentMonth+13&&t.get_union()):t.$message.error("[orderCompare]Error:"+e.data.errMsg)}))},u=0;u<12;u++)l(u)},getEnd:function(e,t){var a=new Date(e),s=a.getDate();if(s<29)return a.setMonth(t),a;var r=a.getFullYear(),i=!1;switch((r%400==0||r%4==0&&r%100!=0)&&(i=!0),t){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return a.setMonth(t),a;case 1:return i&&29==s||a.setDate(28),a.setMonth(t),a;case 3:case 5:case 8:case 10:return s<31||a.setDate(30),a.setMonth(t),a}},getOrder:function(e,t,a){var s=this,r=new FormData;r.append("START",e),r.append("END",t),r.append("province","广东省广州市"),r.append("token",s.token),this.axios.post("http://"+s.$global_msg.HOST+"scripts/assess_order/get_gz_order_by_datetime.php",r).then((function(e){console.log(e),a(e)})).catch((function(e){s.$message.error("[orderCompare]Network Error:"+e)}))},get_union:function(){for(var e=0;e<=this.currentMonth;e++){var t=this.rawData[e].data,a=0;for(var s in t)"广州"==t[s].responsible_province&&"1"==t[s].is_assess&&a++;this.rawData[e].reSum=a}for(var r=0;r<=this.currentMonth;r++){var i=this.rawDataLast[r].data,n=0;for(var o in i)"广州"==i[o].responsible_province&&"1"==i[o].is_assess&&n++;this.rawDataLast[r].reSum=n}this.dataArray.rows=[[],[],[],[]];for(var l=0;l<=this.currentMonth;l++){var u=this.rawData[l].sum,c=this.rawDataLast[l].sum,d=((u-c)/c).toFixed(4);d="NaN"==d?0:d,this.dataArray.rows[0][l]={"时间":l+1+"月","去年故障量":c,"故障量":u,"同比":d};var m=this.rawData[l].reSum,_=this.rawDataLast[l].reSum,p=((m-_)/_).toFixed(4);p="NaN"==p?0:p,this.dataArray.rows[1][l]={"时间":l+1+"月","去年故障量":_,"故障量":m,"同比":p};var h=void 0,f=void 0;0==l?(h=((this.rawData[l].sum-this.rawDataLast[11].sum)/this.rawDataLast[11].sum).toFixed(4),f=((this.rawData[l].reSum-this.rawDataLast[11].reSum)/this.rawDataLast[11].reSum).toFixed(4)):(h=((this.rawData[l].sum-this.rawData[l-1].sum)/this.rawData[l-1].sum).toFixed(4),f=((this.rawData[l].reSum-this.rawData[l-1].reSum)/this.rawData[l-1].reSum).toFixed(4)),h="NaN"==h?0:h,f="NaN"==f?0:f,this.dataArray.rows[2][l]={"时间":l+1+"月","故障量":this.rawData[l].sum,"环比":h},this.dataArray.rows[3][l]={"时间":l+1+"月","故障量":this.rawData[l].reSum,"环比":f}}this.loading=!1,this.showData.rows=this.dataArray.rows[0],this.timer=setTimeout(this.change,5e3)},change:function(){if(void 0!=this.timer&&clearTimeout(this.timer),this.playing&&(this.timer=setTimeout(this.change,5e3)),!this.loading){this.dataArray.flag+1>=this.dataArray.length?this.dataArray.flag=0:this.dataArray.flag++;var e=this.dataArray.flag;this.showData.rows=this.dataArray.rows[e],this.showData.columns=this.dataArray.columns[e],this.extend.title={show:!0,text:this.dataArray.title[e]}}},play:function(){void 0!=this.timer?(clearTimeout(this.timer),this.timer=void 0,this.playing=!1,this.extend.toolbox.feature.myPlay.show=!0,this.extend.toolbox.feature.myPause.show=!1):(this.playing=!0,this.change(),this.extend.toolbox.feature.myPlay.show=!1,this.extend.toolbox.feature.myPause.show=!0)},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},P=L,C=Object(l["a"])(P,T,D,!1,null,"3dbe3eb3",null),j=C.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-background":"#222933"}},[a("div",{staticClass:"timeout_container"},[a("div",{staticClass:"timecount"},[a("div",{staticClass:"title"},[e._v(" 考核指标 "),a("vxe-button",{attrs:{status:"primary",icon:"vxe-icon--d-arrow-right",id:"btn_daily"},on:{click:e.toDaily}},[e._v("每日通报")])],1),a("vxe-table",{attrs:{align:"center",data:e.timeCount,"max-height":"90%","auto-resize":""}},[a("vxe-table-column",{attrs:{width:"26%",field:"item",title:"考核项目"}}),a("vxe-table-column",{attrs:{width:"17%",field:"sum",title:"总工单数"}}),a("vxe-table-column",{attrs:{width:"17%",field:"timeout",title:"超时数"}}),a("vxe-table-column",{attrs:{width:"20%",field:"time",title:"平均历时(分钟)"}}),a("vxe-table-column",{attrs:{width:"20%",field:"rate",title:"及时率"}})],1)],1),a("div",{staticClass:"timeout"},[a("div",{staticClass:"title"},[e._v(" 重要客户故障与超时工单 "),a("vxe-button",{attrs:{type:"text",id:"btn_switch"},on:{click:function(t){e.timeoutMode=1-e.timeoutMode}}},[e._v(e._s(1==e.timeoutMode?"显示所有":"仅显示超时"))]),a("vxe-button",{attrs:{status:"primary",icon:"vxe-icon--d-arrow-right",id:"btn_list"},on:{click:e.toList}},[e._v("考核工单详情")]),a("vxe-modal",{attrs:{title:"添加澄清","lock-scroll":!1,"show-footer":"",width:"50%"},on:{confirm:e.addReduce},model:{value:e.isAdd,callback:function(t){e.isAdd=t},expression:"isAdd"}},[a("vxe-table",{attrs:{"show-overflow":"",height:"fit-content",align:"center","sync-resize":e.isAdd,border:"",data:e.reduce,"edit-config":{trigger:"click",mode:"cell",activeMethod:e.not_edit_id}}},[a("vxe-table-column",{attrs:{field:"id",title:"故障单编号",width:"50%","edit-render":{name:"input"}}}),a("vxe-table-column",{attrs:{field:"province",title:"澄清归属",width:"30%","edit-render":{name:"input",attrs:{type:"text"}}}}),a("vxe-table-column",{attrs:{field:"time",title:"澄清历时",width:"20%","edit-render":{name:"$input",props:{type:"number"}}}})],1)],1)],1),a("vxe-table",{attrs:{align:"center",border:"","highlight-hover-row":"","max-height":"90%","auto-resize":"",resizable:"","cell-class-name":e.cell_class,data:1==e.timeoutMode?e.timeoutList:e.showList},on:{"cell-dblclick":e.dbClick}},[a("vxe-table-column",{attrs:{width:"24%",field:"id",title:"故障单编号"}}),a("vxe-table-column",{attrs:{width:"11%",field:"timeLimit",title:"故障时限(分钟)"}}),a("vxe-table-column",{attrs:{width:"13%",field:"timeText",title:"故障历时(分钟)"}}),a("vxe-table-column",{attrs:{width:"12%",field:"netTime",title:"修复净历时(分钟)"}}),a("vxe-table-column",{attrs:{width:"10%",field:"mark",title:"标记",filters:e.TOPList,"filter-multiple":!1,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{width:"10%",field:"duty",title:"责任专业",filters:[{label:"广州责任",value:!0},{label:"非广州责任",value:!1}],"filter-multiple":!1,"filter-method":e.responsibleFilter}}),a("vxe-table-column",{attrs:{width:"17%",field:"reason",title:"故障原因","show-overflow":""}})],1)],1)])])},$=[],S=(a("13d5"),a("fb6a"),{name:"timeout",data:function(){return{token:"",canDo:{},doList:["getAssessOrder","updateAssessOrder"],timeCount:[],timeoutList:[],showList:[],timeoutMode:1,rawData:[],reduce:[{id:"",province:"",time:0,maxTime:0,timeLimit:0}],isAdd:!1,TOPList:[{label:"TOP33",value:"TOP33"},{label:"TOP210",value:"TOP210"},{label:"TOP800",value:"TOP800"}],loading:!0}},created:function(){var e=this;this.token=this.$cookies.get("user_token"),this.assess_query(this.doList).then((function(){e.canDo.getAssessOrder?e.init():e.$message.error("[timeout]:没有接口权限!")})),this.init()},methods:{init:function(){var e=this,t=new Date;t.setDate(t.getDate()-1),t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date(t);a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),this.getOrder(a.Format("yyyy-MM-dd hh:mm:ss"),t.Format("yyyy-MM-dd hh:mm:ss"),(function(t){e.count(),e.rawData=t.data.result}))},getOrder:function(e,t,a){var s=this,r=new FormData;r.append("START",e),r.append("END",t),r.append("province","广东省广州市"),r.append("token",s.token),this.axios.post("http://"+this.$global_msg.HOST+"scripts/assess_order/get_gz_order_by_datetime.php",r).then((function(e){a(e)})).catch((function(e){s.$message.error("[timeout]getOrder Error:"+e),console.log(e)}))},count:function(){var e=[{item:"TOP33",sum:0,timeout:0,rate:"100.0%",time:0,timeSum:0},{item:"TOP800家1-2级",sum:0,timeout:0,rate:"100.0%",time:0,timeSum:0},{item:"TOP800家3-6级",sum:0,timeout:0,rate:"100.0%",time:0,timeSum:0},{item:"所有客户",sum:0,timeout:0,rate:"100.0%",time:0,timeSum:0},{item:"TOP210",sum:0,timeout:0,rate:"100.0",time:0,timeSum:0}];for(var t in this.timeoutList=[],this.showList=[],this.rawData){var a=this.rawData[t];if("广东省广州市"==a.province&&1==a.is_assess){var s="广州"==a.responsible_province,r="1"==a.time_out&&s,i=r||Number(a.time)>Number(a.time_limit);if(s&&(e[3].sum++,e[3].timeSum=e[3].timeSum+Number(a.assessment_time),e[3].time=(e[3].timeSum/e[3].sum).toFixed(2)),r&&s&&e[3].timeout++,e[3].rate=Number((e[3].sum-e[3].timeout)/e[3].sum*100).toFixed(2)+"%","1"==a.assess_TOPN&&s)switch(a.level){case"一级":case"二级":e[1].sum++,e[1].timeSum=e[1].timeSum+Number(a.assessment_time),e[1].time=(e[1].timeSum/e[1].sum).toFixed(2),r&&e[1].timeout++,e[1].rate=Number((e[1].sum-e[1].timeout)/e[1].sum*100).toFixed(2)+"%";break;case"三级":case"四级":case"五级":case"六级":e[2].sum++,e[2].timeSum=e[2].timeSum+Number(a.assessment_time),e[2].time=(e[2].timeSum/e[2].sum).toFixed(2),r&&e[2].timeout++,e[2].rate=Number((e[2].sum-e[2].timeout)/e[2].sum*100).toFixed(2)+"%";break}if("1"==a.TOP33&&(i=!0,s&&(e[0].sum++,e[0].timeSum=e[0].timeSum+Number(a.assessment_time),e[0].time=(e[0].timeSum/e[0].sum).toFixed(2),r&&e[0].timeout++,e[0].rate=Number((e[0].sum-e[0].timeout)/e[0].sum*100).toFixed(2)+"%")),"1"==a.TOP210&&s&&(r=r||Number(a.net_duration)>120,e[4].sum++,e[4].timeSum=e[4].timeSum+Number(a.net_duration),e[4].time=(e[4].timeSum/e[4].sum).toFixed(2),Number(a.net_duration)>120&&e[4].timeout++,e[4].rate=Number((e[4].sum-e[4].timeout)/e[4].sum*100).toFixed(2)+"%"),r||i){var n="";"1"==a.TOP33&&(n+="TOP33 "),"1"==a.assess_TOPN&&(n+="TOP800 "),"1"==a.TOP210&&(n+="TOP210 "),n=n.slice(0,-1);var o=a.time;parseInt(a.reduce_time)>0&&(o=o+"(-"+a.reduce_time+"="+a.assessment_time+")");var l=a.major;s||(l=a.responsible_province);var u={id:a.orderId,timeLimit:a.time_limit,time:a.time,reduce_time:a.reduce_time,timeText:o,duty:l,netTime:a.net_duration,reason:a.trouble_reason_symptom,mark:n,responsible_province:a.responsible_province};r&&this.timeoutList.push(u),i&&this.showList.push(u)}}}this.timeCount=e;var c=this;setTimeout((function(){c.loading=!1}),1e3),this.reduce=[{id:"",province:"",time:0,maxTime:0,timeLimit:0}]},cell_class:function(e){var t=e.row,a=e.columnIndex;if(2==a){if(Number(t.time)-Number(t.reduce_time)>Number(t.timeLimit))return"cell_timeout";if(Number(t.reduce_time)>0)return"cell_not_responsible"}return 3==a&&t.mark.indexOf("TOP210")>=0&&Number(t.netTime)>120?"cell_timeout":5==a&&"广州"!=t.responsible_province?"cell_not_responsible":void 0},addReduce:function(){if(parseInt(this.reduce[0].time)>parseInt(this.reduce[0].maxTime))this.$XModal.message({message:"澄清时间不能大于故障历时",status:"warning"});else{var e=this,t=new FormData;t.append("id",this.reduce[0].id),t.append("province",this.reduce[0].province),t.append("time",this.reduce[0].maxTime),t.append("reduce_time",this.reduce[0].time),t.append("time_limit",this.reduce[0].timeLimit),t.append("token",this.token),this.axios.post("http://"+e.$global_msg.HOST+"scripts/assess_order/add_reduce.php",t).then((function(t){if("success"==t.data.status)if("1"==t.data.row){for(var a in e.$message.success("修改成功"),e.rawData){var s=e.rawData[a];if(s.orderId==e.reduce[0].id){s.reduce_time=e.reduce[0].time,""!=e.reduce[0].province&&(s.responsible_province=e.reduce[0].province);var r=parseInt(e.reduce[0].maxTime)-parseInt(e.reduce[0].time);s.assessment_time=r,r<=e.reduce[0].timeLimit?s.time_out="0":s.time_out="1",e.rawData[a]=s;break}}e.count()}else console.log(t),e.$message.warning("未找到工单或无改动");else e.$message.error("[addReduce]ERROR:"+t.data.errMsg)})).catch((function(t){e.$message.error("[addReduce]NETWOKR ERROR:"+t),console.log(t)}))}},dbClick:function(e){this.canDo.updateAssessOrder&&(this.reduce[0].id=e.row.id,this.reduce[0].maxTime=e.row.time,this.reduce[0].timeLimit=e.row.timeLimit,this.isAdd=!this.isAdd)},not_edit_id:function(e){var t=e.columnIndex;return 0!==t},filterMethodStrict:function(e){var t=e.row,a=e.column,s=e.option;return t[a.property].indexOf(s.value)>=0},responsibleFilter:function(e){var t=e.row,a=e.option,s="广州"==t.responsible_province;return a.value==s},toDaily:function(){var e=this.$router.resolve({name:"daily",params:{}});window.open(e.href,"_blank")},toList:function(){var e=this.$router.resolve({name:"assessOrderList",params:{}});window.open(e.href,"_blank")},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}}),I=S,N=(a("b4a1"),Object(l["a"])(I,M,$,!1,null,null,null)),F=N.exports;Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var R={name:"assess",components:{sumLine:k,orderCompare:j,timeout:F},data:function(){return{rawData:[],rawLocalData:[],importFlag:!1,import_text:"导入19数据（请选择“沃运维”系统导出的故障单列表）",timer:void 0,edit:!1}},created:function(){this.init()},methods:{init:function(){1==this.$route.query.edit&&(this.edit=!0);var e=new Date;e.setDate(e.getDate()-1),e.setHours(23),e.setMinutes(59),e.setSeconds(59);var t=new Date(e);t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),this.getData(t.Format("yyyy-MM-dd hh:mm:ss"),e.Format("yyyy-MM-dd hh:mm:ss"))},getData:function(e,t){var a=this;void 0!=a.timer&&(clearTimeout(a.timer),a.timer=void 0),a.dataReady=!1,a.dataLocalReady=!1;var s=new FormData;s.append("START",e),s.append("END",t),this.axios.post("http://"+a.$global_msg.HOST+"scripts/assess_order/get_order_by_datetime.php",s).then((function(e){"success"==e.data.status?(a.rawData=e.data.result,a.sum=e.data.sum,a.dataReady=!0,a.dataReady&&a.dataLocalReady&&a.setTimer()):alert(e.data.errMsg)})).catch((function(e){alert(e)}));var r=new FormData;r.append("id",""),r.append("name",""),r.append("start_time_start",""),r.append("start_time_end",""),r.append("end_time_start",e),r.append("end_time_end",t),r.append("number",""),r.append("index",""),r.append("limit",""),r.append("step",""),this.axios.post("http://"+a.$global_msg.HOST+"scripts/getList.php",r).then((function(e){"success"==e.data.status?(a.rawLocalData=e.data.result,a.dataLocalReady=!0,a.dataReady&&a.dataLocalReady&&a.setTimer()):alert(e.data.errMsg)})).catch((function(e){alert(e)}))},setTimer:function(){var e=this,t=new Date;t.setDate(t.getDate()-1),t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date(t);a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),void 0!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.getData(a.Format("yyyy-MM-dd hh:mm:ss"),t.Format("yyyy-MM-dd hh:mm:ss"))}),6e5)},import19:function(){this.$refs.filElem.dispatchEvent(new MouseEvent("click"))},get_file:function(){var e=this;if(!e.importFlag)if(e.importFlag=!0,e.import_text="导入中，请稍后...",""!=this.$refs.filElem.value){var t=this.$refs.filElem.files[0],a=new FormData;a.append("file",t),this.axios.post("http://"+e.$global_msg.HOST+"scripts/assess_order/import_from_19.php",a).then((function(t){if(e.importFlag=!1,e.import_text="导入19数据（请选择“沃运维”系统导出的故障单列表）","success"==t.data.status){alert("成功导入"+t.data.sum+"条记录!");var a=this,s=new Date,r=new Date;s.setDate(1),s.setHours(0),s.setMinutes(0),s.setSeconds(0),a.getData(s.Format("yyyy-MM-dd hh:mm:ss"),r.Format("yyyy-MM-dd hh:mm:ss"))}else console.log(t),alert("错误:"+t.data.errMsg);e.$refs.filElem.value=""})).catch((function(t){console.log(t),e.importFlag=!1,e.import_text="导入19数据（请选择“沃运维”系统导出的故障单列表）",e.$refs.filElem.value=""}))}else e.importFlag=!1}}},E=R,q=(a("98ca"),Object(l["a"])(E,v,g,!1,null,"5c168269",null)),A=q.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"bg",attrs:{"element-loading-background":"#222933"}},[a("div",{staticClass:"search"},[a("el-input",{staticClass:"search_input",attrs:{disabled:e.input_disable,placeholder:e.placeholder},on:{input:e.search},model:{value:e.name_input,callback:function(t){e.name_input=t},expression:"name_input"}})],1),a("div",{class:e.hint_class,attrs:{id:"hint"}},[e._v(e._s(e.hint))]),e._l(e.customer_list,(function(t,s){return a("div",{key:t.unify_name,class:e.show_class,attrs:{id:s}},[a("el-row",[a("el-col",{staticClass:"item",attrs:{span:24}},[a("div",{staticClass:"title"},[e._v("统一客户名称")])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:24}},[a("div",{staticClass:"content",attrs:{id:"unify_name"}},[e._v(e._s(t.unify_name))])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:24}},[a("div",{staticClass:"title"},[e._v("别名")])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:24}},[a("div",{staticClass:"content",attrs:{id:"name"}},[e._v(e._s(t.name))])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"title"},[e._v("等级")])]),a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"title"},[e._v("标记")])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"content",attrs:{id:"level"}},[e._v(e._s(t.level))])]),a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"content",attrs:{id:"mark"}},[e._v(e._s(t.mark))])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"title"},[e._v("网络经理")])]),a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"title"},[e._v("网络经理电话")])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"content",attrs:{id:"N_manager"}},[e._v(e._s(t.N_manager))])]),a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"content",attrs:{id:"NM_phone"}},[e._v(e._s(t.NM_phone))])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"title"},[e._v("客户经理")])]),a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"title"},[e._v("客户经理电话")])])],1),a("el-row",[a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"content",attrs:{id:"C_manager"}},[e._v(e._s(t.C_manager))])]),a("el-col",{staticClass:"item",attrs:{span:12}},[a("div",{staticClass:"content",attrs:{id:"CM_phone"}},[e._v(e._s(t.CM_phone))])])],1),e.canDo.updateCustomer?a("el-row",[a("el-col",{staticClass:"item",attrs:{span:24}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.edit_customer}},[e._v("编辑")])],1)],1):e._e()],1)})),a("div",{class:e.btn_class,attrs:{id:"button_group"}},[e.canDo.newCustomer?a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",circle:""},on:{click:e.new_customer}}):e._e(),e.canDo.uploadCustomer?a("el-button",{attrs:{icon:"el-icon-upload2",type:"primary",circle:""},on:{click:e.import_customer}}):e._e(),a("input",{ref:"filElem",attrs:{type:"file"},on:{change:e.get_file}})],1),e.canDo.downloadTemplate?a("div",{class:e.btn_class,attrs:{id:"download_template"}},[a("el-link",{attrs:{href:"http://"+this.$global_msg.HOST+"files/导入模板(请勿修改标题行).xlsx",target:"view_window"}},[e._v("下载导入模板")])],1):e._e()],2)},z=[],H=(a("841c"),a("1276"),{name:"Search",props:{},data:function(){return{token:"",pageLoading:!0,show_class:"show_box hidden",hint_class:"",hint:"暂无相关记录",name_input:"",unify_name:"",name:"",level:"",mark:"",N_manager:"",NM_phone:"",C_manager:"",CM_phone:"",customer_list:[],record_list:[],counter:null,btn_class:"",input_disable:!1,placeholder:"请输入客户名称（支持模糊搜索，用'_'匹配任意单个字符，用'%'匹配任意字符串)",canDo:{},doList:["getCustomerList","updateCustomer","uploadCustomer","downloadTemplate","newCustomer"]}},created:function(){var e=this;this.token=this.$cookies.get("user_token"),this.assess_query(this.doList).then((function(){e.pageLoading=!1,e.get_data()}))},methods:{count_start:function(e){var t=this;null!=t.counter&&clearTimeout(t.counter),t.counter=setTimeout((function(){t.onLongClick(e)}),1500)},count_end:function(e){var t=this;null!=t.counter&&(clearTimeout(t.counter),t.counter=null),t.onClick(e)},onLongClick:function(e){var t=this;if(confirm("确认要删除这一条记录?")){var a=new FormData,s=t.record[e.target.id].id;a.append("customer_id",s),this.axios.post("http://"+t.$global_msg.HOST+"scripts/delete_customer_by_id.php",a).then((function(e){"success"==e.data.status?(alert("删除成功"),t.search()):alert(e.data.errMsg)})).catch((function(e){alert(e)}))}},onClick:function(e){},new_customer:function(){var e=this.$router.resolve({name:"add",params:{}});window.open(e.href,"_blank")},edit_customer:function(e){var t=this,a=parseInt(e.path[3].id),s={};s.unify_name=t.customer_list[a].unify_name,s.name=t.name_input,s.level=t.customer_list[a].level,s.N_manager=t.customer_list[a].N_manager,s.NM_phone=t.customer_list[a].NM_phone,s.C_manager=t.customer_list[a].C_manager,s.CM_phone=t.customer_list[a].CM_phone;var r=this.$router.resolve({name:"add",params:{post:s,search:t.name_input}});window.open(r.href,"_blank")},import_customer:function(){this.$refs.filElem.dispatchEvent(new MouseEvent("click"))},search:function(){var e=this;if(""==this.name_input)return e.show_class="show_box hidden",e.hint_class="",e.hint="暂无相关记录",void(e.btn_class="");e.hint="加载中...",e.btn_class="hidden";var t=new FormData;t.append("name",this.name_input),t.append("token",this.token),this.axios.post("http://"+e.$global_msg.HOST+"scripts/customer/get_customer_list.php",t).then((function(t){if("success"==t.data.status){var a=t.data.result;if(0==a.length)return e.show_class="show_box hidden",e.hint_class="",e.hint="暂无相关记录",void(e.btn_class="");e.record_list=a,e.show_class="show_box",e.btn_class="hidden",e.hint_class="hidden";e.unify_name="",e.level="",e.N_manager="",e.NM_phone="",e.C_manager="",e.CM_phone="",e.customer_list=[];var s=0;for(var r in a){var i=a[r];if(void 0==e.customer_list[i.unify_name]){for(var n in i.mark_list=[],i.mark.split(" ").length>1&&("SET"!=i.mark.split(" ")[0]&&"set"!=i.mark.split(" ")[0]||(i.mark_list[i.mark.split(" ")[1]]=1),"UNSET"!=i.mark.split(" ")[0]&&"unset"!=i.mark.split(" ")[0]||(i.mark_list[i.mark.split(" ")[1]]=-1)),i.mark="",i.mark_list)i.mark_list[n]>0&&(i.mark=i.mark+n+" ");i.name_list=[],i.name_list[i.name]=i.name,i.index=s,e.customer_list[i.unify_name]=i,e.customer_list[s]=i,s++}else{var o=e.customer_list[i.unify_name];""==o.level&&""!=i.level&&(e.level=i.level),""==o.N_manager&&""!=i.N_manager&&(e.N_manager=i.N_manager),""==o.NM_phone&&""!=i.NM_phone&&(e.NM_phone=i.NM_phone),""==o.C_manager&&""!=i.C_manager&&(e.C_manager=i.C_manager),""==o.CM_phone&&""!=i.CM_phone&&(e.CM_phone=i.CM_phone),o.name_list[i.name]=i.name;var l="";for(var u in o.name_list)""==o.name_list[u]&&void 0==o.name_list[u]||(l=l+o.name_list[u]+"、");for(var c in l=l.substr(0,l.length-1),o.name=l,i.mark.split(" ").length>1&&("SET"!=i.mark.split(" ")[0]&&"set"!=i.mark.split(" ")[0]||(void 0==o.mark_list[i.mark.split(" ")[1]]?o.mark_list[i.mark.split(" ")[1]]=1:o.mark_list[i.mark.split(" ")[1]]=o.mark_list[i.mark.split(" ")[1]]+1),"UNSET"!=i.mark.split(" ")[0]&&"unset"!=i.mark.split(" ")[0]||(void 0==o.mark_list[i.mark.split(" ")[1]]?o.mark_list[i.mark.split(" ")[1]]=-1:o.mark_list[i.mark.split(" ")[1]]=o.mark_list[i.mark.split(" ")[1]]-1)),o.mark="",o.mark_list)o.mark_list[c]>0&&(o.mark=o.mark+c+" ");e.customer_list[i.unify_name]=o,e.customer_list[o.index]=o}}}else alert(t.data.errMsg)})).catch((function(e){alert(e)}))},get_data:function(){null!=this.$route.params.search&&(this.name_input=this.$route.params.search,this.search())},get_file:function(){var e=this;if(e.input_disable="disabled",e.placeholder="导入中,请稍后...",""!=this.$refs.filElem.value){var t=this.$refs.filElem.files[0],a=new FormData;a.append("file",t),a.append("token",this.token),this.axios.post("http://"+e.$global_msg.HOST+"scripts/customer/upload.php",a).then((function(t){e.input_disable=!1,e.placeholder="请输入客户名称（支持模糊搜索，用'%'匹配任意字符)","success"==t.data.status?e.$message.success("成功导入"+t.data.sum+"条记录!"):(console.log(t),e.$message.error("错误:"+t.data.errMsg)),e.$refs.filElem.value=""})).catch((function(t){console.log(t),e.$message.error("错误:"+t),e.input_disable=!1,e.placeholder="请输入客户名称（支持模糊搜索，用'%'匹配任意字符)",e.$refs.filElem.value=""}))}},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),back:function(){"true"===this.$route.query.goindex?this.$router.replace({name:"index",params:{}}):this.$router.back(-1)}}}),B=H,Q=(a("2034"),Object(l["a"])(B,U,z,!1,null,"1127887c",null)),Y=Q.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bg"},[a("el-row",[a("el-col",{attrs:{span:24}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("故障单编号")])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("客户名称")])]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-input",{model:{value:e.orderID,callback:function(t){e.orderID=t},expression:"orderID"}})],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-input",{model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("故障发生时间")])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("故障恢复时间")])]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.start_time,callback:function(t){e.start_time=t},expression:"start_time"}})],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.end_time,callback:function(t){e.end_time=t},expression:"end_time"}})],1)]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("电路编号")])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("工单状态")])]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-input",{model:{value:e.number,callback:function(t){e.number=t},expression:"number"}})],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-checkbox-group",{model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("el-checkbox",{attrs:{label:"结单"}}),a("el-checkbox",{attrs:{label:"未结单"}}),a("el-checkbox",{attrs:{label:"挂起"}}),a("el-checkbox",{attrs:{label:"已撤销"}})],1)],1)]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:24}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"content"},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v(e._s(e.btn_text))])],1)]),a("el-col",{attrs:{span:2}})],1)],1)},K=[],W={name:"order-export",data:function(){return{orderID:"",name:"",start_time:"",end_time:"",number:"",step:[],loading:!1,btn_text:"导出",token:""}},created:function(){this.token=this.$cookies.get("user_token")},methods:{submit:function(){var e=this;""!=this.start_time||""!=this.end_time?(this.loading=!0,this.btn_text="查询中...",this.getList((function(){e.loading=!1,e.btn_text="导出"}))):this.$message.warning("请至少选择一个时间！")},getList:function(e){var t=this,a=new FormData;a.append("token",this.token),""!=this.orderID&&a.append("id",this.orderID),""!=this.name&&a.append("name",this.name),""!=this.number&&a.append("number",this.number),""!=this.start_time&&this.start_time.length>1&&(a.append("start_time_start",this.start_time[0].Format("yyyy-MM-dd hh:mm:ss")),a.append("start_time_end",this.start_time[1].Format("yyyy-MM-dd hh:mm:ss"))),""!=this.end_time&&this.end_time.length>1&&(a.append("end_time_start",this.end_time[0].Format("yyyy-MM-dd hh:mm:ss")),a.append("end_time_end",this.end_time[1].Format("yyyy-MM-dd hh:mm:ss")));var s="";for(var r in this.step)s=s+this.step[r]+"|";s&&s.slice(0,-1),a.append("step",s),this.axios.post("http://"+t.$global_msg.HOST+"scripts/order/getList.php",a).then((function(s){"success"==s.data.status?0==s.data.status.sum?(t.$message.warning("查无记录，请重新选择条件！"),e()):t.$confirm("成功查询到"+s.data.sum+"条记录,是否确认导出？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){t.btn_text="导出中,请稍后...",t.axios.post("http://"+t.$global_msg.HOST+"scripts/order/export.php",a).then((function(a){"success"==a.data.status?window.open("http://"+t.$global_msg.HOST+"files/"+a.data.fileName):t.$message.error("错误："+a.data.errMsg),e()})).catch((function(a){t.$message.error("错误:"+a),e()}))})).catch(e):(t.$message.error("错误："+s.data.errMsg),e())})).catch((function(a){t.$message.error("错误:"+a),e()}))}}},J=W,G=(a("40b0"),Object(l["a"])(J,V,K,!1,null,"892e6c22",null)),X=G.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{"element-loading-background":"#222933"}},[a("el-main",{staticStyle:{height:"100%"}},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",circle:""},on:{click:function(t){e.show_search=!0}}}),a("el-button",{attrs:{icon:e.isLoading?"el-icon-loading":"el-icon-refresh",disabled:e.isLoading,type:"primary",circle:""},on:{click:e.refresh}}),a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",circle:""},on:{click:e.newOrder}}),a("el-dialog",{attrs:{title:"搜索",visible:e.show_search,width:"80%"},on:{"update:visible":function(t){e.show_search=t}}},[a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("故障单编号")])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("客户名称")])]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-input",{model:{value:e.orderID,callback:function(t){e.orderID=t},expression:"orderID"}})],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-input",{model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("故障发生时间")])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"label"},[e._v("故障恢复时间")])]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.start_time,callback:function(t){e.start_time=t},expression:"start_time"}})],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"content"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.end_time,callback:function(t){e.end_time=t},expression:"end_time"}})],1)]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"label"},[e._v("电路编号")])]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"content"},[a("el-input",{model:{value:e.number,callback:function(t){e.number=t},expression:"number"}})],1)]),a("el-col",{attrs:{span:2}})],1),a("el-row",[a("el-col",{attrs:{span:24}})],1),a("el-row",[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"content"},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("搜索")])],1)]),a("el-col",{attrs:{span:2}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%",height:"fit-content","margin-top":"24px"},attrs:{data:e.rawData,border:"",stripe:"",size:"small","header-cell-style":{background:"#409EFF",color:"white",textAlign:"center"},"cell-style":{textAlign:"center"},"max-height":"730px"}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{prop:"id",label:"故障单编号",width:"130px"}}),a("el-table-column",{attrs:{prop:"name",label:"客户名称"}}),a("el-table-column",{attrs:{prop:"circuit_number",label:"电路编号"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),a("el-table-column",{attrs:{prop:"start_time",label:"故障发生时间",width:"170px"}}),a("el-table-column",{attrs:{prop:"step",label:"工单状态",width:"100px"}}),a("el-table-column",{attrs:{label:"操作",width:"170px",resizable:!1},scopedSlots:e._u([{key:"default",fn:function(t){return[e.canDo.order_view?a("el-button",{attrs:{size:"small",icon:"el-icon-view",circle:""},on:{click:function(a){return e.order_view(t.$index)}}}):e._e(),e.canDo.order_edit?a("el-button",{attrs:{size:"small",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.order_edit(t.$index)}}}):e._e(),(e.step.toString()==["已撤销"].toString()?e.canDo.order_delete:e.canDo.order_update)?a("el-button",{attrs:{size:"small",icon:e.step.toString()==["已撤销"].toString()?"el-icon-delete":"el-icon-close",circle:""},on:{click:function(a){return e.order_delete(t.$index)}}}):e._e()]}}])})],1)],1),a("el-footer",[a("el-pagination",{staticStyle:{width:"100%"},attrs:{"current-page":e.index,"page-size":e.limit,"page-sizes":[10,20,50,100],total:e.sum,layout:"sizes,->,prev,pager,next"},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1)],1)},ee=[],te={name:"OrderList",props:["params"],watch:{params:{immediate:!0,handler:function(e,t){this.step=this.params.step,this.orderID="",this.name="",this.start_time="",this.end_time="",this.number="",this.first_run||this.getData()}}},data:function(){return{token:"",user_name:"Unknown",first_run:!0,orderID:"",name:"",start_time:"",end_time:"",number:"",step:[],index:1,limit:10,sum:0,rawData:[],show_search:!1,isLoading:!1,pageLoading:!0,canDo:{},doList:["order_view","order_edit","order_delete","order_update"],timer:void 0}},created:function(){this.pageLoading=!0,this.token=this.$cookies.get("user_token"),this.user_name=this.$cookies.get("user_name");var e=this;this.assess_query(this.doList).then((function(){e.pageLoading=!1,e.first_run&&e.getData(),e.first_run=!1}))},methods:{getData:function(){var e=this;this.isLoading=!0,clearTimeout(this.timer),this.timer=void 0,this.getList((function(){e.isLoading=!1,e.timer=setTimeout(e.getData,6e4)}))},getList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=function(){});var t=this,a=new FormData;a.append("token",this.token),""!=this.orderID&&a.append("id",this.orderID),""!=this.name&&a.append("name",this.name),""!=this.number&&a.append("number",this.number),""!=this.start_time&&this.start_time.length>1&&(a.append("start_time_start",this.start_time[0].Format("yyyy-MM-dd hh:mm:ss")),a.append("start_time_end",this.start_time[1].Format("yyyy-MM-dd hh:mm:ss"))),""!=this.end_time&&this.end_time.length>1&&(a.append("end_time_start",this.end_time[0].Format("yyyy-MM-dd hh:mm:ss")),a.append("end_time_end",this.end_time[1].Format("yyyy-MM-dd hh:mm:ss")));var s="";for(var r in this.step)s=s+this.step[r]+"|";s&&s.slice(0,-1),a.append("step",s),a.append("index",(this.index-1)*this.limit),a.append("limit",this.limit),this.axios.post("http://"+t.$global_msg.HOST+"scripts/order/getList.php",a).then((function(a){"success"==a.data.status?(t.rawData=a.data.result,t.sum=Number(a.data.sum),e()):(t.$message.error("错误:"+a.data.errMsg),e())})).catch((function(a){t.$message.error("错误:"+a),e()}))},submit:function(){var e=this;this.isLoading=!0,this.show_search=!1,this.getList((function(){e.isLoading=!1}))},refresh:function(){this.isLoading=!0;var e=this;this.getList((function(){e.isLoading=!1}))},newOrder:function(){var e=this.$router.resolve({name:"orderEdit",query:{}});window.open(e.href,"_blank")},order_view:function(e){var t=this.rawData[e].id,a=this.$router.resolve({name:"orderEdit",query:{id:t,edit:"false"}});window.open(a.href,"_blank")},order_edit:function(e){var t=this.rawData[e].id,a=this.$router.resolve({name:"orderEdit",query:{id:t,edit:"true"}});window.open(a.href,"_blank")},order_delete:function(e){var t=this,a=this.rawData[e].id;this.step.toString()==["已撤销"].toString()?this.$confirm("此操作将永久删除工单数据，是否继续？","警告",{type:"warning"}).then((function(){var e=new FormData;e.append("token",t.token),e.append("id",a),t.axios.post("http://"+t.$global_msg.HOST+"scripts/order/delete.php",e).then((function(e){"success"==e.data.status?(t.$message.success("删除成功"),t.getData()):t.$message.error("删除失败:"+e.data.errMsg)})).catch((function(e){t.$message.error("删除失败:"+e)}))})):this.$confirm("撤销的工单将无法恢复，是否继续？","警告",{type:"warning"}).then((function(){var e=new FormData;e.append("token",t.token),e.append("id",a),e.append("step","已撤销"),t.axios.post("http://"+t.$global_msg.HOST+"scripts/order/update.php",e).then((function(e){"success"==e.data.status?(t.$message.success("撤单成功"),t.getData()):t.$message.error("撤单失败:"+e.data.errMsg)})).catch((function(e){t.$message.error("撤单失败:"+e)}))}))},sizeChange:function(e){if(this.limit!=e){this.limit=e,this.isLoading=!0;var t=this;this.getList((function(){t.isLoading=!1}))}},pageChange:function(e){if(this.index!=e){var t=this;this.index=e,this.isLoading=!0,this.getList((function(){t.isLoading=!1}))}},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},ae=te,se=(a("b0bc"),Object(l["a"])(ae,Z,ee,!1,null,"1984f4ac",null)),re=se.exports,ie={name:"Index",components:{assess:A,search:Y,orderExport:X,orderList:re},data:function(){return{token:"",user_name:"",default_index:"",loginStatus:!1,isCollapse:!1,comName:"",last_index:"1-1",params:{},canDo:{},doList:["getOrder","getList","export","getCustomerList","getAssessOrder"]}},created:function(){this.login()},activated:function(){this.$setgoindex()},methods:{login:function(){var e=this;this.$cookies.isKey("user_token")?(this.token=this.$cookies.get("user_token"),this.isLogin(this.token).then((function(t){t?e.assess_query(e.doList).then((function(){e.init()})):(e.$message.warning("您尚未登陆，即将跳转到登陆界面"),setTimeout(e.toLogin,1e3))}))):(this.$message.warning("您尚未登陆，即将跳转到登陆界面"),setTimeout(this.toLogin,1e3))},isLogin:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=this,s=new FormData,s.append("token",t),r=!1,e.next=6,this.axios.post("http://"+a.$global_msg.HOST+"scripts/system/isLogin.php",s).then((function(e){"success"==e.data.status&&"1"==e.data.login&&(a.$cookies.set("user_name",e.data.name),a.user_name=e.data.name,r=!0)}));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),toLogin:function(){this.$router.push({name:"login",params:{}})},logout:function(){this.$cookies.remove("user_token"),this.$cookies.remove("user_name"),this.toLogin()},init:function(){this.canDo.getOrder?(this.default_index="1-1",this.comName="orderList"):this.canDo.getCustomerList?(this.default_index="2-2",this.comName="search"):this.canDo.getAssessOrder?(this.default_index="2-3",this.comName="assess"):(this.default_index="0",this.$confirm("你暂时没有任何模块的权限,请联系系统管理员","提示",{type:"warning",showCancelButton:!1}),this.comName=""),this.params={step:["挂起中","未结单"]},this.loginStatus=!0},select_nav:function(e,t){switch(e){case"0":this.isCollapse=!this.isCollapse,this.isCollapse||this.$nextTick((function(){document.getElementById("m"+this.last_index).setAttribute("class","el-menu-item is-active")}));break;case"1-1":this.comName="order-list",this.params={step:["挂起中","未结单"]};break;case"1-2":this.comName="order-list",this.params={step:["挂起中","未结单","结单"]};break;case"1-3":this.comName="order-list",this.params={step:["结单"]};break;case"1-4":this.comName="order-list",this.params={step:["未结单"]};break;case"1-5":this.comName="order-list",this.params={step:["挂起中"]};break;case"1-6":this.comName="order-list",this.params={step:["已撤销"]};break;case"2-1":this.comName="order-export";break;case"2-2":this.comName="search";break;case"2-3":this.comName="assess";break}"0"!=e&&(e!=this.last_index?this.$nextTick((function(){document.getElementById("m"+this.last_index).setAttribute("class","el-menu-item"),this.last_index=e})):this.last_index=e)},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},ne=ie,oe=(a("3379"),Object(l["a"])(ne,p,h,!1,null,"2ca73d4f",null)),le=oe.exports,ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"title"},[e._v(" 政企网络服务中台本地故障单管理系统 ")]),a("el-main",[a("el-row",[a("el-col",{staticClass:"content",attrs:{span:24}})],1),a("el-row",[a("el-col",{staticClass:"content",attrs:{span:3}}),a("el-col",{staticClass:"content label",attrs:{span:2}},[e._v("账号")]),a("el-col",{staticClass:"content",attrs:{span:16}},[a("el-input",{attrs:{placeholder:"请输入您的账号"},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}})],1),a("el-col",{staticClass:"content",attrs:{span:3}})],1),a("el-row",[a("el-col",{staticClass:"content",attrs:{span:3}}),a("el-col",{staticClass:"content label",attrs:{span:2}},[e._v("密码")]),a("el-col",{staticClass:"content",attrs:{span:16}},[a("el-input",{attrs:{type:"password",placeholder:"请输入您的密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("el-col",{staticClass:"content",attrs:{span:3}})],1),a("el-row",[a("el-col",{staticClass:"content",attrs:{span:3}}),a("el-col",{staticClass:"content",attrs:{span:18}},[a("el-button",{attrs:{id:"btn_submit",type:"primary",loading:e.loading},on:{click:e.send}},[e._v("登录")])],1),a("el-col",{staticClass:"content",attrs:{span:3}})],1),a("el-row",[a("el-col",{staticClass:"content",attrs:{span:24}})],1)],1)],1)},ce=[],de=a("27ae").Base64,me={name:"Login",data:function(){return{number:"",password:"",loading:!1}},created:function(){},activated:function(){this.$setgoindex()},methods:{send:function(){var e=this;if(""!=e.number)if(""!=e.password){e.loading=!0;var t=new FormData;t.append("number",e.number),t.append("password",de.encode(e.password)),this.axios.post("http://"+e.$global_msg.HOST+"scripts/system/login.php",t).then((function(t){var a=t.data.status;switch(e.loading=!1,a){case"success":e.token=t.data.token,e.$cookies.set("user_token",t.data.token),e.$cookies.set("user_name",t.data.name),e.$message.success("登陆成功！正在跳转..."),setTimeout(e.back,500);break;case"fail":e.$message.error("用户名或密码错误！");break;case"error":e.$notify({title:"错误",message:t.data.errMsg,duration:0});break}})).catch((function(t){e.$message.error(t+""),e.loading=!1}))}else e.$message.warning("密码不能为空！");else e.$message.warning("账号不能为空！")},back:function(){"true"===this.$route.query.goindex?this.$router.replace({name:"index",params:{}}):this.$router.back(-1)}}},_e=me,pe=(a("0276"),Object(l["a"])(_e,ue,ce,!1,null,"6d703fc6",null)),he=pe.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"daily_container"},[a("div",{staticClass:"title"},[e._v(e._s(e.now)+"政企网络服务中台考核指标通报")]),a("vxe-table",{ref:"xTable",staticClass:"table",attrs:{border:"",align:"center",data:e.dailyData,"span-method":e.colspanMethod,"header-cell-class-name":e.headerCellClassName,"footer-cell-class-name":e.footerCellClassName,"cell-class-name":e.cellClassName,size:"mini",loading:!e.dataReady,"show-footer":"","footer-method":e.showRemark,"footer-span-method":e.spanRemark,"auto-resize":""},on:{"header-cell-dblclick":e.copy_desc}},[a("vxe-table-column",{staticClass:"desc",attrs:{title:e.dailyDesc,align:"left"}},[a("vxe-table-column",{attrs:{width:"17%",field:"item",title:"考核项目"}}),a("vxe-table-column",{attrs:{width:"6%",field:"duty",title:"责任专业"}}),a("vxe-table-column",{attrs:{width:"6%",field:"target",formatter:e.to100,title:"目标"}}),e._l(e.days,(function(t,s){return a("vxe-table-column",e._b({key:s,attrs:{width:"6%",formatter:e.to100}},"vxe-table-column",t,!1))})),a("vxe-table-column",{attrs:{width:"6%",field:"compare",formatter:e.to100,title:"环比"}}),a("vxe-table-column",{attrs:{width:"6%",field:"toTarget",formatter:e.to100,title:"目标比"}}),a("vxe-table-column",{attrs:{width:"17%",field:"desc",align:"left","header-align":"center",title:"概况"}}),a("vxe-table-column",{attrs:{width:"6%",field:"sum",formatter:e.to100,title:"总计"}}),a("vxe-table-column",{attrs:{width:"6%",field:"sumToTarget",formatter:e.to100,title:"总目标比"}})],2)],1)],1)},ve=[],ge=47,be=5559.13;Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var ye={name:"Daily",components:{},activated:function(){this.$setgoindex()},data:function(){return{token:"",canDo:{},doList:["getAssessOrder"],days:[],dailyData:[{item:"责任故障重复次数",target:0,targetType:"<"},{item:"TOP33责任故障次数",target:11,targetType:"<"},{item:"TOP33责任故障历时",target:100,targetType:"<"},{item:"集团直属客户故障及时率",target:.98,duty:"传输",targetType:">"},{item:"集团直属客户故障及时率",target:.98,duty:"数据",targetType:">"},{item:"集团直属客户故障及时率",target:.98,duty:"交换",targetType:">"},{item:"集团直属客户故障及时率",target:.98,duty:"政企云",targetType:">"},{item:"集团直属客户故障及时率",target:.98,duty:"其他",targetType:">"},{item:"TOP800家1-2级故障及时率",target:.95,duty:"传输",targetType:">"},{item:"TOP800家1-2级故障及时率",target:.95,duty:"数据",targetType:">"},{item:"TOP800家1-2级故障及时率",target:.95,duty:"交换",targetType:">"},{item:"TOP800家1-2级故障及时率",target:.95,duty:"政企云",targetType:">"},{item:"TOP800家1-2级故障及时率",target:.95,duty:"其他",targetType:">"},{item:"TOP800家3-6级故障及时率",target:.95,duty:"传输",targetType:">"},{item:"TOP800家3-6级故障及时率",target:.95,duty:"数据",targetType:">"},{item:"TOP800家3-6级故障及时率",target:.95,duty:"交换",targetType:">"},{item:"TOP800家3-6级故障及时率",target:.95,duty:"政企云",targetType:">"},{item:"TOP800家3-6级故障及时率",target:.95,duty:"其他",targetType:">"},{item:"TOP800家客户故障及时率",target:.95,duty:"传输",targetType:">"},{item:"TOP800家客户故障及时率",target:.95,duty:"数据",targetType:">"},{item:"TOP800家客户故障及时率",target:.95,duty:"交换",targetType:">"},{item:"TOP800家客户故障及时率",target:.95,duty:"政企云",targetType:">"},{item:"TOP800家客户故障及时率",target:.95,duty:"其他",targetType:">"},{item:"所有客户故障及时率",target:.95,duty:"传输",targetType:">"},{item:"所有客户故障及时率",target:.95,duty:"数据",targetType:">"},{item:"所有客户故障及时率",target:.95,duty:"交换",targetType:">"},{item:"所有客户故障及时率",target:.95,duty:"政企云",targetType:">"},{item:"所有客户故障及时率",target:.95,duty:"其他",targetType:">"},{item:"发函投诉",target:0,targetType:"<",day0:0,day1:0,day2:0,day3:0,day4:0,sum:0,toTarget:0,sumToTarget:0}],rawData:[],dataReady:!1,assessData:[],now:"",dailyDesc:"",desc_arr:[{fmt:"1、责任故障重复次数，{d}次，{t}；\r\n",index:0,type:"number"},{fmt:"2、TOP33责任故障次数，{d}次，{t}；",index:1,type:"number"},{fmt:"全年累计责任故障次数，{d}次，{t}；\r\n",index:"TOP33_sum",type:"number"},{fmt:"3、TOP33责任平均历时，{d}分钟，{t}；",index:2,type:"float"},{fmt:"全年责任平均历时{d}分钟，{t}；\r\n",index:"TOP33_time",type:"float"},{fmt:"4、集团直属客户故障及时率，{d}，{t}；\r\n",index:3,type:"percent"},{fmt:"5、TOP800家1-2级客户故障及时率，{d}，{t}；\r\n",index:8,type:"percent"},{fmt:"6、TOP800家3-6级客户故障及时率，{d}，{t}；\r\n",index:13,type:"percent"},{fmt:"7、TOP800家客户故障及时率，{d}，{t}；\r\n",index:18,type:"percent"},{fmt:"8、所有客户故障及时率，{d}，{t}；\r\n",index:23,type:"percent"},{fmt:"9、客户发函投诉，{d}，{t}。",index:28,type:"number"}]}},created:function(){var e=this;this.token=this.$cookies.get("user_token"),this.countDay(),this.assess_query(this.doList).then((function(){e.canDo.getAssessOrder?e.init():e.$message.error("[sumLine]:没有接口权限！")}))},updated:function(){},methods:{countDay:function(){var e=new Date;this.now=e.Format("yyyy年MM月dd日"),e.setDate(e.getDate()-1),e.setHours(23),e.setMinutes(59),e.setSeconds(59);var t,a=e.getDate(),s=new Date(e);s.setHours(23),s.setMinutes(59),s.setSeconds(59),t=a<5?1:a-4,s.setDate(t),this.days=[];for(var r=0;r<=a-t;r++){var i={field:"day"+r,title:e.getMonth()+1+"月"+(t+r)+"日"};this.days.push(i);var n=new Date(s);n.setDate(t+r),this.assessData.push({dateLimit:n,data:[]})}},init:function(){this.dailyData["TOP33_sum"]={item:"TOP33全年累计",target:139,targetType:"<"},this.dailyData["TOP33_time"]={item:"TOP33全年平均历时",target:112,targetType:"<"};var e=new Date;e.setDate(e.getDate()-1),e.setHours(23),e.setMinutes(59),e.setSeconds(59);var t=new Date(e);t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),this.getData(t.Format("yyyy-MM-dd hh:mm:ss"),e.Format("yyyy-MM-dd hh:mm:ss"))},colspanMethod:function(e){var t=e.rowIndex,a=e.columnIndex;if(0==a)switch(t){case 0:case 1:case 2:case 28:return{rowspan:1,colspan:2};case 3:case 8:case 13:case 18:case 23:return{rowspan:5,colspan:1};default:return{rowspan:0,colspan:0}}if(1==a)switch(t){case 0:case 1:case 2:case 28:return{rowspan:0,colspan:0}}if(2==a||a==6+this.days.length||a==7+this.days.length)switch(t){case 0:case 1:case 2:case 28:return{rowspan:1,colspan:1};case 3:case 8:case 13:case 18:case 23:return{rowspan:5,colspan:1};default:return{rowspan:0,colspan:0}}return{rowspan:1,colspan:1}},getData:function(e,t){var a=this;a.dataReady=!1;var s=new FormData;s.append("START",e),s.append("END",t),s.append("token",this.token),s.append("province","广东省广州市"),this.axios.post("http://"+a.$global_msg.HOST+"scripts/assess_order/get_gz_order_by_datetime.php",s).then((function(e){if("success"==e.data.status){for(var t in a.rawData=e.data.result,a.rawData){var s=a.rawData[t];if("广州"==s.responsible_province&&0!=s.is_assess){var r=new Date(s.end_time);for(var i in a.assessData)a.assessData[i].dateLimit-r>0&&a.assessData[i].data.push(s)}}a.judge(a.judgeRepeat,"sum",0,(function(e){a.dailyData[0]["toTarget"]=e.sum-a.dailyData[0]["target"],a.dailyData[0]["desc"]="TOP33重复故障次数"+e.TOP33+",TOP800重复故障次数"+e.TOP800,a.dailyData[0]["sum"]=e.sum,a.dailyData[0]["sumToTarget"]=e.sum-a.dailyData[0]["target"]})),a.judge(a.judgeTOP33,"sum",1,(function(e){a.dailyData[1]["sum"]=e.sum,a.dailyData[1]["sumToTarget"]=a.dailyData[1]["sum"]-a.dailyData[1]["target"],a.dailyData[1]["desc"]="2020年累计责任故障"+(e.sum+ge)+"次",a.dailyData["TOP33_sum"]["sum"]=e.sum+ge,a.dailyData["TOP33_sum"]["sumToTarget"]=a.dailyData["TOP33_sum"]["sum"]-a.dailyData["TOP33_sum"]["target"]})),a.judge(a.judgeTOP33,"time",2,(function(e){a.dailyData[2]["sum"]=e.time,a.dailyData[2]["sumToTarget"]=a.dailyData[2]["sum"]-a.dailyData[2]["target"];var t=(be+e.timeSum)/(ge+e.sum);a.dailyData[2]["desc"]="2020年平均历时"+t.toFixed(2)+"分钟",a.dailyData["TOP33_time"]["sum"]=t,a.dailyData["TOP33_time"]["sumToTarget"]=a.dailyData["TOP33_time"]["sum"]-a.dailyData["TOP33_time"]["target"]})),a.judge(a.judgeTOP210,"cs",3,(function(e){a.dailyData[3]["desc"]="共"+e.cs_sum+"单，超时"+e.cs_timeout+"单",e.sum>0?a.dailyData[3]["sum"]=(e.sum-e.timeout)/e.sum:a.dailyData[3]["sum"]=1,a.dailyData[3]["sumToTarget"]=a.dailyData[3]["sum"]-a.dailyData[3]["target"]})),a.judge(a.judgeTOP210,"sj",4,(function(e){a.dailyData[4]["desc"]="共"+e.sj_sum+"单，超时"+e.sj_timeout+"单"})),a.judge(a.judgeTOP210,"jh",5,(function(e){a.dailyData[5]["desc"]="共"+e.jh_sum+"单，超时"+e.jh_timeout+"单"})),a.judge(a.judgeTOP210,"zq",6,(function(e){a.dailyData[6]["desc"]="共"+e.zq_sum+"单，超时"+e.zq_timeout+"单"})),a.judge(a.judgeTOP210,"qt",7,(function(e){a.dailyData[7]["desc"]="共"+e.qt_sum+"单，超时"+e.qt_timeout+"单"})),a.judge(a.judgeTOP800_1_2,"cs",8,(function(e){a.dailyData[8]["desc"]="共"+e.cs_sum+"单，超时"+e.cs_timeout+"单",e.sum>0?a.dailyData[8]["sum"]=(e.sum-e.timeout)/e.sum:a.dailyData[8]["sum"]=1,a.dailyData[8]["sumToTarget"]=a.dailyData[8]["sum"]-a.dailyData[8]["target"]})),a.judge(a.judgeTOP800_1_2,"sj",9,(function(e){a.dailyData[9]["desc"]="共"+e.sj_sum+"单，超时"+e.sj_timeout+"单"})),a.judge(a.judgeTOP800_1_2,"jh",10,(function(e){a.dailyData[10]["desc"]="共"+e.jh_sum+"单，超时"+e.jh_timeout+"单"})),a.judge(a.judgeTOP800_1_2,"zq",11,(function(e){a.dailyData[11]["desc"]="共"+e.zq_sum+"单，超时"+e.zq_timeout+"单"})),a.judge(a.judgeTOP800_1_2,"qt",12,(function(e){a.dailyData[12]["desc"]="共"+e.qt_sum+"单，超时"+e.qt_timeout+"单"})),a.judge(a.judgeTOP800_3_6,"cs",13,(function(e){a.dailyData[13]["desc"]="共"+e.cs_sum+"单，超时"+e.cs_timeout+"单",e.sum>0?a.dailyData[13]["sum"]=(e.sum-e.timeout)/e.sum:a.dailyData[13]["sum"]=1,a.dailyData[13]["sumToTarget"]=a.dailyData[13]["sum"]-a.dailyData[13]["target"]})),a.judge(a.judgeTOP800_3_6,"sj",14,(function(e){a.dailyData[14]["desc"]="共"+e.sj_sum+"单，超时"+e.sj_timeout+"单"})),a.judge(a.judgeTOP800_3_6,"jh",15,(function(e){a.dailyData[15]["desc"]="共"+e.jh_sum+"单，超时"+e.jh_timeout+"单"})),a.judge(a.judgeTOP800_3_6,"zq",16,(function(e){a.dailyData[16]["desc"]="共"+e.zq_sum+"单，超时"+e.zq_timeout+"单"})),a.judge(a.judgeTOP800_3_6,"qt",17,(function(e){a.dailyData[17]["desc"]="共"+e.qt_sum+"单，超时"+e.qt_timeout+"单"})),a.judge(a.judgeTOP800,"cs",18,(function(e){a.dailyData[18]["desc"]="共"+e.cs_sum+"单，超时"+e.cs_timeout+"单",e.sum>0?a.dailyData[18]["sum"]=(e.sum-e.timeout)/e.sum:a.dailyData[18]["sum"]=1,a.dailyData[18]["sumToTarget"]=a.dailyData[18]["sum"]-a.dailyData[18]["target"]})),a.judge(a.judgeTOP800,"sj",19,(function(e){a.dailyData[19]["desc"]="共"+e.sj_sum+"单，超时"+e.sj_timeout+"单"})),a.judge(a.judgeTOP800,"jh",20,(function(e){a.dailyData[20]["desc"]="共"+e.jh_sum+"单，超时"+e.jh_timeout+"单"})),a.judge(a.judgeTOP800,"zq",21,(function(e){a.dailyData[21]["desc"]="共"+e.zq_sum+"单，超时"+e.zq_timeout+"单"})),a.judge(a.judgeTOP800,"qt",22,(function(e){a.dailyData[22]["desc"]="共"+e.qt_sum+"单，超时"+e.qt_timeout+"单"})),a.judge(a.judgeAll,"cs",23,(function(e){a.dailyData[23]["desc"]="共"+e.cs_sum+"单，超时"+e.cs_timeout+"单",e.sum>0?a.dailyData[23]["sum"]=(e.sum-e.timeout)/e.sum:a.dailyData[23]["sum"]=1,a.dailyData[23]["sumToTarget"]=a.dailyData[23]["sum"]-a.dailyData[23]["target"]})),a.judge(a.judgeAll,"sj",24,(function(e){a.dailyData[24]["desc"]="共"+e.sj_sum+"单，超时"+e.sj_timeout+"单"})),a.judge(a.judgeAll,"jh",25,(function(e){a.dailyData[25]["desc"]="共"+e.jh_sum+"单，超时"+e.jh_timeout+"单"})),a.judge(a.judgeAll,"zq",26,(function(e){a.dailyData[26]["desc"]="共"+e.zq_sum+"单，超时"+e.zq_timeout+"单"})),a.judge(a.judgeAll,"qt",27,(function(e){a.dailyData[27]["desc"]="共"+e.qt_sum+"单，超时"+e.qt_timeout+"单"})),a.countCompare(),a.setDesc(),a.dataReady=!0}else a.$message.error(e.data.errMsg)})).catch((function(e){a.$message.error(e)}))},judgeRepeat:function(e){var t=[];for(var a in e)if(""!=e[a].circuit_number)if(void 0==t[e[a].circuit_number]){var s={sum:1};1==e[a].TOP33?s.TOP33=!0:s.TOP33=!1,1==e[a].assess_TOPN?s.TOP800=!0:s.TOP800=!1,t[e[a].circuit_number]=s}else t[e[a].circuit_number].sum++,t[e[a].circuit_number].sum;var r={sum:0,TOP800:0,TOP33:0};for(var i in t)t[i].TOP800||t[i].TOP33?(r.sum=r.sum+t[i].sum-1,t[i].TOP800&&(r.TOP800=r.TOP800+t[i].sum-1),t[i].TOP33&&(r.TOP33=r.TOP33+t[i].sum-1)):t[i].sum>2&&(r.sum=r.sum+t[i].sum-2);return r},judgeTOP33:function(e){var t={sum:0,timeSum:0};for(var a in e)1==e[a].TOP33&&(t.sum++,t.timeSum=t.timeSum+Number(e[a].assessment_time));return t.sum>0?t.time=(t.timeSum/t.sum).toFixed(2):t.time=0,t},judgeTOP210:function(e){var t={sum:0,timeout:0,cs:1,cs_sum:0,cs_timeout:0,sj:1,sj_sum:0,sj_timeout:0,jh:1,jh_sum:0,jh_timeout:0,zq:1,zq_sum:0,zq_timeout:0,qt:1,qt_sum:0,qt_timeout:0};for(var a in e)if(0!=e[a].TOP210){t.sum++;var s=void 0;switch(e[a].major){case"传输":s="cs";break;case"数据":s="sj";break;case"交换":s="jh";break;case"政企云":s="zq";break;case"其他":s="qt";break;default:s="qt";break}t[s+"_sum"]++,Number(e[a].net_duration)>120&&(t.timeout++,t[s+"_timeout"]++),t[s]=(t[s+"_sum"]-t[s+"_timeout"])/t[s+"_sum"]}return t},judgeTOP800_1_2:function(e){var t={sum:0,timeout:0,cs:1,cs_sum:0,cs_timeout:0,sj:1,sj_sum:0,sj_timeout:0,jh:1,jh_sum:0,jh_timeout:0,zq:1,zq_sum:0,zq_timeout:0,qt:1,qt_sum:0,qt_timeout:0};for(var a in e)if(0!=e[a].assess_TOPN&&("一级"==e[a].level||"二级"==e[a].level)){t.sum++;var s=void 0;switch(e[a].major){case"传输":s="cs";break;case"数据":s="sj";break;case"交换":s="jh";break;case"政企云":s="zq";break;case"其他":s="qt";break;default:s="qt";break}t[s+"_sum"]++,"1"==e[a].time_out&&(t.timeout++,t[s+"_timeout"]++),t[s]=(t[s+"_sum"]-t[s+"_timeout"])/t[s+"_sum"]}return t},judgeTOP800_3_6:function(e){var t={sum:0,timeout:0,cs:1,cs_sum:0,cs_timeout:0,sj:1,sj_sum:0,sj_timeout:0,jh:1,jh_sum:0,jh_timeout:0,zq:1,zq_sum:0,zq_timeout:0,qt:1,qt_sum:0,qt_timeout:0};for(var a in e)if(0!=e[a].assess_TOPN&&("三级"==e[a].level||"四级"==e[a].level||"五级"==e[a].level||"六级"==e[a].level)){t.sum++;var s=void 0;switch(e[a].major){case"传输":s="cs";break;case"数据":s="sj";break;case"交换":s="jh";break;case"政企云":s="zq";break;case"其他":s="qt";break;default:s="qt";break}t[s+"_sum"]++,"1"==e[a].time_out&&(t.timeout++,t[s+"_timeout"]++),t[s]=(t[s+"_sum"]-t[s+"_timeout"])/t[s+"_sum"]}return t},judgeTOP800:function(e){var t={sum:0,timeout:0,cs:1,cs_sum:0,cs_timeout:0,sj:1,sj_sum:0,sj_timeout:0,jh:1,jh_sum:0,jh_timeout:0,zq:1,zq_sum:0,zq_timeout:0,qt:1,qt_sum:0,qt_timeout:0};for(var a in e)if(0!=e[a].assess_TOPN){t.sum++;var s=void 0;switch(e[a].major){case"传输":s="cs";break;case"数据":s="sj";break;case"交换":s="jh";break;case"政企云":s="zq";break;case"其他":s="qt";break;default:s="qt";break}t[s+"_sum"]++,"1"==e[a].time_out&&(t.timeout++,t[s+"_timeout"]++),t[s]=(t[s+"_sum"]-t[s+"_timeout"])/t[s+"_sum"]}return t},judgeAll:function(e){var t={sum:0,timeout:0,cs:1,cs_sum:0,cs_timeout:0,sj:1,sj_sum:0,sj_timeout:0,jh:1,jh_sum:0,jh_timeout:0,zq:1,zq_sum:0,zq_timeout:0,qt:1,qt_sum:0,qt_timeout:0};for(var a in e){t.sum++;var s=void 0;switch(e[a].major){case"传输":s="cs";break;case"数据":s="sj";break;case"交换":s="jh";break;case"政企云":s="zq";break;case"其他":s="qt";break;default:s="qt";break}t[s+"_sum"]++,"1"==e[a].time_out&&(t.timeout++,t[s+"_timeout"]++),t[s]=(t[s+"_sum"]-t[s+"_timeout"])/t[s+"_sum"]}return t},judge:function(e,t,a,s){var r,i=this;for(var n in i.assessData)r=e(i.assessData[n].data),i.dailyData[a]["day"+n]=r[t];s(r)},descFmt:function(e,t,a){var s=e.replace("{d}",t);return s=s.replace("{t}",a),s},setDesc:function(){for(var e in this.dailyDesc="",this.desc_arr){var t=this.desc_arr[e],a=this.dailyData[t.index],s="";switch(t.type){case"number":s=Number(a.sum).toFixed(0);break;case"float":s=Number(a.sum).toFixed(2);break;case"percent":s=(100*a.sum).toFixed(2)+"%";break;default:s=a.sum+""}var r=void 0;r="<"==a.targetType&&a.sumToTarget<=0||">"==a.targetType&&a.sumToTarget>=0?"达标":"不达标",this.dailyDesc=this.dailyDesc+this.descFmt(t.fmt,s,r)}},copy_desc:function(e){if(0==e.$rowIndex){var t="【"+this.now+"政企网络服务中台考核指标通报】\r\n"+this.dailyDesc;this.$copyText(t).then((function(e){alert("已复制到剪切板！")}),(function(e){alert("复制失败，请手动复制！"),console.log(e)}))}},to100:function(e){var t=e.cellValue,a=e.row;switch(a.item){case"责任故障重复次数":case"TOP33责任故障次数":case"发函投诉":return t;case"TOP33责任故障历时":return Number(t).toFixed(2);default:return void 0!=t?"-"==t?"-":(100*t).toFixed(2)+"%":"-"}},headerCellClassName:function(e){switch(e.$rowIndex){case 0:return"desc";default:return"header"}},footerCellClassName:function(){return"footer"},cellClassName:function(e){var t=e.row,a=e.column;switch(a.property){case"day0":case"day1":case"day2":case"day3":case"day4":if(">"==t.targetType&&t[a.property]-t.target<0||"<"==t.targetType&&t[a.property]-t.target>0)return"mainWarn";break;case"sum":if(">"==t.targetType&&t[a.property]-t.target<0||"<"==t.targetType&&t[a.property]-t.target>0)return"warn";break;case"compare":case"toTarget":case"sumToTarget":if(">"==t.targetType&&t[a.property]<0||"<"==t.targetType&&t[a.property]>0)return"warn";break}return null},spanRemark:function(e){var t=e.columnIndex;return t==5+this.days.length?{rowspan:1,colspan:8+this.days.length}:{rowspan:0,colspan:0}},showRemark:function(){for(var e="备注：\n1、工单数据取自“沃运维”系统故障单日报，由程序自动下载并录入数据库，当月内数据累积\n2、故障恢复历时包括了挂起时间，这部分时间需要每周在澄清系统上进行澄清，澄清通过后会在后台手动录入澄清信息。\n3、专业分类依据为工单中的“主要处理部门”（对应表格EC列）字段",t=[],a=0;a<5+this.days.length;a++)t.push("");return t.push(e),[t]},countCompare:function(){var e=this.days[this.days.length-1].field;if(this.days.length>1)for(var t in this.dailyData){var a=this.days[this.days.length-2].field;void 0!=this.dailyData[t][e]?(void 0!=this.dailyData[t][a]?this.dailyData[t]["compare"]=Number(this.dailyData[t][e])-Number(this.dailyData[t][a]):this.dailyData[t]["compare"]="-",void 0!=this.dailyData[t]["target"]?this.dailyData[t]["toTarget"]=Number(this.dailyData[t][e])-Number(this.dailyData[t]["target"]):this.dailyData[t]["toTarget"]="-"):(this.dailyData[t]["compare"]="-",this.dailyData[t]["toTarget"]="-")}else for(var s in this.dailyData)this.dailyData[s]["compare"]="-",void 0!=this.dailyData[s][e]&&void 0!=this.dailyData[s]["target"]?this.dailyData[s]["toTarget"]=Number(this.dailyData[s][e])-Number(this.dailyData[s]["target"]):this.dailyData[s]["toTarget"]="-"},back:function(){"true"===this.$route.query.goindex?this.$router.replace({name:"index",params:{}}):this.$router.back(-1)},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},we=ye,xe=(a("f78b"),Object(l["a"])(we,fe,ve,!1,null,null,null)),Oe=xe.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"bg"}},[a("div",{attrs:{id:"show_box"}},[a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[e._v(" 统一客户名称* ")]),a("el-input",{staticClass:"content_input",model:{value:e.unify_name,callback:function(t){e.unify_name=t},expression:"unify_name"}})],1),a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[e._v(" 客户名称 ")]),a("el-input",{staticClass:"content_input",model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("div",{staticClass:"item half"},[a("div",{staticClass:"title"},[e._v(" 等级 ")]),a("el-select",{staticClass:"content_input",attrs:{placeholder:""},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},e._l(e.level_options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"item half"},[a("div",{staticClass:"title"},[e._v(" 标记 ")]),a("el-input",{staticClass:"content_input",model:{value:e.mark,callback:function(t){e.mark=t},expression:"mark"}})],1),a("div",{staticClass:"item half"},[a("div",{staticClass:"title"},[e._v(" 网络经理 ")]),a("el-input",{staticClass:"content_input",model:{value:e.N_manager,callback:function(t){e.N_manager=t},expression:"N_manager"}})],1),a("div",{staticClass:"item half"},[a("div",{staticClass:"title"},[e._v(" 网络经理电话 ")]),a("el-input",{staticClass:"content_input",model:{value:e.NM_phone,callback:function(t){e.NM_phone=t},expression:"NM_phone"}})],1),a("div",{staticClass:"item half"},[a("div",{staticClass:"title"},[e._v(" 客户经理 ")]),a("el-input",{staticClass:"content_input",model:{value:e.C_manager,callback:function(t){e.C_manager=t},expression:"C_manager"}})],1),a("div",{staticClass:"item half"},[a("div",{staticClass:"title"},[e._v(" 客户经理电话 ")]),a("el-input",{staticClass:"content_input",model:{value:e.CM_phone,callback:function(t){e.CM_phone=t},expression:"CM_phone"}})],1),a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[e._v(" 来源 ")]),a("el-input",{staticClass:"content_input",model:{value:e.origin,callback:function(t){e.origin=t},expression:"origin"}})],1),a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[e._v(" 备注 ")]),a("el-input",{staticClass:"content_input",model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1),a("div",{staticClass:"item half"},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"info"},on:{click:e.back}},[e._v("取消")])],1),a("div",{staticClass:"item half"},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",disabled:e.leaving,loading:e.loading},on:{click:e.confirm}},[e._v("确认")])],1)])])},Te=[],De={name:"Add",props:{},data:function(){return{token:"",unify_name:"",name:"",level:"",mark:"",N_manager:"",NM_phone:"",C_manager:"",CM_phone:"",origin:"",remark:"",post:null,search:null,level_options:[{label:"一级",value:"一级"},{label:"二级",value:"二级"},{label:"三级",value:"三级"},{label:"四级",value:"四级"},{label:"五级",value:"五级"},{label:"六级",value:"六级"}],leaving:!1,loading:!1}},created:function(){this.token=this.$cookies.get("user_token"),this.fetchData()},activated:function(){this.$setgoindex()},watch:{$route:"fetchData"},methods:{confirm:function(){this.loading=!0,null!=this.post&&null!=this.post.id?this.update_customer():this.new_customer()},new_customer:function(){var e=this;if(void 0!=this.unify_name&&""!=this.unify_name){var t=new FormData;t.append("token",this.token),t.append("unify_name",void 0==this.unify_name?"":this.unify_name),t.append("name",void 0==this.name?"":this.name),t.append("level",void 0==this.level?"":this.level),t.append("mark",void 0==this.mark?"":this.mark),t.append("N_manager",void 0==this.N_manager?"":this.N_manager),t.append("NM_phone",void 0==this.NM_phone?"":this.NM_phone),t.append("C_manager",void 0==this.C_manager?"":this.C_manager),t.append("CM_phone",void 0==this.CM_phone?"":this.CM_phone),t.append("origin",void 0==this.origin?"":this.origin),t.append("remark",void 0==this.remark?"":this.remark),this.axios.post("http://"+this.$global_msg.HOST+"scripts/customer/add_customer.php",t).then((function(t){e.loading=!1,"success"==t.data.status?(e.$message.success("添加成功,即将关闭窗口"),e.leaving=!0,setTimeout(e.back,1e3)):e.$message.error(t.data.errMsg)})).catch((function(t){e.loading=!1,e.$message.error(t)}))}else this.$message.error("统一客户名称不能为空!")},update_customer:function(){var e=this;if(""!=this.unify_name){var t=new FormData;t.append("token",this.token),t.append("id",this.post.id),t.append("unify_name",void 0==this.unify_name?"":this.unify_name),t.append("name",void 0==this.name?"":this.name),t.append("level",void 0==this.level?"":this.level),t.append("mark",void 0==this.mark?"":this.mark),t.append("N_manager",void 0==this.N_manager?"":this.N_manager),t.append("NM_phone",void 0==this.NM_phone?"":this.NM_phone),t.append("C_manager",void 0==this.C_manager?"":this.C_manager),t.append("CM_phone",void 0==this.CM_phone?"":this.CM_phone),t.append("origin",void 0==this.origin?"":this.origin),t.append("remark",void 0==this.remark?"":this.remark),this.axios.post("http://"+this.$global_msg.HOST+"scripts/customer/update_customer.php",t).then((function(t){e.loading=!1,"success"==t.data.status?(e.$message.success("修改成功,即将关闭窗口"),e.leaving=!0,setTimeout(e.back,1e3)):e.$message.error(t.data.errMsg)})).catch((function(t){e.loading=!1,e.$message.error(t)}))}else e.$message.error("统一客户名称不能为空!")},fetchData:function(){null!=this.$route.params.post&&(this.post=this.$route.params.post,this.unify_name=this.post.unify_name,this.name=this.post.name,this.level=this.post.level,this.N_manager=this.post.N_manager,this.NM_phone=this.post.NM_phone,this.C_manager=this.post.C_manager,this.CM_phone=this.post.CM_phone,this.origin=this.post.origin,this.remark=this.post.remark),null!=this.$route.params.search&&(this.search=this.$route.params.search)},back:function(){window.opener=null,window.open(" ","_self"),window.close()}}},Le=De,Pe=(a("5911"),Object(l["a"])(Le,ke,Te,!1,null,"260bcdc2",null)),Ce=Pe.exports,je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-background":"#222933"}},[a("el-header",[a("div",{staticClass:"title"},[e._v("政企网络服务中台本地故障单管理系统")])]),a("el-main",[a("div",{staticClass:"container"},[a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("故障单编号")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("客户名称")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:""},model:{value:e.order.id,callback:function(t){e.$set(e.order,"id",t)},expression:"order.id"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.name,callback:function(t){e.$set(e.order,"name",t)},expression:"order.name"}})],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("故障发生时间")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("故障恢复时间")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",editable:!1,clearable:!1,"value-format":"yyyy-MM-dd HH:mm:ss",disabled:!e.edit},on:{change:e.changeTime},model:{value:e.order.start_time,callback:function(t){e.$set(e.order,"start_time",t)},expression:"order.start_time"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",editable:!1,"value-format":"yyyy-MM-dd HH:mm:ss",disabled:!e.edit||"结单"!=e.order.step},on:{change:e.changeTime},model:{value:e.order.end_time,callback:function(t){e.$set(e.order,"end_time",t)},expression:"order.end_time"}})],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v(e._s("结单"==e.order.step?"历时(分钟)":"目前历时(分钟)"))])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("工单状态")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:""},model:{value:e.order.time,callback:function(t){e.$set(e.order,"time",t)},expression:"order.time"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{placeholder:"请选择",disabled:!e.edit},on:{change:e.changeStep},model:{value:e.order.step,callback:function(t){e.$set(e.order,"step",t)},expression:"order.step"}},e._l(e.stepList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[a("div",{staticClass:"label"},[e._v("故障简述")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.trouble_symptom,callback:function(t){e.$set(e.order,"trouble_symptom",t)},expression:"order.trouble_symptom"}})],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("19工单编号")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("电路编号")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.link_id,callback:function(t){e.$set(e.order,"link_id",t)},expression:"order.link_id"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.circuit_number,callback:function(t){e.$set(e.order,"circuit_number",t)},expression:"order.circuit_number"}})],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("客户联系方式")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("客户姓名")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.contact_number,callback:function(t){e.$set(e.order,"contact_number",t)},expression:"order.contact_number"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.contact_name,callback:function(t){e.$set(e.order,"contact_name",t)},expression:"order.contact_name"}})],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("公司所在区域")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("行业类型")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},model:{value:e.order.area,callback:function(t){e.$set(e.order,"area",t)},expression:"order.area"}},e._l(e.area,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},model:{value:e.order.business_type,callback:function(t){e.$set(e.order,"business_type",t)},expression:"order.business_type"}},e._l(e.business_type,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("责任专业")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("客户标记")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},model:{value:e.order.major,callback:function(t){e.$set(e.order,"major",t)},expression:"order.major"}},e._l(e.major,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:""},model:{value:e.order.mark,callback:function(t){e.$set(e.order,"mark",t)},expression:"order.mark"}})],1)]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("是否故障")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("是否对端")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},model:{value:e.order.is_trouble,callback:function(t){e.$set(e.order,"is_trouble",t)},expression:"order.is_trouble"}},[a("el-option",{key:"1",attrs:{label:"是",value:"1"}}),a("el-option",{key:"0",attrs:{label:"否",value:"0"}})],1)],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},model:{value:e.order.is_remote,callback:function(t){e.$set(e.order,"is_remote",t)},expression:"order.is_remote"}},[a("el-option",{key:"1",attrs:{label:"是",value:"1"}}),a("el-option",{key:"0",attrs:{label:"否",value:"0"}})],1)],1)]),a("el-col",{attrs:{span:1}})],1),a("transition",{attrs:{name:"el-fade-in"}},["1"==e.order.is_trouble?a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("故障分类")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("原因细化")])]),a("el-col",{attrs:{span:1}})],1):e._e()],1),a("transition",{attrs:{name:"el-fade-in"}},["1"==e.order.is_trouble?a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},on:{change:e.troubleClassChange},model:{value:e.order.trouble_class,callback:function(t){e.$set(e.order,"trouble_class",t)},expression:"order.trouble_class"}},e._l(e.trouble_class,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit||""==e.order.trouble_class},model:{value:e.order.trouble_reason,callback:function(t){e.$set(e.order,"trouble_reason",t)},expression:"order.trouble_reason"}},e._l(e.trouble_reason[e.order.trouble_class],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:1}})],1):e._e()],1),a("transition",{attrs:{name:"el-fade-in"}},["1"==e.order.is_trouble?a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("机房名称")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("机房类型")])]),a("el-col",{attrs:{span:1}})],1):e._e()],1),a("transition",{attrs:{name:"el-fade-in"}},["1"==e.order.is_trouble?a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.roomName,callback:function(t){e.$set(e.order,"roomName",t)},expression:"order.roomName"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-select",{attrs:{clearable:!0,placeholder:"请选择",disabled:!e.edit},model:{value:e.order.roomType,callback:function(t){e.$set(e.order,"roomType",t)},expression:"order.roomType"}},e._l(e.roomType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("el-col",{attrs:{span:1}})],1):e._e()],1),a("transition",{attrs:{name:"el-fade-in"}},["1"==e.order.is_trouble?a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("故障原因简述")])]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"label"},[e._v("存在隐患")])]),a("el-col",{attrs:{span:1}})],1):e._e()],1),a("transition",{attrs:{name:"el-fade-in"}},["1"==e.order.is_trouble?a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit,placeholder:e.description_holder[e.order.trouble_class]},model:{value:e.order.reasonDescription,callback:function(t){e.$set(e.order,"reasonDescription",t)},expression:"order.reasonDescription"}})],1)]),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!e.edit},model:{value:e.order.hiddenDanger,callback:function(t){e.$set(e.order,"hiddenDanger",t)},expression:"order.hiddenDanger"}})],1)]),a("el-col",{attrs:{span:1}})],1):e._e()],1),e.newOrder?e._e():a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[a("div",{staticClass:"label"},[e._v("故障进展")])]),a("el-col",{attrs:{span:1}})],1),e.newOrder?e._e():a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.processList,size:"small","show-header":!1,stripe:""},on:{"row-dblclick":e.parseProcess}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"50"}}),a("el-table-column",{attrs:{align:"center",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.edit?a("el-select",{attrs:{size:"mini"},model:{value:t.row.mark,callback:function(a){e.$set(t.row,"mark",a)},expression:"scope.row.mark"}},[a("el-option",{key:"",attrs:{label:"进展",value:""}}),a("el-option",{key:"set_suspend",attrs:{label:"挂起",value:"set_suspend"}}),a("el-option",{key:"unset_suspend",attrs:{label:"解挂",value:"unset_suspend"}})],1):a("el-tag",{attrs:{type:""==t.row.mark?"":"warning"}},[e._v(" "+e._s(e.markFormatter(t.row.mark))+" ")])]}}],null,!1,4157973981)}),a("el-table-column",{attrs:{property:"time",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",editable:!1,clearable:!1,"value-format":"yyyy-MM-dd HH:mm:ss",size:"mini",disabled:!e.edit},on:{change:e.changeTime},model:{value:t.row.time,callback:function(a){e.$set(t.row,"time",a)},expression:"scope.row.time"}})]}}],null,!1,726272530)}),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[e.edit?a("el-input",{attrs:{size:"mini"},on:{blur:function(a){return e.autoAddProcess(t.row)}},model:{value:t.row.description,callback:function(a){e.$set(t.row,"description",a)},expression:"scope.row.description"}}):a("span",[e._v(e._s(t.row.description))])]}}],null,!1,1940632909)}),e.edit&&e.canDo.process_update?a("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(a){return e.deleteProcess(t.$index)}}})]}}],null,!1,3110730213)}):e._e()],1),e.edit&&e.canDo.process_update?a("el-button",{staticStyle:{width:"100%","margin-top":"12px"},attrs:{size:"small",round:"",icon:"el-icon-plus",type:"info"},on:{click:e.addProcess}},[e._v("新增进展")]):e._e()],1),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[a("div",{staticClass:"label"},[e._v("备注")])]),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[a("el-input",{staticStyle:{"word-break":"break-all"},attrs:{type:"textarea",autosize:{minRows:2},disabled:!e.edit},model:{value:e.order.remark,callback:function(t){e.$set(e.order,"remark",t)},expression:"order.remark"}})],1),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:24}})],1),a("el-row",[a("el-col",{attrs:{span:1}}),a("el-col",{attrs:{span:22}},[e.canDo.order_edit?a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.isLoading},on:{click:e.submit}},[e._v(e._s(e.edit?"确认":"编辑"))]):e._e()],1),a("el-col",{attrs:{span:1}})],1),a("el-row",[a("el-col",{attrs:{span:24}})],1)],1)])],1)},Me=[];a("a4d3"),a("e01a"),a("a434"),a("466d"),a("498a");function $e(e){var t=/[1-2][0-9]{3}-[0-9]{1,2}-[0-9]{1,2} [0-2][0-9]:[0-5][0-9]:[0-5][0-9]/g;if(null==e.match(t))return null;var a={time:e.match(t),description:e.split(t)};return a}var Se={name:"OrderEdit",data:function(){return{token:"",user_name:"Unknown",pageLoading:!0,isLoading:!1,canDo:{},doList:["order_view","order_new","order_edit","update","getProcessList","process_update"],edit:!1,newOrder:!1,stepList:[{label:"结单",value:"结单"},{label:"未结单",value:"未结单"},{label:"挂起中",value:"挂起中"},{label:"已撤销",value:"已撤销"}],trouble_class:[{label:"光缆故障",value:"光缆故障"},{label:"设备故障",value:"设备故障"},{label:"动力配套",value:"动力配套"},{label:"电缆故障",value:"电缆故障"}],trouble_reason:{"光缆故障":[{label:"市政施工",value:"市政施工"},{label:"三线整治",value:"三线整治"},{label:"河涌整治",value:"河涌整治"},{label:"恶意剪线",value:"恶意剪线"},{label:"车辆挂断",value:"车辆挂断"},{label:"老鼠咬断",value:"老鼠咬断"},{label:"自然灾害",value:"自然灾害"},{label:"光缆劣化",value:"光缆劣化"},{label:"尾纤松动",value:"尾纤松动"},{label:"客户内线",value:"客户内线"}],"设备故障":[{label:"传输设备",value:"传输设备"},{label:"交换设备",value:"交换设备"},{label:"数据设备",value:"数据设备"},{label:"接入设备",value:"接入设备"},{label:"客户设备",value:"客户设备"},{label:"客户端联通设备",value:"客户端联通设备"}],"动力配套":[{label:"机房停电",value:"机房停电"},{label:"机房电池",value:"机房电池"},{label:"机房空调",value:"机房空调"},{label:"基站停电",value:"基站停电"},{label:"基站电池",value:"基站电池"},{label:"基站空调",value:"基站空调"},{label:"室分停电",value:"室分停电"},{label:"室分电池",value:"室分电池"},{label:"室分空调",value:"室分空调"},{label:"客户动力",value:"客户动力"}],"电缆故障":[{label:"市政施工",value:"市政施工"},{label:"三线整治",value:"三线整治"},{label:"河涌整治",value:"河涌整治"},{label:"恶意剪线",value:"恶意剪线"},{label:"车辆挂断",value:"车辆挂断"},{label:"老鼠咬断",value:"老鼠咬断"},{label:"自然灾害",value:"自然灾害"},{label:"电缆劣化",value:"电缆劣化"},{label:"电缆松动",value:"电缆松动"},{label:"客户内线",value:"客户内线"}]},business_type:[{label:"党政军部门",value:"党政军部门"},{label:"金融、保险业",value:"金融、保险业"},{label:"交通运输（含邮政、快递）、仓储业",value:"交通运输（含邮政、快递）、仓储业"},{label:"科学教育、文化卫生",value:"科学教育、文化卫生"},{label:"旅游、饭店、娱乐服务业",value:"旅游、饭店、娱乐服务业"},{label:"通信、电子设备制造和计算机应用服务业",value:"通信、电子设备制造和计算机应用服务业"},{label:"邮电计算机信息业",value:"邮电计算机信息业"},{label:"建筑业",value:"建筑业"},{label:"其他行业",value:"其他行业"}],roomType:[{label:"接入间",value:"接入间"},{label:"汇聚机房",value:"汇聚机房"},{label:"核心机房",value:"核心机房"},{label:"客户机房",value:"客户机房"},{label:"基站",value:"基站"},{label:"室分机房",value:"室分机房"}],area:[{label:"天河",value:"天河"},{label:"越秀",value:"越秀"},{label:"白云南",value:"白云南"},{label:"白云北",value:"白云北"},{label:"番禺",value:"番禺"},{label:"萝岗",value:"萝岗"},{label:"海珠",value:"海珠"},{label:"花都",value:"花都"},{label:"黄埔",value:"黄埔"},{label:"荔湾",value:"荔湾"},{label:"从化",value:"从化"},{label:"增城",value:"增城"},{label:"南沙",value:"南沙"},{label:"非广州",value:"非广州"}],major:[{label:"传输",value:"传输"},{label:"交换",value:"交换"},{label:"数据",value:"数据"},{label:"接入",value:"接入"},{label:"政企云",value:"政企云"},{label:"其他",value:"其他"}],description_holder:{"光缆故障":"请填写断点位置","动力配套":"请简述故障原因（例：物业拉闸，市电停电）","电缆故障":"请填写断点位置","设备故障":"请简述故障原因（例：端口吊死，光模块故障）"},id:"",order:{},processList:[],timeCounter:void 0}},created:function(){this.pageLoading=!0,this.token=this.$cookies.get("user_token"),this.user_name=this.$cookies.get("user_name"),this.id=this.$route.query.id;var e=this;void 0!=this.id?this.assess_query(this.doList).then((function(){e.edit="true"==e.$route.query.edit&&e.canDo.order_edit,e.getData()})):this.assess_query(this.doList).then((function(){e.edit=!0,e.newOrder=!0,e.pageLoading=!1}))},methods:{getData:function(){var e=this,t=new FormData;t.append("token",this.token),t.append("id",this.id),this.axios.post("http://"+this.$global_msg.HOST+"scripts/order/getOrderById.php",t).then((function(t){"success"==t.data.status?(e.order=t.data,document.title=t.data.name,e.getProcessList()):e.$message.error("[getData]Error:"+t.data.errMsg),e.pageLoading=!1})).catch((function(t){console.log("[getData]"+t),e.$message.error("[getData]Network Error:"+t),e.pageLoading=!0}))},getProcessList:function(){var e=this,t=new FormData;t.append("token",this.token),t.append("id",this.id),this.axios.post("http://"+this.$global_msg.HOST+"scripts/order/get_process_list_by_order_id.php",t).then((function(t){"success"==t.data.status?(e.processList=t.data.result,e.refreshProcessList()):e.$message.error("[getProcessList]error:"+t.data.errMsg)})).catch((function(t){console.log("[getProcessList]"+t),e.$message.error("[getProcessList]Network Error:"+t)}))},refreshProcessList:function(){for(var e in this.processList)this.processList[e].list_order=e;this.processList>0&&(this.order.process=this.processList[this.processList.length-1])},deleteProcess:function(e){var t=this;this.$confirm("确认要删除这一条进展吗?","警告",{type:"warning"}).then((function(){t.processList.splice(e,1),t.refreshProcessList()})).catch((function(){}))},addProcess:function(){this.processList.push({process_id:"New Process",order_id:this.id,time:"",description:"",mark:"",list_order:-1}),this.refreshProcessList()},autoAddProcess:function(e){var t=this,a=$e(e.description);a&&this.$confirm("检测到进展包含时间，是否自动整理？","提示",{type:"info"}).then((function(){var s=Number(e.list_order);if(console.log(a),a.time.length>a.description.length)t.$message.error("字符串分割错误！");else{a.time.length<a.description.length&&(""!=a.description[0]?(t.processList[s].description=a.description[0].trim(),a.description.splice(0,1),s++):(a.description.splice(0,1),t.processList.splice(s,1)));for(var r=0;r<a.description.length;r++){var i=new Date(a.time[r]).Format("yyyy-MM-dd hh:mm:ss"),n={process_id:"newProcess",order_id:t.id,description:a.description[r].trim(),time:i,mark:"",list_order:s+""};t.processList.splice(s,0,n),s++}t.refreshProcessList()}})).catch((function(){}))},deleteProcessList:function(e){var t=this,a=new FormData;a.append("token",this.token),a.append("id",this.id),this.axios.post("http://"+this.$global_msg.HOST+"scripts/order/delete_process_by_order_id.php",a).then((function(a){"success"==a.data.status?e():t.$message.error("[deleteProcessByOrderId]error:"+a.data.errMsg)})).catch((function(e){console.log("[deleteProcessByOrderId]"+e),t.$message.error("[deleteProcessByOrderId]Network Error:"+e)}))},updateProcessList:function(e){var t=this,a=new FormData;a.append("token",this.token);var s={sum:0,data:[]};for(var r in this.processList){var i=[];i.push(this.processList[r].process_id),i.push(this.processList[r].order_id),i.push(this.processList[r].time),i.push(this.processList[r].description),i.push(this.processList[r].list_order),i.push(this.processList[r].mark),s.data.push(i)}a.append("DATA",JSON.stringify(s)),t.deleteProcessList((function(){t.processList.length>0?t.axios.post("http://"+t.$global_msg.HOST+"scripts/order/add_process_list.php",a).then((function(a){"success"==a.data.status?e():t.$message.error("[updateProcessList]error:"+a.data.errMsg)})).catch((function(e){console.log("[updateProcessList]"+e),t.$message.error("[updateProcessList]Network Error:"+e)})):e()}))},parseProcess:function(e,t,a){if(!this.edit){var s=e.time+" "+e.description;this.$copyText(s).then((function(e){alert("已复制到剪切板！")}),(function(e){alert("复制失败，请手动复制！"),console.log(e)}))}},getOrderData:function(){var e=["id","name","start_time","end_time","step","trouble_symptom","link_id","process","circuit_number","contact_number","contact_name","area","is_trouble","is_remote","trouble_class","trouble_reason","business_type","remark","major","roomName","roomType","reasonDescription","hiddenDanger"],t=new FormData;for(var a in e)t.append(e[a],void 0==this.order[e[a]]?"":this.order[e[a]]);return t},orderUpdate:function(e){var t=this,a=this.getOrderData();a.append("token",this.token),this.axios.post("http://"+t.$global_msg.HOST+"scripts/order/update.php",a).then((function(a){"success"==a.data.status?e():t.$message.error("[orderUpdate]error:"+a.data.errMsg)})).catch((function(e){console.log("[orderUpdate]"+e),t.$message.error("[orderUpdate]Network Error:"+e)}))},orderNew:function(e){var t=this,a=this.getOrderData();a.append("token",this.token),this.axios.post("http://"+t.$global_msg.HOST+"scripts/order/new.php",a).then((function(a){"success"==a.data.status?e(a.data.id):t.$message.error("[orderUpdate]error:"+a.data.errMsg)})).catch((function(e){console.log("[orderUpdate]"+e),t.$message.error("[orderUpdate]Network Error:"+e)}))},timeCheck:function(){if(!this.order.start_time)return{result:"fail",msg:"请输入故障发生时间"};if(!this.order.name)return{result:"fail",msg:"请输入客户名称"};if("结单"==this.order.step){if(!this.order.end_time)return{result:"fail",msg:"请输入结单时间"};if(new Date(this.order.end_time)-new Date(this.order.start_time)<0)return{result:"fail",msg:"结单时间小于故障发生时间"}}var e=!1;if(this.processList.length>0){var t=new Date(this.order.start_time);for(var a in this.processList){var s=this.processList[a];if(!s.time)return{result:"fail",msg:"请输入进展时间"};if("set_suspend"==s.mark){if(e)return{result:"fail",msg:"请先解挂后再挂起"};e=!0}if("unset_suspend"==s.mark){if(!e)return{result:"fail",msg:"错误的解挂标志"};e=!1}var r=new Date(s.time);if(r-t<0)return{result:"fail",msg:"进展时间存在交错"};t=r}if("结单"==this.order.step&&new Date(this.order.end_time)-t<0)return{result:"fail",msg:"结单时间小于最后进展时间"}}if("挂起中"!=this.order.step&&e)return{result:"warning",suspend:e,msg:"工单挂起中，是否自动将工单步骤改为‘挂起中’?"};if("挂起中"==this.order.step&&!e)return{result:"warning",suspend:e,msg:"工单未挂起或已解挂，是否自动将工单步骤改为‘未结单’?"};if("结单"==this.order.step&&"1"==this.order.is_trouble){if(""==this.order.trouble_class)return{result:"fail",msg:"请选择故障分类！"};if(""==this.order.trouble_reason)return{result:"fail",msg:"请选择原因细化！"};var i=null;switch(this.order.trouble_class){case"光缆故障":case"电缆故障":this.order.reasonDescription||(i={result:"fail",msg:"请填写断点位置！"});break;case"设备故障":this.order.roomName||(i={result:"fail",msg:"请填写机房名称！"}),this.order.roomType||(i={result:"fail",msg:"请选择机房类型！"}),this.order.reasonDescription||(i={result:"fail",msg:"请简述故障原因（例：端口吊死，光模块故障）"});break;case"动力配套":this.order.roomName||(i={result:"fail",msg:"请填写机房名称！"}),this.order.roomType||(i={result:"fail",msg:"请选择机房类型！"}),this.order.reasonDescription||(i={result:"fail",msg:"请简述故障原因（例：物业拉闸，市电停电））"});break}if(i)return i}return{result:"success"}},submit:function(){var e=this;if(this.newOrder){var t=this.timeCheck();switch(t.result){case"success":this.isLoading=!0,this.orderNew((function(t){e.$router.replace({name:"orderEdit",query:{id:t,edit:!1}}),e.isLoading=!1}));break;case"warning":this.$confirm(t.msg,"提示",{type:"info"}).then((function(){e.order.step=t.suspend?"挂起中":"未结单",e.isLoading=!0,e.orderNew((function(t){e.$router.replace({name:"orderEdit",query:{id:t,edit:!1}}),e.isLoading=!1}))})).catch((function(){}));break;case"fail":this.$message.error(t.msg);break}}else if(this.edit){var a=this.timeCheck();switch(a.result){case"success":this.isLoading=!0,this.updateProcessList((function(){e.orderUpdate((function(){e.$router.replace({name:"orderEdit",query:{id:e.id,edit:"false"}}),e.isLoading=!1}))}));break;case"warning":this.$confirm(a.msg,"提示",{type:"info"}).then((function(){e.order.step=a.suspend?"挂起中":"未结单",e.isLoading=!0,e.updateProcessList((function(){e.orderUpdate((function(){e.$router.replace({name:"orderEdit",query:{id:e.id,edit:"false"}}),e.isLoading=!1}))}))})).catch((function(){}));break;case"fail":this.$message.error(a.msg);break}}else e.$router.replace({name:"orderEdit",query:{id:e.id,edit:"true"}})},troubleClassChange:function(e){this.order.trouble_reason=""},changeStep:function(){"结单"!=this.order.step&&(this.order.end_time="",this.changeTime())},changeTime:function(e){this.timeCounter&&clearTimeout(this.timeCounter),this.order.start_time&&this.order.end_time?this.order.time=((new Date(this.order.end_time)-new Date(this.order.start_time))/6e4).toFixed(0):this.order.start_time?(this.order.time=((new Date-new Date(this.order.start_time))/6e4).toFixed(0),this.timeCounter=setTimeout(this.changeTime,6e4)):this.order.time=""},markFormatter:function(e){switch(e){case"":return"进展";case"set_suspend":return"挂起";case"unset_suspend":return"解挂"}},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},Ie=Se,Ne=(a("dc203"),Object(l["a"])(Ie,je,Me,!1,null,"68990b43",null)),Fe=Ne.exports,Re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"orderList_container"},[a("vxe-table",{ref:"xTable",staticClass:"table",attrs:{border:"",align:"center",data:e.assessData,"cell-class-name":e.cellClassName,size:"mini","max-height":"93%",resizable:"","tooltip-config":{enterable:!0},"edit-config":{trigger:"click",mode:"cell",activeMethod:e.editMethod},"auto-resize":""},on:{"edit-closed":e.sendEdit,"edit-actived":e.beforeEdit}},[a("vxe-table-column",{attrs:{field:"orderId",width:"220px",title:"故障单编号",fixed:"left",filters:[{data:""}],"filter-method":e.filterMethod},scopedSlots:e._u([{key:"filter",fn:function(t){var s=t.$panel,r=t.column;return e._l(r.filters,(function(t,r){return a("input",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"option.data"}],key:r,attrs:{type:"type"},domProps:{value:t.data},on:{input:[function(a){a.target.composing||e.$set(t,"data",a.target.value)},function(e){return s.changeOption(e,!!t.data,t)}]}})}))}}])}),a("vxe-table-column",{attrs:{field:"name",width:"200px",title:"客户名称",fixed:"left",filters:[{data:""}],"filter-method":e.filterMethod},scopedSlots:e._u([{key:"filter",fn:function(t){var s=t.$panel,r=t.column;return e._l(r.filters,(function(t,r){return a("input",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"option.data"}],key:r,attrs:{type:"type"},domProps:{value:t.data},on:{input:[function(a){a.target.composing||e.$set(t,"data",a.target.value)},function(e){return s.changeOption(e,!!t.data,t)}]}})}))}}])}),a("vxe-table-column",{attrs:{field:"major",width:"80px",title:"责任专业",filters:e.majorList,"filter-method":e.filterMethodStrict,"edit-render":{name:"input",attrs:{type:"text"}}}}),a("vxe-table-column",{attrs:{field:"time_out",width:"55px",title:"是否超时",formatter:e.toBoolean,filters:e.booleanList,"filter-multiple":!1,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{field:"level",width:"50px",title:"客户等级",filters:e.levelList,"filter-method":e.filterMethod}}),a("vxe-table-column",{attrs:{field:"TOP33",width:"50px",formatter:e.toBoolean,title:"TOP33",filters:e.booleanList,"filter-multiple":!1,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{field:"TOP210",width:"50px",formatter:e.toBoolean,title:"TOP210",filters:e.booleanList,"filter-multiple":!1,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{field:"assess_TOPN",width:"50px",formatter:e.toBoolean,title:"TOP800",filters:e.booleanList,"filter-multiple":!1,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{field:"trouble_type",width:"90px",title:"业务类型",filters:e.bussinessList,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{field:"circuit_number",width:"100px",title:"电路编号","show-overflow":"",enterable:""}}),a("vxe-table-column",{attrs:{field:"start_time",width:"150px",title:"故障开始时间"}}),a("vxe-table-column",{attrs:{field:"end_time",width:"150px",title:"故障结束时间"}}),a("vxe-table-column",{attrs:{field:"time",width:"55px",title:"故障历时"}}),a("vxe-table-column",{attrs:{field:"net_duration",width:"60px",title:"故障净历时"}}),a("vxe-table-column",{attrs:{field:"reduce_time",width:"55px",title:"澄清历时"}}),a("vxe-table-column",{attrs:{field:"assessment_time",width:"55px",title:"考核历时"}}),a("vxe-table-column",{attrs:{field:"time_limit",width:"55px",title:"考核时限",filters:e.timeLimitList,"filter-multiple":!1,"filter-method":e.filterMethodStrict}}),a("vxe-table-column",{attrs:{field:"reason",width:"220px",title:"故障原因","show-overflow":"",enterable:"","edit-render":{name:"input",attrs:{type:"text"}}}}),a("vxe-table-column",{attrs:{field:"is_trouble",width:"80px",formatter:e.toBoolean,title:"真实故障",filters:e.extraBooleanList,"filter-multiple":!1,"filter-method":e.filterMethodStrict,"edit-render":{name:"input",attrs:{type:"text"}}}}),a("vxe-table-column",{attrs:{field:"trouble_class",width:"80px",title:"故障大类",filters:e.troubleClassList,"filter-method":e.filterMethodStrict,"edit-render":{name:"input",attrs:{type:"text"}}}}),a("vxe-table-column",{attrs:{field:"trouble_reason",width:"80px",title:"故障原因细分","edit-render":{name:"input",attrs:{type:"text"}}}}),a("vxe-table-column",{attrs:{field:"remark",width:"100px",formatter:e.hideMark,title:"备注","edit-render":{name:"input",attrs:{type:"text"}}}})],1),a("div",{attrs:{id:"tips"}},[e._v("故障单编号标"),a("font",{attrs:{color:"red"}},[e._v("红色")]),e._v("为超时工单，标"),a("font",{attrs:{color:"#5ab1ef"}},[e._v("蓝色")]),e._v("预计可澄清非广州责任，标"),a("font",{attrs:{color:"#19d4ae"}},[e._v("绿色")]),e._v("预计澄清历时后不超时，标"),a("font",{attrs:{color:"#c4b4e4"}},[e._v("紫色")]),e._v("表示澄清存在争议，待沟通解决。")],1)],1)},Ee=[],qe={name:"AssessOrderList",components:{},activated:function(){this.$setgoindex()},data:function(){return{token:"",canDo:{},doList:["getAssessOrder","updateAssessOrder"],days:[],dailyData:[],rawData:[],assessData:[],levelList:[{label:"一级",value:"一级"},{label:"二级",value:"二级"},{label:"三级",value:"三级"},{label:"四级",value:"四级"},{label:"五级",value:"五级"},{label:"六级",value:"六级"}],booleanList:[{label:"是",value:"1"},{label:"",value:"0"}],extraBooleanList:[{label:"是",value:"1"},{label:"否",value:"0"},{label:"(null)",value:null}],bussinessList:[{label:"语音业务",value:"语音业务"},{label:"互联网业务",value:"互联网业务"},{label:"专线业务",value:"专线业务"}],majorList:[{label:"传输",value:"传输"},{label:"数据",value:"数据"},{label:"交换",value:"交换"},{label:"政企云",value:"政企云"},{label:"其他",value:"其他"}],troubleClassList:[{label:"光缆故障",value:"光缆故障"},{label:"设备故障",value:"设备故障"},{label:"动力配套",value:"动力配套"},{label:"电缆故障",value:"电缆故障"},{label:"(null)",value:null}],timeLimitList:[{label:"120",value:"120"},{label:"240",value:"240"},{label:"480",value:"480"}],before_edit:"",loading:!0}},created:function(){var e=this;this.token=this.$cookies.get("user_token"),this.assess_query(this.doList).then((function(){e.canDo.getAssessOrder?e.init():e.$message.error("[sumLine]:没有接口权限！")}))},updated:function(){},methods:{init:function(){var e=new Date;e.setDate(e.getDate()-1),e.setHours(23),e.setMinutes(59),e.setSeconds(59);var t=new Date(e);t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),this.getData(t.Format("yyyy-MM-dd hh:mm:ss"),e.Format("yyyy-MM-dd hh:mm:ss"))},refresh:function(){var e=this.$refs.xTable;e.updateData()},editMethod:function(){return this.canDo.updateAssessOrder},beforeEdit:function(e){var t=e.row,a=e.column;this.before_edit=t[a.property]},sendEdit:function(e){var t=e.row,a=e.column,s=t[a.property];if(this.before_edit!=s){var r=t.orderId,i=a.property,n=new FormData;n.append("id",r),n.append("title",i),n.append("value",s),n.append("token",this.token),this.axios.post("http://"+this.$global_msg.HOST+"scripts/assess_order/update_single.php",n).then((function(e){"success"==e.data.status||(alert(e.data.errMsg),console.log(e))})).catch((function(e){alert(e)}))}},getData:function(e,t){var a=this,s=new FormData;a.assessData=[],s.append("START",e),s.append("END",t),s.append("token",this.token),s.append("province","广东省广州市"),this.axios.post("http://"+this.$global_msg.HOST+"scripts/assess_order/get_gz_order_by_datetime.php",s).then((function(e){if("success"==e.data.status){a.rawData=e.data.result;var t=[];for(var s in a.rawData){var r=a.rawData[s];"广州"==r.responsible_province&&(1==r.is_assess||1==a.canDo.updateAssessOrder&&null==r.is_trouble)&&t.push(r)}a.assessData=t,setTimeout((function(){a.loading=!1}),1e3)}else a.$message.error("[assessOrderList]ERROR:"+e.data.errMsg)})).catch((function(e){a.$message.error("[assessOrderList]NETWORK ERROR:"+e)}))},cellClassName:function(e){var t=e.row,a=e.column,s="";switch(a.property){case"orderId":"1"==t.time_out&&(t.remark.indexOf("[澄清历时]")>=0?s+="cell_pass ":t.remark.indexOf("[澄清责任]")>=0?s+="cell_not_responsible ":t.remark.indexOf("[澄清有争议]")>=0?s+="cell_argue ":s+="cell_timeout "),null==t.is_trouble&&(s+="cell_unformed ");case"name":case"circuit_number":s+="canSelect ";break}return s},filterMethod:function(e){var t=e.row,a=e.column,s=e.option;return null!=t[a.property].match(s.data)},filterMethodStrict:function(e){var t=e.row,a=e.column,s=e.option;return t[a.property]==s.value},toBoolean:function(e){var t=e.cellValue;return"1"==t?"是":""},hideMark:function(e){var t=e.cellValue;return t.replace(/\[.*\]/,"")},assess_query:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this,s=regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.canDoQuery(t[s]).then((function(e){a.canDo[t[s]]=e}));case 2:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t);case 3:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.delegateYield(s(r),"t2",6);case 6:e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),canDoQuery:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("token",this.token),a.append("operation",t),s=!1,e.next=6,this.axios.post("http://"+this.$global_msg.HOST+"scripts/system/canDoQuery.php",a).then((function(e){"success"==e.data.status?s=!0:console.log("can NOT do "+t+":"+e.data.errMsg)})).catch((function(e){console.log("query error:"+e)}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),back:function(){"true"===this.$route.query.goindex?this.$router.replace({name:"index",params:{}}):this.$router.back(-1)}}},Ae=qe,Ue=(a("eb6c"),Object(l["a"])(Ae,Re,Ee,!1,null,null,null)),ze=Ue.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{attrs:{id:"title"}},[e._v("周报/月报自动生成工具")]),a("div",{staticClass:"input_box"},[e._l(e.inputSettings,(function(t,s){return a("div",{key:s,staticClass:"data_item"},[a("div",{staticClass:"data_title"},[e._v(e._s(t.text)+":")]),"text"==t.type?a("el-input",{staticClass:"data_value",attrs:{placeholder:"请输入数据"},on:{input:function(t){return e.change(t)}},model:{value:t.data,callback:function(a){e.$set(t,"data",a)},expression:"item.data"}}):e._e(),"select"==t.type?a("el-select",{staticClass:"data_value",attrs:{placeholder:"请选择"},model:{value:t.data,callback:function(a){e.$set(t,"data",a)},expression:"item.data"}},e._l(t.selectOption,(function(e){return a("el-option",{key:e.name,attrs:{label:e.text,value:e.name}})})),1):e._e(),"datetime"==t.type?a("el-date-picker",{staticClass:"data_value",attrs:{type:"datetime",placeholder:"选择日期时间",editable:!1},model:{value:t.data,callback:function(a){e.$set(t,"data",a)},expression:"item.data"}}):e._e()],1)})),a("el-button",{attrs:{id:"btn_submit",type:"primary",loading:e.loading,disabled:e.loading},on:{click:e.onSubmit}},[e._v(e._s(e.submit_text))])],2),e.img_list.length>0?a("div",{staticClass:"input_box"},e._l(e.img_list,(function(t,s){return a("div",{key:s,staticClass:"img"},[a("div",{staticClass:"img_zone",attrs:{id:t.name}}),a("div",{staticClass:"img_title"},[e._v("图"+e._s(s+1)+" "+e._s(t.text))])])})),0):e._e(),e.result.length>0?a("div",{staticClass:"input_box"},[e._l(e.result,(function(t,s){return"text"!=t.type&&"img"!=t.type||""==t.value?e._e():a("div",{key:s,staticClass:"data_item"},[a("div",{staticClass:"result_title"},[e._v(e._s(t.text)+":")]),a("el-input",{staticClass:"result_value",attrs:{type:"textarea",autosize:"",readonly:""},model:{value:"text"==t.type?t.value:t.value.path,callback:function(a){e.$set((t.type,t.value),"path",a)},expression:"item.type=='text'?item.value:item.value.path"}})],1)})),a("el-button",{attrs:{id:"btn_create",type:"primary",loading:e.create_loading,disabled:e.create_loading},on:{click:e.onConfirm}},[e._v(e._s(e.confirm_text))])],2):e._e()])},Be=[],Qe=a("d4ec"),Ye=a("bee2"),Ve=a("313e"),Ke=["#5B9BE7","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#255E91","#9E480E","#636363","#997300","#264478","#43682B","#7CAFDD"],We="10.117.195.193/gensmo/",Je=3731;Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var Ge=function(){function e(t,a,s,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;Object(Qe["a"])(this,e),this.name=t,this.type=a,this.text=s,this.calculator=r,this.callback=i}return Object(Ye["a"])(e,[{key:"cal",value:function(e){var t=this.calculator(e);return void 0!=this.callback&&this.callback(t),t}}]),e}(),Xe=["市政施工","河涌整治","三线整治","恶意剪线","车辆挂断","老鼠咬断","自然灾害","光缆劣化","尾纤松动","客户内线"],Ze=["传输设备","数据设备","交换设备","接入设备","客户端联通设备","客户设备"],et=["机房停电","机房电池","机房空调","基站停电","基站电池","基站空调","室分停电","室分电池","室分空调","客户动力"],tt=["市政施工","河涌整治","三线整治","恶意剪线","车辆挂断","老鼠咬断","自然灾害","电缆劣化","电缆松动","客户内线"],at=function(){function e(){Object(Qe["a"])(this,e)}return Object(Ye["a"])(e,[{key:"add",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(void 0==a)switch(t){case"number":a=0;break;case"string":case"input":a="";break;case"array":a=[];break;case"object":a={};break;default:a="";break}this[e]={data:a,type:t}}}]),e}(),st={name:"Daily",components:{},data:function(){return{rawData:[],assess_data:[],assess_data_all:[],rawLocalData:[],local_data:[],local_data_all:[],number_list:[],img_list:[],chart_list:[],url_OK:0,dataReady:!1,dataLocalReady:!1,submit_text:"开始计算",loading:!1,confirm_text:"确认",create_loading:!1,itemList:[],result:[],dataObject:new at,inputSettings:[{name:"start",text:"起始时间*",type:"datetime",data:"",dataType:"string"},{name:"end",text:"终止时间*",type:"datetime",data:"",dataType:"string"},{name:"type",text:"生成类型*",type:"select",data:"",dataType:"string",selectOption:[{name:"week",text:"周报"},{name:"month",text:"月报"}]},{name:"last3_text",text:"上三期时间",type:"text",data:"",dataType:"string"},{name:"assess_data_last3",text:"上三期19工单数",type:"text",data:"",dataType:"number"},{name:"local_data_last3",text:"上三期本地工单数",type:"text",data:"",dataType:"number"},{name:"last2_text",text:"上两期时间",type:"text",data:"",dataType:"string"},{name:"assess_data_last2",text:"上两期19工单数",type:"text",data:"",dataType:"number"},{name:"local_data_last2",text:"上两期本地工单数",type:"text",data:"",dataType:"number"},{name:"last_text",text:"上期时间",type:"text",data:"",dataType:"string"},{name:"assess_data_last",text:"上期19工单数",type:"text",data:"",dataType:"number"},{name:"local_data_last",text:"上期本地工单数",type:"text",data:"",dataType:"number"}]}},created:function(){this.init()},updated:function(){},methods:{init:function(){this.getDefault(),this.loadSettings()},getDefault:function(){var e=this;this.axios.get("http://"+We+"scripts/assess_order/reportData.php").then((function(t){for(var a in t.data)for(var s in e.dataObject.add(t.data[a].name,t.data[a].dataType,t.data[a].data),e.inputSettings)if(e.inputSettings[s].name==t.data[a].name){e.inputSettings[s].data=t.data[a].data;break}}))},onSubmit:function(){var e=this.inputSettings;for(var t in e){var a=e[t];this.dataObject.add(a.name,a.dataType,a.data)}if(""!=this.dataObject.start.data){var s=new Date(this.dataObject.start.data);if(""!=this.dataObject.end.data){var r=new Date(this.dataObject.end.data),i=new Date(s);i.setDate(1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),this.dataObject.add("year","number",s.getFullYear()),this.itemList.push(new Ge("year","text","年份",(function(e){return s.getFullYear()}))),this.dataObject.add("month","number",s.getMonth()+1),this.itemList.push(new Ge("month","text","月",(function(e){return s.getMonth()+1}))),this.itemList.push(new Ge("date_start","text","起始日期",(function(e){return s.Format("MM月dd日")}))),this.itemList.push(new Ge("date_end","text","终止日期",(function(e){return r.Format("MM月dd日")}))),this.getData(s,r,i),this.submit_text="计算中...",this.loading=!0}else alert("请输入终止时间！")}else alert("请输入起始时间！")},getData:function(e,t,a){var s=this;s.dataReady=!1;var r=new FormData;r.append("START",a.Format("yyyy-MM-dd hh:mm:ss")),r.append("END",t.Format("yyyy-MM-dd hh:mm:ss")),this.axios.post("http://"+We+"scripts/assess_order/get_order_by_datetime.php",r).then((function(t){if("success"==t.data.status){for(var a in s.rawData=t.data.result,s.assess_data_all=[],s.assess_data=[],s.rawData){var r=s.rawData[a];("广州"==r.responsible_province||"广东省广州市"==r.province&&"用户"==r.responsible_province)&&(s.assess_data_all.push(r),new Date(r.end_time)>e&&s.assess_data.push(r))}s.dataReady=!0,s.dataReady&&s.dataLocalReady&&s.dataNumberReady&&(s.loadData(),s.calculate())}else alert(t.data.errMsg)})).catch((function(e){alert(e),console.log(e)}));var i=new FormData;i.append("end_time_start",a.Format("yyyy-MM-dd hh:mm:ss")),i.append("end_time_end",t.Format("yyyy-MM-dd hh:mm:ss")),i.append("step",""),this.axios.post("http://"+We+"scripts/get_list_with_mark.php",i).then((function(t){if("success"==t.data.status){for(var a in s.rawLocalData=t.data.result,s.local_data=[],s.rawLocalData)new Date(s.rawLocalData[a].end_time)>e&&s.local_data.push(s.rawLocalData[a]);s.dataLocalReady=!0,s.dataReady&&s.dataLocalReady&&s.dataNumberReady&&(s.loadData(),s.calculate())}else alert(t.data.errMsg)})).catch((function(e){alert(e)}));var n=new FormData;n.append("mark",""),this.axios.post("http://"+We+"scripts/assess_order/circuit_number_sum.php",n).then((function(e){"success"==e.data.status?(s.number_list=e.data.result,s.dataNumberReady=!0,s.dataReady&&s.dataLocalReady&&s.dataNumberReady&&(s.loadData(),s.calculate())):alert(e.data.errMsg)})).catch((function(e){alert(e),console.log(e)}))},getNumberRate:function(e,t){for(var a in this.number_list)if(e==this.number_list[a].name)return(t/this.number_list[a].sum*100).toFixed(2);return"10.00"},calculate:function(){var e=this;this.img_list=[];var t=[],a=this,s=function(s){if("img"==e.itemList[s].type){var r=e.itemList[s].cal(e.dataObject);r.then((function(e){var t={name:a.itemList[s].name,text:a.itemList[s].text,type:a.itemList[s].type};""==e?(t.value="",t.type="text",a.result.push(t)):a.chart_list.push({json:t,chart:e})}))}else if("text"==e.itemList[s].type){var i={name:e.itemList[s].name,text:e.itemList[s].text,type:e.itemList[s].type,value:e.itemList[s].cal(e.dataObject)+""};t.push(i)}else if("array"==e.itemList[s].type){e.itemList[s].cal(e.dataObject);var n={name:e.itemList[s].name,text:e.itemList[s].text,type:e.itemList[s].type,value:e.itemList[s].cal(e.dataObject)};t.push(n)}};for(var r in this.itemList)s(r);this.result=t,this.submit_text="重新计算",this.loading=!1},savePic:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="",s=new FormData,s.append("baseimg",t),e.next=5,this.axios.post("http://"+We+"scripts/assess_order/savePic.php?action=save",s).then((function(e){a=e.data}));case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onConfirm:function(){var e=this,t=this;this.confirm_text="生成中...",this.create_loading=!0,this.url_OK=0;var a=function(a){var s=e.chart_list[a].chart,r=s.getDom().firstChild.firstChild.getContext("2d");r.strokeStyle="#636363",r.strokeRect(0,0,s.getWidth(),s.getHeight()),e.savePic(s.getDataURL()).then((function(e){var s=t.chart_list[a].json,r={path:e,width:"147mm",height:"87mm",ratio:!1};s.value=r,t.result.push(s),t.url_OK++,t.url_OK==t.chart_list.length&&t.sendJSON()}))};for(var s in this.chart_list)a(s)},sendJSON:function(){var e=this,t=new FormData,a=JSON.stringify(this.result);a=a.replace(/&/gm,"&amp;"),a=a.replace(/</gm,"&lt;"),a=a.replace(/>/gm,"&gt;"),t.append("DATA",a),t.append("type",this.dataObject.type.data),this.axios.post("http://"+We+"scripts/assess_order/read_word.php",t).then((function(t){e.create_loading=!1,e.confirm_text="确认";for(var a=0;a<e.url_OK;a++)e.result.pop();"success"==t.data.status?window.open("http://"+We+"files/"+t.data.name):alert(t.data.errMsg)})).catch((function(t){e.create_loading=!1,e.confirm_text="确认";for(var a=0;a<e.url_OK;a++)e.result.pop();alert(t)}))},change:function(e){this.$forceUpdate()},loadData:function(){this.dataObject.add("assess_data","array",this.assess_data),this.dataObject.add("local_data","array",this.local_data),this.dataObject.add("assess_data_all","array",this.assess_data_all),this.dataObject.add("local_data_all","array",this.rawLocalData)},getImg:function(e,t){var a=Ve.init(document.getElementById(e));return a.setOption(t),window.addEventListener("resize",(function(){a.resize()})),a},getOption:function(e,t){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i={};switch(i=0==r.length?{x:10,y:25,x2:10,y2:25}:{x:10,y:25,x2:10,y2:45},e){case"pie":t.label={show:!0,position:"inside",formatter:"{b}，{c}，{d}%"},t.type="pie",a={title:{show:!1},grid:i,animation:!1,tooltip:{},series:[t],color:Ke};break;case"bar":a={title:{show:!1},grid:i,animation:!1,tooltip:{},legend:r,xAxis:{data:s,splitLine:{show:!1},axisLabel:{interval:0,fontSize:10,formatter:function(e){var t="";return t=e.length>10?e.substring(0,10)+"...":e,t}}},yAxis:{show:!1,splitLine:{show:!1}},series:t,color:Ke};break}return a},loadSettings:function(){var e=this;this.dataObject.add("assess_data_last","input"),this.dataObject.add("local_data_last","input"),this.dataObject.add("start","input"),this.dataObject.add("end","input"),this.itemList.push(new Ge("order_sum","text","故障总量",(function(e){return e.assess_data.data.length+e.local_data.data.length}),(function(t){e.dataObject.add("order_sum","number",t)}))),this.itemList.push(new Ge("order_assess_sum","text","19故障总量",(function(e){return e.assess_data.data.length}))),this.itemList.push(new Ge("order_assess_percent","text","19工单占比",(function(e){return(e.assess_data.data.length/e.order_sum.data*100).toFixed(2)}))),this.itemList.push(new Ge("order_assess_compare","text","19工单环比",(function(e){var t=e.assess_data.data.length-Number(e.assess_data_last.data);return t>0?"增加"+t:t<0?"减少"+-t:"持平"}))),this.itemList.push(new Ge("order_local_sum","text","本地故障总量",(function(e){return e.local_data.data.length}))),this.itemList.push(new Ge("order_local_percent","text","本地工单占比",(function(e){return(e.local_data.data.length/e.order_sum.data*100).toFixed(2)}))),this.itemList.push(new Ge("order_local_compare","text","本地工单环比",(function(e){var t=e.local_data.data.length-Number(e.local_data_last.data);return t>0?"增加"+t:t<0?"减少"+-t:"持平"}))),this.itemList.push(new Ge("sum_picture","img","近4期政企用户故障量情况",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",t.t0=a.type.data,t.next="month"===t.t0?7:(t.t0,9);break;case 7:return i=a.month.data+"月",t.abrupt("break",10);case 9:i=a.start.data.Format("MM月dd日")+"-"+a.end.data.Format("dd日");case 10:return n=[a.last3_text.data,a.last2_text.data,a.last_text.data,i],o={show:!0,bottom:5},l=[{name:"19系统",type:"bar",stack:"故障量",data:[a.assess_data_last3.data,a.assess_data_last2.data,a.assess_data_last.data,a.assess_data.data.length],label:{show:!0},barMaxWidth:60},{name:"本地",type:"bar",stack:"故障量",data:[a.local_data_last3.data,a.local_data_last2.data,a.local_data_last.data,a.local_data.data.length],label:{show:!0}}],u=e.getOption("bar",l,n,o),t.next=16,e.$nextTick((function(){r=e.getImg(s,u)}));case 16:return t.abrupt("return",r);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("order_real","text","真实工单",(function(e){var t=e.assess_data.data,a=e.local_data.data,s=0;for(var r in t)"1"==t[r].is_trouble&&s++;for(var i in a)"1"==a[i].is_trouble&&s++;return s}),(function(t){e.dataObject.add("order_real","number",t)}))),this.itemList.push(new Ge("order_real_percent","text","真实工单比例",(function(e){return(e.order_real.data/e.order_sum.data*100).toFixed(2)}))),this.itemList.push(new Ge("order_fake","text","非真实工单",(function(e){var t=e.assess_data.data,a=e.local_data.data,s=0;for(var r in t)"0"==t[r].is_trouble&&s++;for(var i in a)"0"==a[i].is_trouble&&s++;return s}),(function(t){e.dataObject.add("order_fake","number",t)}))),this.itemList.push(new Ge("order_fake_percent","text","非真实工单比例",(function(e){return(e.order_fake.data/e.order_sum.data*100).toFixed(2)}))),this.itemList.push(new Ge("order_assess_real","text","19真实工单",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"1"==t[s].is_trouble&&a++;return a}),(function(t){e.dataObject.add("order_assess_real","number",t)}))),this.itemList.push(new Ge("order_assess_real_percent","text","19真实工单比例",(function(e){return(e.order_assess_real.data/e.assess_data.data.length*100).toFixed(2)}))),this.itemList.push(new Ge("order_assess_fake","text","19非真实工单",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"0"==t[s].is_trouble&&a++;return a}),(function(t){e.dataObject.add("order_assess_fake","number",t)}))),this.itemList.push(new Ge("order_assess_fake_percent","text","19非真实工单比例",(function(e){return(e.order_assess_fake.data/e.assess_data.data.length*100).toFixed(2)}))),this.itemList.push(new Ge("order_assess_duty_sum","text","19责任故障总量",(function(t){var a=t.assess_data.data,s=[];for(var r in a)"广州"==a[r].responsible_province&&"1"==a[r].is_assess&&s.push(a[r]);return e.dataObject.add("order_assess_duty","array",s),s.length}),(function(t){e.dataObject.add("order_assess_duty_sum","number",t)}))),this.itemList.push(new Ge("order_assess_duty_compare_month","text","19责任故障环比",(function(e){var t=e.assess_duty_list.data[e.month.data-2],a=e.order_assess_duty.data.length-t;return a>0?"增加"+(a/t*100).toFixed(2)+"%":a<0?"减少"+(-a/t*100).toFixed(2)+"%":"持平"}))),this.itemList.push(new Ge("order_assess_duty_compare_year","text","19责任故障同比",(function(e){var t=e.assess_duty_list_last.data[e.month.data-1],a=e.order_assess_duty.data.length-t;return a>0?"增加"+(a/t*100).toFixed(2)+"%":a<0?"减少"+(-a/t*100).toFixed(2)+"%":"持平"}))),this.itemList.push(new Ge("order_assess_duty_last_year","text","去年责任累计故障量",(function(e){for(var t=e.assess_duty_list_last.data,a=0,s=0;s<e.month.data;s++)a+=t[s];return a}),(function(t){e.dataObject.add("order_assess_duty_last_year","number",t)}))),this.itemList.push(new Ge("order_assess_duty_this_year","text","今年责任累计故障量",(function(e){for(var t=e.assess_duty_list.data,a=0,s=0;s<e.month.data-1;s++)a+=t[s];return a+=e.order_assess_duty_sum.data,a}),(function(t){e.dataObject.add("order_assess_duty_this_year","number",t)}))),this.itemList.push(new Ge("order_assess_duty_sum_compare","text","责任故障量同比",(function(e){var t=e.order_assess_duty_last_year.data,a=e.order_assess_duty_this_year.data-t;return a>0?"增加"+(a/t*100).toFixed(2)+"%":a<0?"减少"+(-a/t*100).toFixed(2)+"%":"持平"}))),this.itemList.push(new Ge("order_assess_line","text","19专线业务故障",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"专线业务"==t[s].trouble_type&&a++;return a}),(function(t){e.dataObject.add("order_assess_line","number",t)}))),this.itemList.push(new Ge("order_assess_network","text","19互联网业务故障",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"互联网业务"==t[s].trouble_type&&a++;return a}),(function(t){e.dataObject.add("order_assess_network","number",t)}))),this.itemList.push(new Ge("order_assess_phone","text","19语音业务故障",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"语音业务"==t[s].trouble_type&&a++;return a}),(function(t){e.dataObject.add("order_assess_phone","number",t)}))),this.itemList.push(new Ge("order_assess_other","text","19其他业务故障",(function(e){var t=e.assess_data.data;return t.length-e.order_assess_line.data-e.order_assess_network.data-e.order_assess_phone.data}),(function(t){e.dataObject.add("order_assess_other","number",t)}))),this.itemList.push(new Ge("order_assess_trouble_type","text","19业务故障情况",(function(e){var t=[];t.push({name:"line",sum:e.order_assess_line.data,text:"专线业务"}),t.push({name:"network",sum:e.order_assess_network.data,text:"互联网业务"}),t.push({name:"phone",sum:e.order_assess_phone.data,text:"语音业务"}),t.push({name:"other",sum:e.order_assess_other.data,text:"其他业务"}),t.sort((function(e,t){return t.sum-e.sum}));var a="";for(var s in t)t[s].sum>0&&(a=a+t[s].text+"故障"+t[s].sum+"宗，占比"+(t[s].sum/e.assess_data.data.length*100).toFixed(2)+"%；");return a=a.substr(0,a.length-1)+"。",a}))),this.itemList.push(new Ge("order_assess_sum_picture","img","故障业务分类（19系统）",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",i=[],n=[{name:"专线业务",value:e.dataObject.order_assess_line.data},{name:"互联网业务",value:e.dataObject.order_assess_network.data},{name:"语音业务",value:e.dataObject.order_assess_phone.data},{name:"其他业务",value:e.dataObject.order_assess_other.data}],n.sort((function(e,t){return t.value-e.value})),t.t0=regeneratorRuntime.keys(n);case 8:if((t.t1=t.t0()).done){t.next=17;break}if(o=t.t1.value,!(n[o].value>0)){t.next=14;break}i.push(n[o]),t.next=15;break;case 14:return t.abrupt("break",17);case 15:t.next=8;break;case 17:return l={name:"故障量",data:i},u=e.getOption("pie",l),t.next=21,e.$nextTick((function(){r=e.getImg(s,u)}));case 21:return t.abrupt("return",r);case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("order_assess_customer_devices","text","19客户设备",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"客户设备"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_customer_devices","number",t)}))),this.itemList.push(new Ge("order_assess_customer_line","text","19客户线路",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"客户线路"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_customer_line","number",t)}))),this.itemList.push(new Ge("order_assess_customer_power","text","19客户动力",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"客户动力"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_customer_power","number",t)}))),this.itemList.push(new Ge("order_assess_customer","text","19客户侧故障量",(function(e){return e.order_assess_customer_line.data+e.order_assess_customer_power.data+e.order_assess_customer_devices.data}),(function(t){e.dataObject.add("order_assess_customer","number",t)}))),this.itemList.push(new Ge("order_assess_customer_devices_percent","text","19客户设备占比",(function(e){return(e.order_assess_customer_devices.data/e.order_assess_customer.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_customer_devices_percent","number",t)}))),this.itemList.push(new Ge("order_assess_customer_line_percent","text","19客户线路占比",(function(e){return(e.order_assess_customer_line.data/e.order_assess_customer.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_customer_line_percent","number",t)}))),this.itemList.push(new Ge("order_assess_customer_power_percent","text","19客户动力占比",(function(e){return(e.order_assess_customer_power.data/e.order_assess_customer.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_customer_power_percent","number",t)}))),this.itemList.push(new Ge("assessCustomerItems","array","19客户侧情况表格",(function(e){var t={assessCustomerItems:"客户线路",assessCustomerItemsSum:e.order_assess_customer_line.data,assessCustomerItemsPercent:e.order_assess_customer_line_percent.data},a={assessCustomerItems:"客户设备",assessCustomerItemsSum:e.order_assess_customer_devices.data,assessCustomerItemsPercent:e.order_assess_customer_devices_percent.data},s={assessCustomerItems:"客户动力",assessCustomerItemsSum:e.order_assess_customer_power.data,assessCustomerItemsPercent:e.order_assess_customer_power_percent.data},r=[a,s,t];return r.sort((function(e,t){return t.assessCustomerItemsSum-e.assessCustomerItemsSum})),r}))),this.itemList.push(new Ge("order_assess_customer_detail","text","19客户侧情况",(function(e){var t=[];t.push({name:"line",sum:e.order_assess_customer_line.data,text:"客户线路"}),t.push({name:"devices",sum:e.order_assess_customer_devices.data,text:"客户设备"}),t.push({name:"power",sum:e.order_assess_customer_power.data,text:"客户动力"}),t.sort((function(e,t){return t.sum-e.sum}));var a="";for(var s in t)t[s].sum>0&&(a=a+t[s].text+t[s].sum+"宗，占比"+(t[s].sum/e.order_assess_customer.data*100).toFixed(2)+"%；");return a=a.substr(0,a.length-1)+"。",a}))),this.itemList.push(new Ge("order_assess_customer_picture","img","政企客户故障原因（用户侧）",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",i=[],n=[{name:"客户设备",value:e.dataObject.order_assess_customer_devices.data},{name:"客户线路",value:e.dataObject.order_assess_customer_line.data},{name:"客户动力",value:e.dataObject.order_assess_customer_power.data}],n.sort((function(e,t){return t.value-e.value})),t.t0=regeneratorRuntime.keys(n);case 8:if((t.t1=t.t0()).done){t.next=17;break}if(o=t.t1.value,!(n[o].value>0)){t.next=14;break}i.push(n[o]),t.next=15;break;case 14:return t.abrupt("break",17);case 15:t.next=8;break;case 17:return l={name:"故障量",data:i},u=e.getOption("pie",l),t.next=21,e.$nextTick((function(){r=e.getImg(s,u)}));case 21:return t.abrupt("return",r);case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("order_assess_unicom_line","text","19光缆故障数量",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"光缆故障"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_unicom_line","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_devices","text","19设备故障数量",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"设备故障"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_unicom_devices","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_power","text","19动力配套数量",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"动力配套"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_unicom_power","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_e_line","text","19电缆故障数量",(function(e){var t=e.assess_data.data,a=0;for(var s in t)"电缆故障"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_assess_unicom_e_line","number",t)}))),this.itemList.push(new Ge("order_assess_unicom","text","19网络侧故障量",(function(e){var t=e.order_assess_unicom_line.data+e.order_assess_unicom_power.data+e.order_assess_unicom_devices.data+e.order_assess_unicom_e_line.data;return t}),(function(t){e.dataObject.add("order_assess_unicom","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_line_percent","text","19光缆故障占比",(function(e){return(e.order_assess_unicom_line.data/e.order_assess_unicom.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_unicom_line_percent","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_devices_percent","text","19设备故障占比",(function(e){return(e.order_assess_unicom_devices.data/e.order_assess_unicom.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_unicom_devices_percent","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_power_percent","text","19动力配套占比",(function(e){return(e.order_assess_unicom_power.data/e.order_assess_unicom.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_unicom_power_percent","number",t)}))),this.itemList.push(new Ge("order_assess_unicom_e_line_percent","text","19电缆故障占比",(function(e){return(e.order_assess_unicom_e_line.data/e.order_assess_unicom.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_assess_unicom_e_line_percent","number",t)}))),this.itemList.push(new Ge("assessUnicomItems","array","19网络侧情况表格",(function(e){var t={assessUnicomItems:"光缆故障",assessUnicomItemsSum:e.order_assess_unicom_line.data,assessUnicomItemsPercent:e.order_assess_unicom_line_percent.data},a={assessUnicomItems:"设备故障",assessUnicomItemsSum:e.order_assess_unicom_devices.data,assessUnicomItemsPercent:e.order_assess_unicom_devices_percent.data},s={assessUnicomItems:"动力配套",assessUnicomItemsSum:e.order_assess_unicom_power.data,assessUnicomItemsPercent:e.order_assess_unicom_power_percent.data},r={assessUnicomItems:"电缆故障",assessUnicomItemsSum:e.order_assess_unicom_e_line.data,assessUnicomItemsPercent:e.order_assess_unicom_e_line_percent.data},i=[a,s,t,r];return i.sort((function(e,t){return t.assessUnicomItemsSum-e.assessUnicomItemsSum})),i}))),this.itemList.push(new Ge("order_assess_unicom_detail","text","19网络侧情况",(function(e){var t=[];t.push({name:"line",sum:e.order_assess_unicom_line.data,text:"光缆故障"}),t.push({name:"devices",sum:e.order_assess_unicom_devices.data,text:"设备故障"}),t.push({name:"power",sum:e.order_assess_unicom_power.data,text:"动力配套"}),t.push({name:"e_line",sum:e.order_assess_unicom_e_line.data,text:"电缆故障"}),t.sort((function(e,t){return t.sum-e.sum}));var a="";for(var s in t)t[s].sum>0&&(a=a+t[s].text+t[s].sum+"宗，占比"+(t[s].sum/e.order_assess_customer.data*100).toFixed(2)+"%；");return a}))),this.itemList.push(new Ge("order_assess_unicom_picture","img","故障原因分类（网络侧）",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",i=[],n=[{name:"光缆故障",value:e.dataObject.order_assess_unicom_line.data},{name:"设备故障",value:e.dataObject.order_assess_unicom_devices.data},{name:"动力配套",value:e.dataObject.order_assess_unicom_power.data},{name:"电缆故障",value:e.dataObject.order_assess_unicom_e_line.data}],n.sort((function(e,t){return t.value-e.value})),t.t0=regeneratorRuntime.keys(n);case 8:if((t.t1=t.t0()).done){t.next=17;break}if(o=t.t1.value,!(n[o].value>0)){t.next=14;break}i.push(n[o]),t.next=15;break;case 14:return t.abrupt("break",17);case 15:t.next=8;break;case 17:return l={name:"故障量",data:i},u=e.getOption("pie",l),t.next=21,e.$nextTick((function(){r=e.getImg(s,u)}));case 21:return t.abrupt("return",r);case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("order_assess_unicom_line_detail","text","19光缆故障详情",(function(t){var a=t.assess_data.data,s=[];for(var r in Xe)s.push({name:Xe[r],sum:0});for(var i in a)if("光缆故障"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_assess_unicom_line_list","array",s);for(var l=t.order_assess_unicom_line.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("order_assess_unicom_devices_detail","text","19设备故障详情",(function(t){var a=t.assess_data.data,s=[];for(var r in Ze)s.push({name:Ze[r],sum:0});for(var i in a)if("设备故障"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_assess_unicom_devices_list","array",s);for(var l=t.order_assess_unicom_devices.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("order_assess_unicom_power_detail","text","19动力配套详情",(function(t){var a=t.assess_data.data,s=[];for(var r in et)s.push({name:et[r],sum:0});for(var i in a)if("动力配套"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_assess_unicom_power_list","array",s);for(var l=t.order_assess_unicom_power.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("order_assess_unicom_e_line_detail","text","19电缆故障详情",(function(t){var a=t.assess_data.data,s=[];for(var r in tt)s.push({name:tt[r],sum:0});for(var i in a)if("电缆故障"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_assess_unicom_e_line_list","array",s);for(var l=t.order_assess_unicom_e_line.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("assessUnicomLineItem1","text","19光缆故障首项",(function(e){var t=e.order_assess_unicom_line_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("assessUnicomLineItemSum1","text","19光缆故障首项数量",(function(e){var t=e.order_assess_unicom_line_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("assessUnicomLineItemPercent1","text","19光缆故障首项占比",(function(e){var t=e.order_assess_unicom_line_list.data;return t&&t.length>0?(t[0].sum/e.order_assess_unicom_line.data*100).toFixed(2):""}))),this.itemList.push(new Ge("assessUnicomDevicesItem1","text","19设备故障首项",(function(e){var t=e.order_assess_unicom_devices_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("assessUnicomDevicesItemSum1","text","19设备故障首项数量",(function(e){var t=e.order_assess_unicom_devices_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("assessUnicomDevicesItemPercent1","text","19设备故障首项占比",(function(e){var t=e.order_assess_unicom_devices_list.data;return t&&t.length>0?(t[0].sum/e.order_assess_unicom_devices.data*100).toFixed(2):""}))),this.itemList.push(new Ge("assessUnicomPowerItem1","text","19动力配套首项",(function(e){var t=e.order_assess_unicom_power_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("assessUnicomPowerItemSum1","text","19动力配套首项数量",(function(e){var t=e.order_assess_unicom_power_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("assessUnicomPowerItemPercent1","text","19动力配套首项占比",(function(e){var t=e.order_assess_unicom_power_list.data;return t&&t.length>0?(t[0].sum/e.order_assess_unicom_power.data*100).toFixed(2):""}))),this.itemList.push(new Ge("assessUnicomELineItem1","text","19电缆故障首项",(function(e){var t=e.order_assess_unicom_e_line_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("assessUnicomELineItemSum1","text","19电缆故障首项数量",(function(e){var t=e.order_assess_unicom_e_line_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("assessUnicomELineItemPercent1","text","19电缆故障首项占比",(function(e){var t=e.order_assess_unicom_e_line_list.data;return t&&t.length>0?(t[0].sum/e.order_assess_unicom_e_line.data*100).toFixed(2):""}))),this.itemList.push(new Ge("assessUnicomLineItem","array","19光缆故障表格",(function(e){for(var t=e.order_assess_unicom_line_list.data,a=[],s=1;s<t.length;s++)a.push({assessUnicomLineItem:t[s].name,assessUnicomLineItemSum:t[s].sum,assessUnicomLineItemPercent:(t[s].sum/e.order_assess_unicom_line.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("assessUnicomDevicesItem","array","19设备故障表格",(function(e){for(var t=e.order_assess_unicom_devices_list.data,a=[],s=1;s<t.length;s++)a.push({assessUnicomDevicesItem:t[s].name,assessUnicomDevicesItemSum:t[s].sum,assessUnicomDevicesItemPercent:(t[s].sum/e.order_assess_unicom_devices.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("assessUnicomPowerItem","array","19动力配套表格",(function(e){for(var t=e.order_assess_unicom_power_list.data,a=[],s=1;s<t.length;s++)a.push({assessUnicomPowerItem:t[s].name,assessUnicomPowerItemSum:t[s].sum,assessUnicomPowerItemPercent:(t[s].sum/e.order_assess_unicom_power.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("assessUnicomELineItem","array","19电缆故障表格",(function(e){for(var t=e.order_assess_unicom_e_line_list.data,a=[],s=1;s<t.length;s++)a.push({assessUnicomELineItem:t[s].name,assessUnicomELineItemSum:t[s].sum,assessUnicomELineItemPercent:(t[s].sum/e.order_assess_unicom_e_line.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("order_assess_business_type_detail","text","19客户行业详情",(function(t){var a=t.assess_data.data,s=[];for(var r in a){switch(a[r].trouble_class){case"光缆故障":case"设备故障":case"动力配套":case"电缆故障":break;default:continue}var i=a[r].business_type;"12"==i&&(i="其他行业");var n=!0;for(var o in s)s[o].name==i&&(s[o].sum++,n=!1);n&&s.push({name:i,sum:1})}for(var l in s)"其他行业"==s[l].name&&(s[l].name="中小企业");s.sort((function(e,t){return t.sum-e.sum})),e.dataObject.add("order_assess_business_type_list","array",s);var u="";return u=s.length>1?"占比最大的是"+s[0].name+"，"+s[0].sum+"宗，占比"+(s[0].sum/a.length*100).toFixed(2)+"%；其次是"+s[1].name+"，"+s[1].sum+"宗，占比"+(s[1].sum/t.order_assess_unicom.data*100).toFixed(2)+"%。":"占比最大的是"+s[0].name+"，"+s[0].sum+"宗，占比"+(s[0].sum/a.length*100).toFixed(2)+"%",u}))),this.itemList.push(new Ge("assessBusinessTypeItem","array","19客户行业表格",(function(e){var t=e.order_assess_business_type_list.data,a=[];for(var s in t)a.push({assessBusinessTypeItem:t[s].name,assessBusinessTypeItemSum:t[s].sum,assessBusinessTypeItemPercent:(t[s].sum/e.order_assess_unicom.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("order_assess_customer_sum_detail","text","19客户故障量分析",(function(t){var a=t.assess_data.data,s=[];for(var r in a){var i=a[r].name,n="";switch(a[r].trouble_class){case"光缆故障":case"设备故障":case"动力配套":case"电缆故障":n=a[r].trouble_reason;break;default:continue}var o=!0;for(var l in s)s[l].name==i&&(s[l].sum++,void 0==s[l].reason[n]?s[l].reason[n]=1:s[l].reason[n]=s[l].reason[n]+1,o=!1);if(o){var u=[];u[n]=1,s.push({name:i,sum:1,reason:u})}}s.sort((function(e,t){return t.sum-e.sum}));for(var c=0;c<s.length;c++)s[c].sum<=1?s.splice(c):""!=s[c].name&&"-"!=s[c].name&&" "!=s[c].name||s.splice(c);var d=s.length>5?5:s.length;if(s.splice(d),e.dataObject.add("order_assess_customer_list","array",s),0==s.length)return"所有客户均报障1宗";var m="";for(var _ in s){for(var p in s[_].reason)m=m+s[_].reason[p]+"次"+p+"、";m=m.substr(0,m.length-1),m=m+"造成"+s[_].name+"报障"+s[_].sum+"宗，占比"+(s[_].sum/t.order_assess_unicom.data*100).toFixed(2)+"%；"}return m+="其余客户均报障1宗。",m}))),this.itemList.push(new Ge("order_assess_customer_sum_picture","img","19客户故障量情况（网络侧）",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",i=e.dataObject.order_assess_customer_list.data,!(i.length<2)){t.next=8;break}return e.img_list.pop(),t.abrupt("return","");case 8:for(l in n=[],o=[{name:"故障量",type:"bar",data:[],label:{show:!0},barMaxWidth:60}],i)n.push(i[l].name),o[0].data.push(i[l].sum);return u=e.getOption("bar",o,n),t.next=14,e.$nextTick((function(){r=e.getImg(s,u)}));case 14:return t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("order_local_real","text","本地真实工单",(function(e){var t=e.local_data.data,a=0;for(var s in t)"1"==t[s].is_trouble&&a++;return a}),(function(t){e.dataObject.add("order_local_real","number",t)}))),this.itemList.push(new Ge("order_local_real_percent","text","本地真实工单比例",(function(e){return(e.order_local_real.data/e.local_data.data.length*100).toFixed(2)}))),this.itemList.push(new Ge("order_local_fake","text","本地非真实工单",(function(e){var t=e.local_data.data,a=0;for(var s in t)"0"==t[s].is_trouble&&a++;return a}),(function(t){e.dataObject.add("order_local_fake","number",t)}))),this.itemList.push(new Ge("order_local_fake_percent","text","本地非真实工单比例",(function(e){return(e.order_local_fake.data/e.local_data.data.length*100).toFixed(2)}))),this.itemList.push(new Ge("order_local_unicom_line","text","本地光缆故障数量",(function(e){var t=e.local_data.data,a=0;for(var s in t)"光缆故障"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_local_unicom_line","number",t)}))),this.itemList.push(new Ge("order_local_unicom_line_percent","text","本地光缆故障占比",(function(e){return(e.order_local_unicom_line.data/e.order_local_real.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_local_unicom_line_percent","number",t)}))),this.itemList.push(new Ge("order_local_unicom_devices","text","本地设备故障数量",(function(e){var t=e.local_data.data,a=0;for(var s in t)"设备故障"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_local_unicom_devices","number",t)}))),this.itemList.push(new Ge("order_local_unicom_devices_percent","text","本地设备故障占比",(function(e){return(e.order_local_unicom_devices.data/e.order_local_real.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_local_unicom_devices_percent","number",t)}))),this.itemList.push(new Ge("order_local_unicom_power","text","本地动力配套数量",(function(e){var t=e.local_data.data,a=0;for(var s in t)"动力配套"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_local_unicom_power","number",t)}))),this.itemList.push(new Ge("order_local_unicom_power_percent","text","本地动力配套占比",(function(e){return(e.order_local_unicom_power.data/e.order_local_real.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_local_unicom_power_percent","number",t)}))),this.itemList.push(new Ge("order_local_unicom_e_line","text","本地电缆故障数量",(function(e){var t=e.local_data.data,a=0;for(var s in t)"电缆故障"==t[s].trouble_class&&a++;return a}),(function(t){e.dataObject.add("order_local_unicom_e_line","number",t)}))),this.itemList.push(new Ge("order_local_unicom_e_line_percent","text","本地电缆故障占比",(function(e){return(e.order_local_unicom_e_line.data/e.order_local_real.data*100).toFixed(2)}),(function(t){e.dataObject.add("order_local_unicom_e_line_percent","number",t)}))),this.itemList.push(new Ge("localUnicomItem","array","本地网络侧情况表格",(function(e){var t={localUnicomItem:"光缆故障",localUnicomItemSum:e.order_local_unicom_line.data,localUnicomItemPercent:e.order_local_unicom_line_percent.data},a={localUnicomItem:"设备故障",localUnicomItemSum:e.order_local_unicom_devices.data,localUnicomItemPercent:e.order_local_unicom_devices_percent.data},s={localUnicomItem:"动力配套",localUnicomItemSum:e.order_local_unicom_power.data,localUnicomItemPercent:e.order_local_unicom_power_percent.data},r={localUnicomItem:"电缆故障",localUnicomItemSum:e.order_local_unicom_e_line.data,localUnicomItemPercent:e.order_local_unicom_e_line_percent.data},i=[a,s,t,r];return i.sort((function(e,t){return t.localUnicomItemSum-e.localUnicomItemSum})),i}))),this.itemList.push(new Ge("order_local_unicom_detail","text","本地网络侧情况",(function(e){var t=[];t.push({name:"line",sum:e.order_local_unicom_line.data,text:"光缆故障"}),t.push({name:"devices",sum:e.order_local_unicom_devices.data,text:"设备故障"}),t.push({name:"power",sum:e.order_local_unicom_power.data,text:"动力配套"}),t.push({name:"e_line",sum:e.order_local_unicom_e_line.data,text:"电缆故障"}),t.sort((function(e,t){return t.sum-e.sum}));var a="";for(var s in t)t[s].sum>0&&(a=a+t[s].text+t[s].sum+"宗，占比"+(t[s].sum/e.local_data.data.length*100).toFixed(2)+"%；");return a}))),this.itemList.push(new Ge("order_local_sum_detail","img","本地政企客户故障原因占比",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",i=[],n=[{name:"光缆故障",value:e.dataObject.order_local_unicom_line.data},{name:"设备故障",value:e.dataObject.order_local_unicom_devices.data},{name:"动力配套",value:e.dataObject.order_local_unicom_power.data},{name:"电缆故障",value:e.dataObject.order_local_unicom_e_line.data}],n.sort((function(e,t){return t.value-e.value})),t.t0=regeneratorRuntime.keys(n);case 8:if((t.t1=t.t0()).done){t.next=17;break}if(o=t.t1.value,!(n[o].value>0)){t.next=14;break}i.push(n[o]),t.next=15;break;case 14:return t.abrupt("break",17);case 15:t.next=8;break;case 17:return l={name:"故障量",data:i},u=e.getOption("pie",l),t.next=21,e.$nextTick((function(){r=e.getImg(s,u)}));case 21:return t.abrupt("return",r);case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("order_local_unicom_line_detail","text","本地光缆故障详情",(function(t){var a=t.local_data.data,s=[];for(var r in Xe)s.push({name:Xe[r],sum:0});for(var i in a)if("光缆故障"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_local_unicom_line_list","array",s);for(var l=t.order_local_unicom_line.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("order_local_unicom_devices_detail","text","本地设备故障详情",(function(t){var a=t.local_data.data,s=[];for(var r in Ze)s.push({name:Ze[r],sum:0});for(var i in a)if("设备故障"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_local_unicom_devices_list","array",s);for(var l=t.order_local_unicom_devices.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("order_local_unicom_power_detail","text","本地动力配套详情",(function(t){var a=t.local_data.data,s=[];for(var r in et)s.push({name:et[r],sum:0});for(var i in a)if("动力配套"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_local_unicom_power_list","array",s);for(var l=t.order_local_unicom_power.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("order_local_unicom_e_line_detail","text","本地电缆故障详情",(function(t){var a=t.local_data.data,s=[];for(var r in tt)s.push({name:tt[r],sum:0});for(var i in a)if("电缆故障"==a[i].trouble_class)for(var n in s)if(a[i].trouble_reason==s[n].name){s[n].sum++;break}s.sort((function(e,t){return t.sum-e.sum}));for(var o=0;o<s.length;o++)0==s[o].sum&&s.splice(o);e.dataObject.add("order_local_unicom_e_line_list","array",s);for(var l=t.order_local_unicom_e_line.data,u="",c=!0,d=0,m=-1,_=0;_<s.length&&c;_++)if(_<s.length-1&&s[_].sum==s[_+1].sum)m<0&&(m=_);else{if(m<0)u=u+s[_].name+s[_].sum+"宗，占比"+(s[_].sum/l*100).toFixed(2)+"%；",d++;else{for(var p=m;p<=_;p++)u=u+s[p].name+"、";u=u.substr(0,u.length-1),u=u+"各"+s[m].sum+"宗，各占比"+(s[m].sum/l*100).toFixed(2)+"%；",d=d+_-m+1,m=-1}d>=3&&(c=!1)}return u}))),this.itemList.push(new Ge("localUnicomLineItem1","text","本地光缆故障首项",(function(e){var t=e.order_local_unicom_line_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("localUnicomLineItemSum1","text","本地光缆故障首项数量",(function(e){var t=e.order_local_unicom_line_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("localUnicomLineItemPercent1","text","本地光缆故障首项占比",(function(e){var t=e.order_local_unicom_line_list.data;return t&&t.length>0?(t[0].sum/e.order_local_unicom_line.data*100).toFixed(2):""}))),this.itemList.push(new Ge("localUnicomDevicesItem1","text","本地设备故障首项",(function(e){var t=e.order_local_unicom_devices_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("localUnicomDevicesItemSum1","text","本地设备故障首项数量",(function(e){var t=e.order_local_unicom_devices_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("localUnicomDevicesItemPercent1","text","本地设备故障首项占比",(function(e){var t=e.order_local_unicom_devices_list.data;return t&&t.length>0?(t[0].sum/e.order_local_unicom_devices.data*100).toFixed(2):""}))),this.itemList.push(new Ge("localUnicomPowerItem1","text","本地动力配套首项",(function(e){var t=e.order_local_unicom_power_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("localUnicomPowerItemSum1","text","本地动力配套首项数量",(function(e){var t=e.order_local_unicom_power_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("localUnicomPowerItemPercent1","text","本地动力配套首项占比",(function(e){var t=e.order_local_unicom_power_list.data;return t&&t.length>0?(t[0].sum/e.order_local_unicom_power.data*100).toFixed(2):""}))),this.itemList.push(new Ge("localUnicomELineItem1","text","本地电缆故障首项",(function(e){var t=e.order_local_unicom_e_line_list.data;return t&&t.length>0?t[0].name:""}))),this.itemList.push(new Ge("localUnicomELineItemSum1","text","本地电缆故障首项数量",(function(e){var t=e.order_local_unicom_e_line_list.data;return t&&t.length>0?t[0].sum:""}))),this.itemList.push(new Ge("localUnicomELineItemPercent1","text","本地电缆故障首项占比",(function(e){var t=e.order_local_unicom_e_line_list.data;return t&&t.length>0?(t[0].sum/e.order_local_unicom_e_line.data*100).toFixed(2):""}))),this.itemList.push(new Ge("localUnicomLineItem","array","本地光缆故障表格",(function(e){for(var t=e.order_local_unicom_line_list.data,a=[],s=1;s<t.length;s++)a.push({localUnicomLineItem:t[s].name,localUnicomLineItemSum:t[s].sum,localUnicomLineItemPercent:(t[s].sum/e.order_local_unicom_line.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("localUnicomDevicesItem","array","本地设备故障表格",(function(e){for(var t=e.order_local_unicom_devices_list.data,a=[],s=1;s<t.length;s++)a.push({localUnicomDevicesItem:t[s].name,localUnicomDevicesItemSum:t[s].sum,localUnicomDevicesItemPercent:(t[s].sum/e.order_local_unicom_devices.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("localUnicomPowerItem","array","本地动力配套表格",(function(e){for(var t=e.order_local_unicom_power_list.data,a=[],s=1;s<t.length;s++)a.push({localUnicomPowerItem:t[s].name,localUnicomPowerItemSum:t[s].sum,localUnicomPowerItemPercent:(t[s].sum/e.order_local_unicom_power.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("localUnicomELineItem","array","本地电缆故障表格",(function(e){for(var t=e.order_local_unicom_e_line_list.data,a=[],s=1;s<t.length;s++)a.push({localUnicomELineItem:t[s].name,localUnicomELineItemSum:t[s].sum,localUnicomELineItemPercent:(t[s].sum/e.order_local_unicom_e_line.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("order_local_business_type_detail","text","本地客户行业详情",(function(t){var a=t.local_data.data,s=[];for(var r in a)if("0"!=a[r].is_trouble){var i=a[r].business_type,n=!0;for(var o in s)s[o].name==i&&(s[o].sum++,n=!1);n&&s.push({name:i,sum:1})}for(var l in s)"其他行业"==s[l].name&&(s[l].name="中小企业");s.sort((function(e,t){return t.sum-e.sum})),e.dataObject.add("order_local_business_type_list","array",s);var u="";return u=s.length>1?"占比最大的是"+s[0].name+"，"+s[0].sum+"宗，占比"+(s[0].sum/t.order_local_real.data*100).toFixed(2)+"%；其次是"+s[1].name+"，"+s[1].sum+"宗，占比"+(s[1].sum/t.order_local_real.data*100).toFixed(2)+"%。":"占比最大的是"+s[0].name+"，"+s[0].sum+"宗，占比"+(s[0].sum/t.order_local_real.data*100).toFixed(2)+"%",u}))),this.itemList.push(new Ge("localBusinessTypeItem","array","本地客户行业表格",(function(e){var t=e.order_local_business_type_list.data,a=[];for(var s in t)a.push({localBusinessTypeItem:t[s].name,localBusinessTypeItemSum:t[s].sum,localBusinessTypeItemPercent:(t[s].sum/e.order_local_real.data*100).toFixed(2)});return a}))),this.itemList.push(new Ge("order_local_customer_detail","text","本地客户故障量分析",(function(t){var a=t.local_data.data,s=[];for(var r in a)if("0"!=a[r].is_trouble){var i=a[r].name,n=a[r].trouble_reason,o=!0;for(var l in s)s[l].name==i&&(s[l].sum++,void 0==s[l].reason[n]?s[l].reason[n]=1:s[l].reason[n]=s[l].reason[n]+1,o=!1);if(o){var u=[];u[n]=1,s.push({name:i,sum:1,reason:u})}}s.sort((function(e,t){return t.sum-e.sum}));for(var c=0;c<s.length;c++)s[c].sum<=1?s.splice(c):""!=s[c].name&&"-"!=s[c].name&&" "!=s[c].name||s.splice(c);var d=s.length>5?5:s.length;if(s.splice(d),e.dataObject.add("order_local_customer_list","array",s),0==s.length)return"所有客户均报障1宗";var m="";for(var _ in s){for(var p in s[_].reason)m=m+s[_].reason[p]+"次"+p+"、";m=m.substr(0,m.length-1),m=m+"造成"+s[_].name+"报障"+s[_].sum+"宗，占比"+(s[_].sum/t.order_local_real.data*100).toFixed(2)+"%；"}return m+="其余客户均报障1宗。",m}))),this.itemList.push(new Ge("order_local_customer_sum_picture","img","本地政企客户故障量",function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var s,r,i,n,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.img_list.push({name:this.name,text:this.text}),s=this.name,"",r="",i=e.dataObject.order_local_customer_list.data,!(i.length<2)){t.next=8;break}return e.img_list.pop(),t.abrupt("return","");case 8:for(l in n=[],o=[{name:"故障量",type:"bar",data:[],label:{show:!0},barMaxWidth:60}],i)n.push(i[l].name),o[0].data.push(i[l].sum);return u=e.getOption("bar",o,n),t.next=14,e.$nextTick((function(){r=e.getImg(s,u)}));case 14:return t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())),this.itemList.push(new Ge("TOP33_sum","text","TOP33故障数",(function(t){var a=t.assess_data.data,s=t.local_data.data,r=[];for(var i in a)"1"==a[i].TOP33&&r.push({orderID:a[i].orderId,name:a[i].name,circuit_number:a[i].circuit_number,trouble_class:a[i].trouble_class,trouble_reason:a[i].trouble_reason,time:a[i].time,is_trouble:a[i].is_trouble,is_assess:a[i].is_assess,timeout:a[i].time_out});for(var n in s)"TOP33"==s[n].mark&&r.push({orderID:s[n].id,name:s[n].name,circuit_number:s[n].circuit_number,trouble_class:s[n].trouble_class,trouble_reason:s[n].trouble_reason,time:s[n].time,is_trouble:s[n].is_trouble,is_assess:"0",timeout:"0"});return e.dataObject.add("TOP33_list","array",r),r.length}),(function(t){e.dataObject.add("TOP33_sum","number",t)}))),this.itemList.push(new Ge("TOP33_fake","text","TOP33非真实故障",(function(e){var t=e.TOP33_list.data,a=0;for(var s in t)"0"==t[s].is_trouble&&a++;return a}),(function(t){e.dataObject.add("TOP33_fake","number",t)}))),this.itemList.push(new Ge("TOP33_fake_percent","text","TOP33非真实故障比例",(function(e){return(e.TOP33_fake.data/e.TOP33_sum.data*100).toFixed(2)}),(function(t){e.dataObject.add("TOP33_fake_percent","number",t)}))),this.itemList.push(new Ge("TOP33_real","text","TOP33真实故障",(function(e){var t=e.TOP33_list.data,a=0;for(var s in t)"1"==t[s].is_trouble&&a++;return a}),(function(t){e.dataObject.add("TOP33_real","number",t)}))),this.itemList.push(new Ge("TOP33_real_number_rate","text","TOP33故障率",(function(e){return(e.TOP33_real.data/Je*100).toFixed(2)}),(function(t){e.dataObject.add("TOP33_real_number_rate","number",t)}))),this.itemList.push(new Ge("TOP33_real_percent","text","TOP33真实故障比例",(function(e){return(e.TOP33_real.data/e.TOP33_sum.data*100).toFixed(2)}),(function(t){e.dataObject.add("TOP33_real_percent","number",t)}))),this.itemList.push(new Ge("TOP33_real_detail","text","TOP33真实故障情况",(function(t){var a=t.TOP33_list.data,s=[];for(var r in a)"1"==a[r].is_trouble&&s.push(a[r]);s.sort((function(e,t){return e.name.localeCompare(t.name,"zh-CN")}));for(var i=1,n=s.length-1;n>=0;n--)n>0&&s[n].name==s[n-1].name?(s[n].count="",s[n].rate="",i++):(s[n].count=i,s[n].rate=e.getNumberRate(s[n].name,i)+"%",i=1);e.dataObject.add("TOP33_real_list","array",s);var o=[];for(var l in s){var u=!0;for(var c in o)s[l].trouble_class==o[c].reason&&(o[c].sum++,u=!1);u&&o.push({reason:s[l].trouble_class,sum:1})}o.sort((function(e,t){return t.sum-e.sum}));var d="";for(var m in o)d=d+o[m].reason+o[m].sum+"宗，占比"+(o[m].sum/s.length*100).toFixed(2)+"%；";return d}))),this.itemList.push(new Ge("TOP33RealItem","array","TOP33客户真实故障表格",(function(e){var t=e.TOP33_real_list.data,a=[];for(var s in t)a.push({TOP33RealItem:t[s].orderID,TOP33RealItemName:t[s].name,TOP33RealItemNumber:t[s].circuit_number,TOP33RealItemReason:t[s].trouble_class+(void 0==t[s].trouble_reason?"":"-"+t[s].trouble_reason)});return a}))),this.itemList.push(new Ge("TOP33NumberItem1","text","TOP33故障率首项ID",(function(e){return void 0!=e.TOP33_real_list.data&&e.TOP33_real_list.data.length>0?e.TOP33_real_list.data[0].orderID:""}))),this.itemList.push(new Ge("TOP33NumberItem1Name","text","TOP33故障率首项客户名称",(function(e){return void 0!=e.TOP33_real_list.data&&e.TOP33_real_list.data.length>0?e.TOP33_real_list.data[0].name:""}))),this.itemList.push(new Ge("TOP33NumberItem1Number","text","TOP33故障率首项电路编号",(function(e){return void 0!=e.TOP33_real_list.data&&e.TOP33_real_list.data.length>0?e.TOP33_real_list.data[0].circuit_number:""}))),this.itemList.push(new Ge("TOP33NumberItem1Sum","text","TOP33故障率首项数量",(function(e){return void 0!=e.TOP33_real_list.data&&e.TOP33_real_list.data.length>0?e.TOP33_real_list.data[0].count:""}))),this.itemList.push(new Ge("TOP33NumberItem1Rate","text","TOP33故障率首项故障率（本客户）",(function(e){return void 0!=e.TOP33_real_list.data&&e.TOP33_real_list.data.length>0?e.TOP33_real_list.data[0].rate:""}))),this.itemList.push(new Ge("TOP33NumberItem","array","TOP33故障率表格",(function(e){for(var t=e.TOP33_real_list.data,a=[],s=1;s<t.length;s++)a.push({TOP33NumberItem:t[s].orderID,TOP33NumberItemName:t[s].name,TOP33NumberItemNumber:t[s].circuit_number,TOP33NumberItemSum:t[s].count,TOP33NumberItemRate:t[s].rate});return a}))),this.itemList.push(new Ge("TOP33_timeout","text","TOP33超时数",(function(t){var a=t.TOP33_list.data,s=0,r=[];for(var i in a)"1"==a[i].timeout&&"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("TOP33_timeout_list","array",r),s}),(function(t){e.dataObject.add("TOP33_timeout","number",t)}))),this.itemList.push(new Ge("TOP33TimeoutItem","array","TOP33超时故障表格",(function(e){var t=e.TOP33_timeout_list.data,a=[];for(var s in t)a.push({TOP33TimeoutItem:t[s].orderID,TOP33TimeoutItemName:t[s].name,TOP33TimeoutItemNumber:t[s].circuit_number,TOP33TimeoutItemTime:t[s].time,TOP33TimeoutItemReason:t[s].reason});return a}))),this.itemList.push(new Ge("TOP33_timeout_rate","text","TOP33及时率",(function(e){return(100*(1-e.TOP33_timeout.data/e.TOP33_sum.data)).toFixed(2)}))),this.itemList.push(new Ge("TOP33_assess_sum","text","TOP33责任故障",(function(t){var a=t.assess_data.data,s=0,r=[];for(var i in a)"1"==a[i].TOP33&&"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("TOP33_assess_list","array",r),s}))),this.itemList.push(new Ge("TOP33_assess_repeat","text","TOP33责任故障重复",(function(t){var a=t.TOP33_assess_list.data,s=[],r=[];for(var i in a){var n=!0;for(var o in s)a[i].circuit_number==s[o].number&&(s[o].sum++,s[o].orderID.push(a[i].orderID),s[o].time.push(a[i].time),s[o].reason.push(a[i].reason),n=!1);n&&s.push({name:a[i].name,orderID:[a[i].orderID],time:[a[i].time],reason:[a[i].reason],number:a[i].circuit_number,sum:1})}var l=0;for(var u in s)if(s[u]>1)for(var c in l=l+s[u].sum-1,s[u].orderID)r.push({NumberRepeatItem:s[u].orderID[c],NumberRepeatItemName:s[u].name,NumberRepeatItemNumber:s[u].number,NumberRepeatItemTime:s[u].time[c],NumberRepeatItemReason:s[u].reason[c]});return e.dataObject.add("number_repeat_list","array",r),l}))),this.itemList.push(new Ge("TOP800_assess_sum","text","TOP800责任故障",(function(t){var a=t.assess_data_all.data,s=0,r=[];for(var i in a)"1"==a[i].assess_TOPN&&"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("TOP800_assess_list","array",r),s}))),this.itemList.push(new Ge("TOP800_assess_repeat","text","TOP800责任故障重复",(function(t){var a=t.TOP800_assess_list.data,s=[];for(var r in a){var i=!0;for(var n in s)a[r].circuit_number==s[n].number&&(s[n].sum++,s[n].orderID.push(a[r].orderId),s[n].time.push(a[r].time),s[n].reason.push(a[r].trouble_class+"-"+a[r].trouble_reason),i=!1);i&&""!=a[r].circuit_number&&"客户无法提供"!=a[r].circuit_number&&"无"!=a[r].circuit_number&&s.push({number:a[r].circuit_number,sum:1,name:a[r].name,orderID:[a[r].orderId],time:[a[r].time],reason:[a[r].trouble_class+"-"+a[r].trouble_reason]})}var o=0,l=t.number_repeat_list.data;for(var u in s)if(s[u].sum>1)for(var c in o=o+s[u].sum-1,s[u].orderID)l.push({NumberRepeatItem:s[u].orderID[c],NumberRepeatItemName:s[u].name,NumberRepeatItemNumber:s[u].number,NumberRepeatItemTime:s[u].time[c],NumberRepeatItemReason:s[u].reason[c]});return e.dataObject.add("TOP800_assess_list","array",l),o}))),this.itemList.push(new Ge("NON_TOP800_assess_sum","text","非TOP800责任故障",(function(t){var a=t.assess_data_all.data,s=0,r=[];for(var i in a)"0"==a[i].assess_TOPN&&"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("NON_TOP800_assess_list","array",r),s}))),this.itemList.push(new Ge("NON_TOP800_assess_repeat","text","非TOP800责任故障重复",(function(t){var a=t.NON_TOP800_assess_list.data,s=[];for(var r in a){var i=!0;for(var n in s)a[r].circuit_number==s[n].number&&(s[n].sum++,s[n].orderID.push(a[r].orderId),s[n].time.push(a[r].time),s[n].reason.push(a[r].trouble_class+"-"+a[r].trouble_reason),i=!1);i&&""!=a[r].circuit_number&&"客户无法提供"!=a[r].circuit_number&&"无"!=a[r].circuit_number&&s.push({number:a[r].circuit_number,sum:1,name:a[r].name,orderID:[a[r].orderId],time:[a[r].time],reason:[a[r].trouble_class+"-"+a[r].trouble_reason]})}var o=0,l=t.number_repeat_list.data;for(var u in s)if(s[u].sum>2)for(var c in o=o+s[u].sum-2,s[u].orderID)l.push({NumberRepeatItem:s[u].orderID[c],NumberRepeatItemName:s[u].name,NumberRepeatItemNumber:s[u].number,NumberRepeatItemTime:s[u].time[c],NumberRepeatItemReason:s[u].reason[c]});return e.dataObject.add("TOP800_assess_list","array",l),o}))),this.itemList.push(new Ge("NumberRepeatItem","array","重复电路列表",(function(e){return e.number_repeat_list.data}))),this.itemList.push(new Ge("TOP210_assess_sum","text","TOP210责任故障",(function(t){var a=t.assess_data.data,s=0,r=[];for(var i in a)"1"==a[i].TOP210&&"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("TOP210_assess_list","array",r),s}),(function(t){e.dataObject.add("TOP210_assess_sum","number",t)}))),this.itemList.push(new Ge("TOP210_assess_timeout","text","TOP210责任超时故障",(function(t){var a=t.TOP210_assess_list.data,s=[],r=0;for(var i in a)a[i].net_duration>120&&(r++,s.push({TOP210TimeoutItem:a[i].orderId,TOP210TimeoutItemName:a[i].name,TOP210TimeoutItemNumber:a[i].circuit_number,TOP210TimeoutItemTime:a[i].net_duration,TOP210TimeoutItemReason:a[i].remark.replace(/\[.*\]/,"")}));return e.dataObject.add("TOP210_timeout_list","array",s),r}),(function(t){e.dataObject.add("TOP210_assess_timeout","number",t)}))),this.itemList.push(new Ge("TOP210TimeoutItem","array","TOP210超时故障表格",(function(e){return e.TOP210_timeout_list.data}))),this.itemList.push(new Ge("TOP210_assess_timeout_detail","text","TOP210责任及时率情况",(function(e){var t=(100*(1-e.TOP210_assess_timeout.data/e.TOP210_assess_sum.data)).toFixed(2);return t+"%"+(t>90?"(>90%)，达标":"(<90%)，不达标")}))),this.itemList.push(new Ge("TOP210_assess_all_sum","text","TOP210累计责任故障",(function(t){var a=t.assess_data_all.data,s=0,r=[];for(var i in a)"1"==a[i].TOP210&&"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("TOP210_assess_all_list","array",r),s}),(function(t){e.dataObject.add("TOP210_assess_all_sum","number",t)}))),this.itemList.push(new Ge("TOP210_assess_all_timeout","text","TOP210累计责任超时故障",(function(e){var t=e.TOP210_assess_all_list.data,a=0;for(var s in t)t[s].net_duration>120&&a++;return a}),(function(t){e.dataObject.add("TOP210_assess_all_timeout","number",t)}))),this.itemList.push(new Ge("TOP210_assess_all_timeout_detail","text","TOP210累计责任及时率情况",(function(e){var t=(100*(1-e.TOP210_assess_all_timeout.data/e.TOP210_assess_all_sum.data)).toFixed(2);return t+"%"+(t>90?"(>90%)，达标":"(<90%)，不达标")}))),this.itemList.push(new Ge("TOP800_1_2_assess_sum","text","TOP800家1-2级责任故障",(function(t){var a=t.assess_data.data,s=0,r=[];for(var i in a)"1"!=a[i].assess_TOPN||"1"!=a[i].is_assess||"一级"!=a[i].level&&"二级"!=a[i].level||(s++,r.push(a[i]));return e.dataObject.add("TOP800_1_2_assess_list","array",r),s}),(function(t){e.dataObject.add("TOP800_1_2_assess_sum","number",t)}))),this.itemList.push(new Ge("TOP800_1_2_assess_timeout","text","TOP800家1-2级责任超时故障",(function(t){var a=t.TOP800_1_2_assess_list.data,s=0,r=[];for(var i in a)"1"==a[i].time_out&&(s++,r.push({TOP800OneTwoTimeoutItem:a[i].orderId,TOP800OneTwoTimeoutItemName:a[i].name,TOP800OneTwoTimeoutItemNumber:a[i].circuit_number,TOP800OneTwoTimeoutItemTime:a[i].time,TOP800OneTwoTimeoutItemReason:a[i].remark.replace(/\[.*\]/,"")}));return e.dataObject.add("TOP800_1_2_timeout_list","array",r),s}),(function(t){e.dataObject.add("TOP800_1_2_assess_timeout","number",t)}))),this.itemList.push(new Ge("TOP800OneTwoTimeoutItem","array","TOP800家1-2级超时故障表格",(function(e){return e.TOP800_1_2_timeout_list.data}))),this.itemList.push(new Ge("TOP800_1_2_assess_timeout_detail","text","TOP800家1-2级责任及时率情况",(function(e){var t=(100*(1-e.TOP800_1_2_assess_timeout.data/e.TOP800_1_2_assess_sum.data)).toFixed(2);return t+"%"+(t>90?"(>90%)，达标":"(<90%)，不达标")}))),this.itemList.push(new Ge("TOP800_1_2_assess_all_sum","text","TOP800家累计1-2级责任故障",(function(t){var a=t.assess_data_all.data,s=0,r=[];for(var i in a)"1"!=a[i].assess_TOPN||"1"!=a[i].is_assess||"一级"!=a[i].level&&"二级"!=a[i].level||(s++,r.push(a[i]));return e.dataObject.add("TOP800_1_2_assess_all_list","array",r),s}),(function(t){e.dataObject.add("TOP800_1_2_assess_all_sum","number",t)}))),this.itemList.push(new Ge("TOP800_1_2_assess_all_timeout","text","TOP800家累计1-2级责任超时故障",(function(e){var t=e.TOP800_1_2_assess_all_list.data,a=0;for(var s in t)"1"==t[s].time_out&&a++;return a}),(function(t){e.dataObject.add("TOP800_1_2_assess_all_timeout","number",t)}))),this.itemList.push(new Ge("TOP800_1_2_assess_all_timeout_detail","text","TOP800家累计1-2级责任及时率情况",(function(e){var t=(100*(1-e.TOP800_1_2_assess_all_timeout.data/e.TOP800_1_2_assess_all_sum.data)).toFixed(2);return t+"%"+(t>90?"(>90%)，达标":"(<90%)，不达标")}))),this.itemList.push(new Ge("TOP800_3_6_assess_sum","text","TOP800家3-6级责任故障",(function(t){var a=t.assess_data.data,s=0,r=[];for(var i in a)"1"!=a[i].assess_TOPN||"1"!=a[i].is_assess||"三级"!=a[i].level&&"四级"!=a[i].level&&"五级"!=a[i].level&&"六级"!=a[i].level||(s++,r.push(a[i]));return e.dataObject.add("TOP800_3_6_assess_list","array",r),s}),(function(t){e.dataObject.add("TOP800_3_6_assess_sum","number",t)}))),this.itemList.push(new Ge("TOP800_3_6_assess_timeout","text","TOP800家3-6级责任超时故障",(function(t){var a=t.TOP800_3_6_assess_list.data,s=0,r=[];for(var i in a)"1"==a[i].time_out&&(s++,r.push({TOP800ThreeSixTimeoutItem:a[i].orderId,TOP800ThreeSixTimeoutItemName:a[i].name,TOP800ThreeSixTimeoutItemNumber:a[i].circuit_number,TOP800ThreeSixTimeoutItemTime:a[i].time,TOP800ThreeSixTimeoutItemReason:a[i].remark.replace(/\[.*\]/,"")}));return e.dataObject.add("TOP800_3_6_timeout_list","array",r),s}),(function(t){e.dataObject.add("TOP800_3_6_assess_timeout","number",t)}))),this.itemList.push(new Ge("TOP800ThreeSixTimeoutItem","array","TOP800家3-6级超时故障表格",(function(e){return e.TOP800_3_6_timeout_list.data}))),this.itemList.push(new Ge("TOP800_3_6_assess_timeout_detail","text","TOP800家3-6级责任及时率情况",(function(e){var t=(100*(1-e.TOP800_3_6_assess_timeout.data/e.TOP800_3_6_assess_sum.data)).toFixed(2);return t+"%"+(t>95?"(>95%)，达标":"(<95%)，不达标")}))),this.itemList.push(new Ge("TOP800_3_6_assess_all_sum","text","TOP800家累计3-6级责任故障",(function(t){var a=t.assess_data_all.data,s=0,r=[];for(var i in a)"1"!=a[i].assess_TOPN||"1"!=a[i].is_assess||"三级"!=a[i].level&&"四级"!=a[i].level&&"五级"!=a[i].level&&"六级"!=a[i].level||(s++,r.push(a[i]));return e.dataObject.add("TOP800_3_6_assess_all_list","array",r),s}),(function(t){e.dataObject.add("TOP800_3_6_assess_all_sum","number",t)}))),this.itemList.push(new Ge("TOP800_3_6_assess_all_timeout","text","TOP800家累计3-6级责任超时故障",(function(e){var t=e.TOP800_3_6_assess_all_list.data,a=0;for(var s in t)"1"==t[s].time_out&&a++;return a}),(function(t){e.dataObject.add("TOP800_3_6_assess_all_timeout","number",t)}))),this.itemList.push(new Ge("TOP800_3_6_assess_all_timeout_detail","text","TOP800家累计3-6级责任及时率情况",(function(e){var t=(100*(1-e.TOP800_3_6_assess_all_timeout.data/e.TOP800_3_6_assess_all_sum.data)).toFixed(2);return t+"%"+(t>95?"(>95%)，达标":"(<95%)，不达标")}))),this.itemList.push(new Ge("all_assess_sum","text","所有客户责任故障",(function(t){var a=t.assess_data.data,s=0,r=[];for(var i in a)"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("all_assess_list","array",r),s}),(function(t){e.dataObject.add("all_assess_sum","number",t)}))),this.itemList.push(new Ge("all_assess_timeout","text","所有客户责任超时故障",(function(t){var a=t.all_assess_list.data,s=0,r=[];for(var i in a)"1"==a[i].time_out&&(s++,r.push({TimeoutItem:a[i].orderId,TimeoutItemName:a[i].name,TimeoutItemNumber:a[i].circuit_number,TimeoutItemTime:a[i].time,TimeoutItemReason:a[i].remark.replace(/\[.*\]/,"")}));return e.dataObject.add("timeout_list","array",r),s}),(function(t){e.dataObject.add("all_assess_timeout","number",t)}))),this.itemList.push(new Ge("TimeoutItem","array","所有客户超时故障表格",(function(e){return e.timeout_list.data}))),this.itemList.push(new Ge("all_assess_timeout_detail","text","所有客户责任及时率情况",(function(e){var t=(100*(1-e.all_assess_timeout.data/e.all_assess_sum.data)).toFixed(2);return t+"%"+(t>95?"(>95%)，达标":"(<95%)，不达标")}))),this.itemList.push(new Ge("all_assess_all_sum","text","所有客户累计责任故障",(function(t){var a=t.assess_data_all.data,s=0,r=[];for(var i in a)"1"==a[i].is_assess&&(s++,r.push(a[i]));return e.dataObject.add("all_assess_all_list","array",r),s}),(function(t){e.dataObject.add("all_assess_all_sum","number",t)}))),this.itemList.push(new Ge("all_assess_all_timeout","text","所有客户累计责任超时故障",(function(e){var t=e.all_assess_all_list.data,a=0;for(var s in t)"1"==t[s].time_out&&a++;return a}),(function(t){e.dataObject.add("all_assess_all_timeout","number",t)}))),this.itemList.push(new Ge("all_assess_all_timeout_detail","text","所有客户累计责任及时率情况",(function(e){var t=(100*(1-e.all_assess_all_timeout.data/e.all_assess_all_sum.data)).toFixed(2);return t+"%"+(t>95?"(>95%)，达标":"(<95%)，不达标")})))}}},rt=st,it=(a("4dbc"),Object(l["a"])(rt,He,Be,!1,null,"35bb62fd",null)),nt=it.exports;s["default"].use(_["a"]);var ot=new _["a"]({routes:[{path:"/",name:"index",component:le,meta:{keepAlive:!1}},{path:"/login",name:"login",component:he,meta:{keepAlive:!1}},{path:"/add",name:"add",component:Ce,meta:{keepAlive:!1}},{path:"/daily",name:"daily",component:Oe,meta:{keepAlive:!1}},{path:"/orderEdit",name:"orderEdit",component:Fe,meta:{keepAlive:!1}},{path:"/assessOrderList",name:"assessOrderList",component:ze,meta:{keepAlive:!1}},{path:"/reportGenerator",name:"reportGenerator",component:nt,meta:{keepAlive:!0}}]}),lt=a("bc3a"),ut=a.n(lt),ct=a("a7fe"),dt=a.n(ct),mt=a("c695"),_t=a.n(mt),pt=a("be6b"),ht=a.n(pt),ft=a("cf75"),vt=a.n(ft),gt=a("5c96"),bt=a.n(gt),yt=a("2b27"),wt=a.n(yt),xt=(a("5d37"),a("4eb5")),Ot=a.n(xt),kt=(a("26af"),"10.117.195.193/gensmo/"),Tt=["04BE02","40DEC9","409EFF","EA7777","FFA73C"],Dt={HOST:kt,THEME_LIST:Tt};s["default"].prototype.$global_msg=Dt;var Lt=localStorage.getItem("theme");(!Lt||["009CE6","dark-009CE6"].indexOf(Lt)<0)&&localStorage.setItem("theme","dark-009CE6"),s["default"].config.productionTip=!1,s["default"].use(dt.a,ut.a),s["default"].use(m.a),s["default"].use(vt.a),s["default"].use(ht.a,_t.a),s["default"].use(bt.a),s["default"].use(wt.a),s["default"].use(Ot.a),s["default"].prototype.$setgoindex=function(){window.history.length<=1&&(-1===location.href.indexOf("?")?window.location.href=location.href+"?goindex=true":-1!==location.href.indexOf("?")&&-1===location.href.indexOf("goindex")&&(window.location.href=location.href+"&goindex=true"))},Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e},new s["default"]({router:ot,render:function(e){return e(c)}}).$mount("#app")},5911:function(e,t,a){"use strict";var s=a("7191"),r=a.n(s);r.a},"6e6c":function(e,t,a){},7064:function(e,t,a){},7191:function(e,t,a){},"85ec":function(e,t,a){},"98ca":function(e,t,a){"use strict";var s=a("b5ca"),r=a.n(s);r.a},b0bc:function(e,t,a){"use strict";var s=a("1248"),r=a.n(s);r.a},b4a1:function(e,t,a){"use strict";var s=a("0270"),r=a.n(s);r.a},b5ca:function(e,t,a){},dc203:function(e,t,a){"use strict";var s=a("7064"),r=a.n(s);r.a},eb6c:function(e,t,a){"use strict";var s=a("6e6c"),r=a.n(s);r.a},f78b:function(e,t,a){"use strict";var s=a("3923"),r=a.n(s);r.a},f8b1:function(e,t,a){}});
//# sourceMappingURL=app.ec1d7d76.js.map